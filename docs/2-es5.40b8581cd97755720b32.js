!function(){function t(e,n){return(t=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(e,n)}function e(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,o=r(t);if(e){var u=r(this).constructor;i=Reflect.construct(o,arguments,u)}else i=o.apply(this,arguments);return n(this,i)}}function n(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||h(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var u,s=t[Symbol.iterator]();!(r=(u=s.next()).done)&&(n.push(u.value),!e||n.length!==e);r=!0);}catch(a){i=!0,o=a}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||h(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){if(t){if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"I/3d":function(t,e,n){"use strict";n.d(e,"a",function(){return td}),n.d(e,"b",function(){return ed});var r=n("fXoL"),s=n("D0XW"),h=n("HDdC"),f=n("Cfvw"),l=n("LRne"),p=n("JX91"),d=n("Zy1z"),v=n("lJxs"),y=n("Kqap"),g=n("/uUt"),b=n("pLZG"),m=n("pxpQ"),w=n("spgP"),_=n("ofXK"),I=n("Jgta"),O=n("O1h7"),E=n("zIRd"),T=n("q/0M"),j=n("qOnz"),A=function(t,e){return(A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function N(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var x,k="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S=S||{},D=k||self;function C(){}function P(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function R(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var L="closure_uid_"+(1e9*Math.random()>>>0),V=0;function U(t,e,n){return t.call.apply(t.bind,arguments)}function M(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function q(t,e,n){return(q=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?U:M).apply(null,arguments)}function F(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function z(){return Date.now()}function B(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function G(){this.j=this.j,this.i=this.i}G.prototype.j=!1,G.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,L)&&t[L]||(t[L]=++V)}(this)},G.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var K=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},W=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function H(t){return Array.prototype.concat.apply([],arguments)}function X(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Q(t){return/^[\s\xa0]*$/.test(t)}var Y,J=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function $(t,e){return-1!=t.indexOf(e)}function Z(t,e){return t<e?-1:t>e?1:0}t:{var tt=D.navigator;if(tt){var et=tt.userAgent;if(et){Y=et;break t}}Y=""}function nt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function rt(t){var e={};for(var n in t)e[n]=t[n];return e}var it="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ot(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<it.length;o++)n=it[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ut(t){return ut[" "](t),t}ut[" "]=C;var st,at,ct=$(Y,"Opera"),ht=$(Y,"Trident")||$(Y,"MSIE"),ft=$(Y,"Edge"),lt=ft||ht,pt=$(Y,"Gecko")&&!($(Y.toLowerCase(),"webkit")&&!$(Y,"Edge"))&&!($(Y,"Trident")||$(Y,"MSIE"))&&!$(Y,"Edge"),dt=$(Y.toLowerCase(),"webkit")&&!$(Y,"Edge");function vt(){var t=D.document;return t?t.documentMode:void 0}t:{var yt="",gt=(at=Y,pt?/rv:([^\);]+)(\)|;)/.exec(at):ft?/Edge\/([\d\.]+)/.exec(at):ht?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(at):dt?/WebKit\/(\S+)/.exec(at):ct?/(?:Version)[ \/]?(\S+)/.exec(at):void 0);if(gt&&(yt=gt?gt[1]:""),ht){var bt=vt();if(null!=bt&&bt>parseFloat(yt)){st=String(bt);break t}}st=yt}var mt={};function wt(t){return function(t,e){var n=mt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,function(){for(var e=0,n=J(String(st)).split("."),r=J(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var u=n[o]||"",s=r[o]||"";do{if(u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==u[0].length&&0==s[0].length)break;e=Z(0==u[1].length?0:parseInt(u[1],10),0==s[1].length?0:parseInt(s[1],10))||Z(0==u[2].length,0==s[2].length)||Z(u[2],s[2]),u=u[3],s=s[3]}while(0==e)}return 0<=e})}var _t=D.document&&ht&&(vt()||parseInt(st,10))||void 0,It=!ht||9<=Number(_t),Ot=ht&&!wt("9"),Et=function(){if(!D.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{D.addEventListener("test",C,e),D.removeEventListener("test",C,e)}catch(n){}return t}();function Tt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function jt(t,e){if(Tt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(pt){t:{try{ut(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:At[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}Tt.prototype.b=function(){this.defaultPrevented=!0},B(jt,Tt);var At={2:"touch",3:"pen",4:"mouse"};jt.prototype.b=function(){jt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Ot)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var Nt="closure_listenable_"+(1e6*Math.random()|0),xt=0;function kt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++xt,this.Y=this.Z=!1}function St(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Dt(t){this.src=t,this.a={},this.b=0}function Ct(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=K(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(St(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Pt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Dt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var u=Pt(t,e,r,i);return-1<u?(e=t[u],n||(e.Z=!1)):((e=new kt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Rt="closure_lm_"+(1e6*Math.random()|0),Lt={};function Vt(t,e,n,r,i){if(r&&r.once)return Mt(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Vt(t,e[o],n,r,i);return null}return n=Ht(n),t&&t[Nt]?t.va(e,n,R(r)?!!r.capture:!!r,i):Ut(t,e,n,!1,r,i)}function Ut(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var u=R(i)?!!i.capture:!!i;if(u&&!It)return null;var s=Kt(t);if(s||(t[Rt]=s=new Dt(t)),(n=s.add(e,n,r,u,o)).proxy)return n;if(r=function(){var t=Gt,e=It?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Et||(i=u),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(zt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Mt(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Mt(t,e[o],n,r,i);return null}return n=Ht(n),t&&t[Nt]?t.wa(e,n,R(r)?!!r.capture:!!r,i):Ut(t,e,n,!0,r,i)}function qt(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)qt(t,e[o],n,r,i);else r=R(r)?!!r.capture:!!r,n=Ht(n),t&&t[Nt]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=Pt(o=t.a[e],n,r,i))&&(St(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=Kt(t))&&(e=t.a[e.toString()],t=-1,e&&(t=Pt(e,n,r,i)),(n=-1<t?e[t]:null)&&Ft(n))}function Ft(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[Nt])Ct(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(zt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Kt(e))?(Ct(n,t),0==n.b&&(n.src=null,e[Rt]=null)):St(t)}}}function zt(t){return t in Lt?Lt[t]:Lt[t]="on"+t}function Bt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ft(t),n.call(r,e)}function Gt(t,e){if(t.Y)return!0;if(!It){if(!e)t:{e=["window","event"];for(var n=D,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Bt(t,e=new jt(e,this))}return Bt(t,new jt(e,this))}function Kt(t){return(t=t[Rt])instanceof Dt?t:null}var Wt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ht(t){return"function"==typeof t?t:(t[Wt]||(t[Wt]=function(e){return t.handleEvent(e)}),t[Wt])}function Xt(){G.call(this),this.c=new Dt(this),this.J=this,this.C=null}function Qt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new Tt(e,t);else if(e instanceof Tt)e.target=e.target||t;else{var i=e;ot(e=new Tt(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var u=e.a=n[o];i=Yt(u,r,!0,e)&&i}if(i=Yt(u=e.a=t,r,!0,e)&&i,i=Yt(u,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Yt(u=e.a=n[o],r,!1,e)&&i}function Yt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var u=e[o];if(u&&!u.Y&&u.capture==n){var s=u.listener,a=u.ca||u.src;u.Z&&Ct(t.c,u),i=!1!==s.call(a,r)&&i}}return i&&!r.defaultPrevented}B(Xt,G),Xt.prototype[Nt]=!0,(x=Xt.prototype).addEventListener=function(t,e,n,r){Vt(this,t,e,n,r)},x.removeEventListener=function(t,e,n,r){qt(this,t,e,n,r)},x.G=function(){if(Xt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)St(n[r]);delete e.a[t],e.b--}}this.C=null},x.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},x.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Jt=D.JSON.stringify;function $t(){this.b=this.a=null}var Zt,te=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())(function(){return new ne},function(t){t.reset()});function ee(){var t=ue,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function ne(){this.next=this.b=this.a=null}function re(t){D.setTimeout(function(){throw t},0)}function ie(t,e){Zt||function(){var t=D.Promise.resolve(void 0);Zt=function(){t.then(se)}}(),oe||(Zt(),oe=!0),ue.add(t,e)}$t.prototype.add=function(t,e){var n=te.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},ne.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},ne.prototype.reset=function(){this.next=this.b=this.a=null};var oe=!1,ue=new $t;function se(){for(var t;t=ee();){try{t.a.call(t.b)}catch(n){re(n)}var e=te;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}oe=!1}function ae(t,e){Xt.call(this),this.b=t||1,this.a=e||D,this.f=q(this.Za,this),this.g=z()}function ce(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function he(t,e,n){if("function"==typeof t)n&&(t=q(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=q(t.handleEvent,t)}return 2147483647<Number(e)?-1:D.setTimeout(t,e||0)}function fe(t){t.a=he(function(){t.a=null,t.c&&(t.c=!1,fe(t))},t.h);var e=t.b;t.b=null,t.g.apply(null,e)}B(ae,Xt),(x=ae.prototype).aa=!1,x.M=null,x.Za=function(){if(this.aa){var t=z()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Qt(this,"tick"),this.aa&&(ce(this),this.start()))}},x.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=z())},x.G=function(){ae.X.G.call(this),ce(this),delete this.a};var le=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}A(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:fe(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(D.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(G);function pe(t){G.call(this),this.b=t,this.a={}}B(pe,G);var de=[];function ve(t,e,n,r){Array.isArray(n)||(n&&(de[0]=n.toString()),n=de);for(var i=0;i<n.length;i++){var o=Vt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ye(t){nt(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ft(t)},t),t.a={}}function ge(){this.a=!0}function be(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var u=1;u<i.length;u++)i[u]=""}}}return Jt(n)}catch(s){return e}}(t,n)+(r?" "+r:"")})}pe.prototype.G=function(){pe.X.G.call(this),ye(this)},pe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ge.prototype.info=function(){};var me={},we=null;function _e(){return we=we||new Xt}function Ie(t){Tt.call(this,me.Fa,t)}function Oe(t){var e=_e();Qt(e,new Ie(e,t))}function Ee(t,e){Tt.call(this,me.STAT_EVENT,t),this.stat=e}function Te(t){var e=_e();Qt(e,new Ee(e,t))}function je(t){Tt.call(this,me.Ga,t)}function Ae(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return D.setTimeout(function(){t()},e)}me.Fa="serverreachability",B(Ie,Tt),me.STAT_EVENT="statevent",B(Ee,Tt),me.Ga="timingevent",B(je,Tt);var Ne={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},xe={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function ke(){}function Se(){}ke.prototype.a=null;var De,Ce={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Pe(){Tt.call(this,"d")}function Re(){Tt.call(this,"c")}function Le(){}function Ve(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new pe(this),this.P=Ue,this.R=new ae(t=lt?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}B(Pe,Tt),B(Re,Tt),B(Le,ke),De=new Le;var Ue=45e3,Me={},qe={};function Fe(t,e,n){t.H=1,t.i=hn(rn(e)),t.j=n,t.I=!0,ze(t,null)}function ze(t,e){t.u=z(),Ke(t),t.l=rn(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),On(n.b,"t",r),t.D=0,t.a=gr(t.g,t.g.C?e:null),0<t.O&&(t.F=new le(q(t.Ca,t,t.a),t.O)),ve(t.J,t.a,"readystatechange",t.Xa),e=t.B?rt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),Oe(1),function(t,e,n,r,i,o){t.info(function(){if(t.a)if(o)for(var u="",s=o.split("&"),a=0;a<s.length;a++){var c=s[a].split("=");if(1<c.length){var h=c[0];c=c[1];var f=h.split("_");u=2<=f.length&&"type"==f[1]?u+(h+"=")+c+"&":u+(h+"=redacted&")}}else u=null;else u=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+u})}(t.c,t.m,t.l,t.f,t.S,t.j)}function Be(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=Ge(t,n);if(i==qe){4==e&&(t.h=4,Te(14),r=!1),be(t.c,t.f,null,"[Incomplete Response]");break}if(i==Me){t.h=4,Te(15),be(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}be(t.c,t.f,i,null),Ye(t,i)}4==e&&0==n.length&&(t.h=1,Te(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),cr(e),e.F=!0,Te(11))):(be(t.c,t.f,n,"[Invalid Chunked Response]"),Qe(t),Xe(t))}function Ge(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?qe:(n=Number(e.substring(n,r)),isNaN(n)?Me:(r+=1)+n>e.length?qe:(e=e.substr(r,n),t.D=r+n,e))}function Ke(t){t.T=z()+t.P,We(t,t.P)}function We(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ae(q(t.Va,t),e)}function He(t){t.o&&(D.clearTimeout(t.o),t.o=null)}function Xe(t){0==t.g.v||t.A||lr(t.g,t)}function Qe(t){He(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ce(t.R),ye(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ye(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||kn(n.b,t)))if(n.I=t.N,!t.C&&kn(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(sp){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;fr(n),tr(n)}ar(n),Te(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=Ae(q(n.Sa,n),6e3));if(1>=xn(n.b)&&n.ea){try{n.ea()}catch(sp){}n.ea=void 0}}else dr(n,11)}else if((t.C||n.a==t)&&fr(n),!Q(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(n.P=(i=e[r])[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var u=i[4];null!=u&&(n.pa=u,n.c.info("SVER="+n.pa));var s=i[5];if(null!=s&&"number"==typeof s&&0<s){var a=1.5*s;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=a.b;!f.a&&($(h,"spdy")||$(h,"quic")||$(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(Sn(f,f.b),f.b=null))}if(a.A){var l=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(a.na=l,cn(a.B,a.A,l))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=z()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((a=n).la=yr(a,a.C?a.ga:null,a.fa),p.C){Dn(a.b,p);var d=p,v=a.D;v&&d.setTimeout(v),d.o&&(He(d),Ke(d)),a.a=p}else sr(a);0<n.g.length&&rr(n)}else"stop"!=i[0]&&"close"!=i[0]||dr(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?dr(n,7):Zn(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);Oe(4)}catch(sp){}}function Je(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(P(t)||"string"==typeof t)W(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(P(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(P(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function $e(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof $e)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];tn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)tn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function tn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(x=Ve.prototype).setTimeout=function(t){this.P=t},x.Xa=function(t){t=t.target;var e=this.F;e&&3==Qn(t)?e.f():this.Ca(t)},x.Ca=function(t){try{if(t==this.a)t:{var e=Qn(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!lt&&!this.a.$())){this.A||4!=e||7==n||Oe(8==n||0>=r?3:2),He(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,u){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+u})}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var u,s=this.a;if((u=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Q(u)){var a=u;break e}}a=null}if(!a){this.b=!1,this.h=3,Te(12),Qe(this),Xe(this);break t}be(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ye(this,a)}this.I?(Be(this,e,o),lt&&this.b&&3==e&&(ve(this.J,this.R,"tick",this.Wa),this.R.start())):(be(this.c,this.f,o,null),Ye(this,o)),4==e&&Qe(this),this.b&&!this.A&&(4==e?lr(this.g,this):(this.b=!1,Ke(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Te(12)):(this.h=0,Te(13)),Qe(this),Xe(this)}}}catch(c){}},x.Wa=function(){if(this.a){var t=Qn(this.a),e=this.a.$();this.D<e.length&&(He(this),Be(this,t,e),this.b&&4!=t&&Ke(this))}},x.cancel=function(){this.A=!0,Qe(this)},x.Va=function(){this.o=null;var t=z();0<=t-this.T?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.c,this.l),2!=this.H&&(Oe(3),Te(17)),Qe(this),this.h=2,Xe(this)):We(this,this.T-t)},(x=$e.prototype).K=function(){Ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},x.L=function(){return Ze(this),this.a.concat()},x.get=function(t,e){return tn(this.b,t)?this.b[t]:e},x.set=function(t,e){tn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},x.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var en=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function nn(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof nn){this.a=void 0!==e?e:t.a,on(this,t.f),this.j=t.j,un(this,t.c),sn(this,t.h),this.g=t.g,e=t.b;var n=new mn;n.c=e.c,e.a&&(n.a=new $e(e.a),n.b=e.b),an(this,n),this.i=t.i}else t&&(n=String(t).match(en))?(this.a=!!e,on(this,n[1]||"",!0),this.j=fn(n[2]||""),un(this,n[3]||"",!0),sn(this,n[4]),this.g=fn(n[5]||"",!0),an(this,n[6]||"",!0),this.i=fn(n[7]||"")):(this.a=!!e,this.b=new mn(null,this.a))}function rn(t){return new nn(t)}function on(t,e,n){t.f=n?fn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function un(t,e,n){t.c=n?fn(e,!0):e}function sn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function an(t,e,n){e instanceof mn?(t.b=e,function(t,e){e&&!t.f&&(wn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(_n(this,e),On(this,n,t))},t)),t.f=e}(t.b,t.a)):(n||(e=ln(e,gn)),t.b=new mn(e,t.a))}function cn(t,e,n){t.b.set(e,n)}function hn(t){return cn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^z()).toString(36)),t}function fn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ln(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,pn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function pn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}nn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(ln(e,dn,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(ln(e,dn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(ln(n,"/"==n.charAt(0)?yn:vn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",ln(n,bn)),t.join("")};var dn=/[#\/\?@]/g,vn=/[#\?:]/g,yn=/[#\?]/g,gn=/[#\?@]/g,bn=/#/g;function mn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function wn(t){t.a||(t.a=new $e,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function _n(t,e){wn(t),e=En(t,e),tn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,tn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ze(t)))}function In(t,e){return wn(t),e=En(t,e),tn(t.a.b,e)}function On(t,e,n){_n(t,e),0<n.length&&(t.c=null,t.a.set(En(t,e),X(n)),t.b+=n.length)}function En(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(x=mn.prototype).add=function(t,e){wn(this),this.c=null,t=En(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},x.forEach=function(t,e){wn(this),this.a.forEach(function(n,r){W(n,function(n){t.call(e,n,r,this)},this)},this)},x.L=function(){wn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},x.K=function(t){wn(this);var e=[];if("string"==typeof t)In(this,t)&&(e=H(e,this.a.get(En(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=H(e,t[n])}return e},x.set=function(t,e){return wn(this),this.c=null,In(this,t=En(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},x.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},x.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var u=i;""!==r[o]&&(u+="="+encodeURIComponent(String(r[o]))),t.push(u)}}return this.c=t.join("&")};var Tn=function(t,e){this.b=t,this.a=e};function jn(t){this.g=t||An,t=D.PerformanceNavigationTiming?0<(t=D.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(D.ia&&D.ia.ya&&D.ia.ya()&&D.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var An=10;function Nn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function xn(t){return t.b?1:t.a?t.a.size:0}function kn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function Sn(t,e){t.a?t.a.add(e):t.b=e}function Dn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Cn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=N(t.a.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.s)}catch(u){e={error:u}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return X(t.c)}function Pn(){}function Rn(){this.a=new Pn}function Ln(t,e,n){var r=n||"";try{Je(t,function(t,n){var i=t;R(t)&&(i=Jt(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function Vn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}jn.prototype.cancel=function(){var t,e;if(this.c=Cn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=N(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Pn.prototype.stringify=function(t){return D.JSON.stringify(t,void 0)},Pn.prototype.parse=function(t){return D.JSON.parse(t,void 0)};var Un=D.JSON.parse;function Mn(t){Xt.call(this),this.headers=new $e,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=qn,this.D=this.F=!1}B(Mn,Xt);var qn="",Fn=/^https?$/i,zn=["POST","PUT"];function Bn(t){return"content-type"==t.toLowerCase()}function Gn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Kn(t),Hn(t)}function Kn(t){t.u||(t.u=!0,Qt(t,"complete"),Qt(t,"error"))}function Wn(t){if(t.b&&void 0!==S&&(!t.s[1]||4!=Qn(t)||2!=t.W()))if(t.l&&4==Qn(t))he(t.za,0,t);else if(Qt(t,"readystatechange"),4==Qn(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(en)[1]||null;if(!o&&D.self&&D.self.location){var u=D.self.location.protocol;o=u.substr(0,u.length-1)}i=!Fn.test(o?o.toLowerCase():"")}e=i}if(e)Qt(t,"complete"),Qt(t,"success");else{t.h=6;try{var s=2<Qn(t)?t.a.statusText:""}catch(n){s=""}t.f=s+" ["+t.W()+"]",Kn(t)}}finally{Hn(t)}}}function Hn(t,e){if(t.a){Xn(t);var n=t.a,r=t.s[0]?C:null;t.a=null,t.s=null,e||Qt(t,"ready");try{n.onreadystatechange=r}catch(i){}}}function Xn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(D.clearTimeout(t.m),t.m=null)}function Qn(t){return t.a?t.a.readyState:0}function Yn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return nt(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):cn(t,e,n))}function Jn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function $n(t){this.pa=0,this.g=[],this.c=new ge,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Jn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Jn("baseRetryDelayMs",5e3,t),this.Ra=Jn("retryDelaySeedMs",1e4,t),this.Ma=Jn("forwardChannelMaxRetries",2,t),this.ma=Jn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new jn(t&&t.concurrentRequestLimit),this.ka=new Rn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Zn(t){if(er(t),3==t.v){var e=t.R++,n=rn(t.B);cn(n,"SID",t.J),cn(n,"RID",e),cn(n,"TYPE","terminate"),or(t,n),(e=new Ve(t,t.c,e,void 0)).H=2,e.i=hn(rn(n)),n=!1,D.navigator&&D.navigator.sendBeacon&&(n=D.navigator.sendBeacon(e.i.toString(),"")),!n&&D.Image&&((new Image).src=e.i,n=!0),n||(e.a=gr(e.g,null),e.a.ba(e.i)),e.u=z(),Ke(e)}vr(t)}function tr(t){t.a&&(cr(t),t.a.cancel(),t.a=null)}function er(t){tr(t),t.j&&(D.clearTimeout(t.j),t.j=null),fr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&D.clearTimeout(t.h),t.h=null)}function nr(t,e){t.g.push(new Tn(t.Oa++,e)),3==t.v&&rr(t)}function rr(t){Nn(t.b)||t.h||(t.h=!0,ie(t.Ba,t),t.u=0)}function ir(t,e){var n;n=e?e.f:t.R++;var r=rn(t.B);cn(r,"SID",t.J),cn(r,"RID",n),cn(r,"AID",t.P),or(t,r),t.i&&t.l&&Yn(r,t.i,t.l),n=new Ve(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=ur(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Sn(t.b,n),Fe(n,r,e)}function or(t,e){t.f&&Je({},function(t,n){cn(e,n,t)})}function ur(t,e,n){n=Math.min(t.g.length,n);var r=t.f?q(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var u=["count="+n];-1==o?0<n?u.push("ofs="+(o=i[0].b)):o=0:u.push("ofs="+o);for(var s=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(0>(c-=o))o=Math.max(0,i[a].b-100),s=!1;else try{Ln(h,u,"req"+c+"_")}catch(Yr){r&&r(h)}}if(s){r=u.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function sr(t){t.a||t.j||(t.T=1,ie(t.Aa,t),t.o=0)}function ar(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=Ae(q(t.Aa,t),pr(t,t.o)),t.o++,0))}function cr(t){null!=t.s&&(D.clearTimeout(t.s),t.s=null)}function hr(t){t.a=new Ve(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=rn(t.la);cn(e,"RID","rpc"),cn(e,"SID",t.J),cn(e,"CI",t.H?"0":"1"),cn(e,"AID",t.P),or(t,e),cn(e,"TYPE","xmlhttp"),t.i&&t.l&&Yn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=hn(rn(e)),n.j=null,n.I=!0,ze(n,t)}function fr(t){null!=t.m&&(D.clearTimeout(t.m),t.m=null)}function lr(t,e){var n=null;if(t.a==e){fr(t),cr(t),t.a=null;var r=2}else{if(!kn(t.b,e))return;n=e.s,Dn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=z()-e.u;var i=t.u;Qt(r=_e(),new je(r,n,e,i)),rr(t)}else sr(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(xn(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=Ae(q(t.Ba,t,e),pr(t,t.u)),t.u++,0)))}(t,e)||2==r&&ar(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:dr(t,5);break;case 4:dr(t,10);break;case 3:dr(t,6);break;default:dr(t,2)}}function pr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function dr(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=q(t.Ya,t);n||(n=new nn("//www.google.com/images/cleardot.gif"),D.location&&"http"==D.location.protocol||on(n,"https"),hn(n)),function(t,e){var n=new ge;if(D.Image){var r=new Image;r.onload=F(Vn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=F(Vn,n,r,"TestLoadImage: error",!1,e),r.onabort=F(Vn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=F(Vn,n,r,"TestLoadImage: timeout",!1,e),D.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else Te(2);t.v=0,t.f&&t.f.ra(e),vr(t),er(t)}function vr(t){t.v=0,t.I=-1,t.f&&(0==Cn(t.b).length&&0==t.g.length||(t.b.c.length=0,X(t.g),t.g.length=0),t.f.qa())}function yr(t,e,n){var r=function(t){return t instanceof nn?rn(t):new nn(t,void 0)}(n);if(""!=r.c)e&&un(r,e+"."+r.c),sn(r,r.h);else{var i=D.location;r=function(t,e,n,r){var i=new nn(null,void 0);return t&&on(i,t),e&&un(i,e),n&&sn(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&nt(t.V,function(t,e){cn(r,e,t)}),n=t.na,(e=t.A)&&n&&cn(r,e,n),cn(r,"VER",t.ha),or(t,r),r}function gr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Mn(t.Na)).F=t.C,e}function br(){}function mr(){if(ht&&!(10<=Number(_t)))throw Error("Environmental error: no available transport.")}function wr(t,e){Xt.call(this),this.a=new $n(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!Q(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Q(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new Or(this)}function _r(t){Pe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Ir(){Re.call(this),this.status=1}function Or(t){this.a=t}(x=Mn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(t){var e;return(e=t.a)||(e=t.a={}),e}(this.H?this.H:De),this.a.onreadystatechange=q(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void Gn(this,o)}t=n||"";var i=new $e(this.headers);r&&Je(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=Bn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=D.FormData&&t instanceof D.FormData,!(0<=K(zn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Xn(this),0<this.o&&((this.D=function(t){return ht&&wt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=q(this.xa,this)):this.m=he(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){Gn(this,o)}},x.xa=function(){void 0!==S&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Qt(this,"timeout"),this.abort(8))},x.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Qt(this,"complete"),Qt(this,"abort"),Hn(this))},x.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Hn(this,!0)),Mn.X.G.call(this)},x.za=function(){this.j||(this.A||this.l||this.g?Wn(this):this.Ua())},x.Ua=function(){Wn(this)},x.W=function(){try{return 2<Qn(this)?this.a.status:-1}catch(at){return-1}},x.$=function(){try{return this.a?this.a.responseText:""}catch(at){return""}},x.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Un(e)}},x.ua=function(){return this.h},x.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(x=$n.prototype).ha=8,x.v=1,x.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ve(this,this.c,t,void 0),r=this.l;if(this.O&&(r?ot(r=rt(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=ur(this,n,e),cn(i=rn(this.B),"RID",t),cn(i,"CVER",22),this.A&&cn(i,"X-HTTP-Session-Id",this.A),or(this,i),this.i&&r&&Yn(i,this.i,r),Sn(this.b,n),this.Ia&&cn(i,"TYPE","init"),this.da?(cn(i,"$req",e),cn(i,"SID","null"),n.U=!0,Fe(n,i,null)):Fe(n,i,e),this.v=2}}else 3==this.v&&(t?ir(this,t):0==this.g.length||Nn(this.b)||ir(this))},x.Aa=function(){if(this.j=null,hr(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=Ae(q(this.Ta,this),t)}},x.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Te(10),tr(this),hr(this))},x.Sa=function(){null!=this.m&&(this.m=null,tr(this),ar(this),Te(19))},x.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),Te(2)):(this.c.info("Failed to ping google.com"),Te(1))},(x=br.prototype).ta=function(){},x.sa=function(){},x.ra=function(){},x.qa=function(){},x.Ja=function(){},mr.prototype.a=function(t,e){return new wr(t,e)},B(wr,Xt),wr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;Te(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=yr(t,null,t.fa),rr(t)},wr.prototype.close=function(){Zn(this.a)},wr.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,nr(this.a,e)}else this.l?((e={}).__data__=Jt(t),nr(this.a,e)):nr(this.a,t)},wr.prototype.G=function(){this.a.f=null,delete this.f,Zn(this.a),delete this.a,wr.X.G.call(this)},B(_r,Pe),B(Ir,Re),B(Or,br),Or.prototype.ta=function(){Qt(this.a,"a")},Or.prototype.sa=function(t){Qt(this.a,new _r(t))},Or.prototype.ra=function(t){Qt(this.a,new Ir(t))},Or.prototype.qa=function(){Qt(this.a,"b")},mr.prototype.createWebChannel=mr.prototype.a,wr.prototype.send=wr.prototype.h,wr.prototype.open=wr.prototype.g,wr.prototype.close=wr.prototype.close,Ne.NO_ERROR=0,Ne.TIMEOUT=8,Ne.HTTP_ERROR=6,xe.COMPLETE="complete",Se.EventType=Ce,Ce.OPEN="a",Ce.CLOSE="b",Ce.ERROR="c",Ce.MESSAGE="d",Xt.prototype.listen=Xt.prototype.va,Mn.prototype.listenOnce=Mn.prototype.wa,Mn.prototype.getLastError=Mn.prototype.Qa,Mn.prototype.getLastErrorCode=Mn.prototype.ua,Mn.prototype.getStatus=Mn.prototype.W,Mn.prototype.getResponseJson=Mn.prototype.Pa,Mn.prototype.getResponseText=Mn.prototype.$,Mn.prototype.send=Mn.prototype.ba;var Er=Ne,Tr=xe,jr=me,Ar=Se,Nr=Mn,xr=n("/6Yf"),kr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},Sr=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Dr=function(){function t(t){this.uid=t}return t.prototype.u=function(){return null!=this.uid},t.prototype.h=function(){return this.u()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Dr.UNAUTHENTICATED=new Dr(null),Dr.l=new Dr("google-credentials-uid"),Dr._=new Dr("first-party-uid");var Cr=new T.b("@firebase/firestore");function Pr(){return Cr.logLevel}function Rr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Cr.logLevel<=T.a.DEBUG){var r=e.map(Ur);Cr.debug.apply(Cr,Object(O.i)(["Firestore (8.1.1): "+t],r))}}function Lr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Cr.logLevel<=T.a.ERROR){var r=e.map(Ur);Cr.error.apply(Cr,Object(O.i)(["Firestore (8.1.1): "+t],r))}}function Vr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Cr.logLevel<=T.a.WARN){var r=e.map(Ur);Cr.warn.apply(Cr,Object(O.i)(["Firestore (8.1.1): "+t],r))}}function Ur(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(e){return t}}function Mr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.1.1) INTERNAL ASSERTION FAILED: "+t;throw Lr(e),new Error(e)}function qr(t,e){t||Mr()}function Fr(t,e){return t}var zr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Br=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(O.d)(e,t),e}(Error),Gr=function(t,e){this.user=e,this.type="OAuth",this.T={},this.T.Authorization="Bearer "+t},Kr=function(){function t(){this.I=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.m=function(){},t.prototype.A=function(t){this.I=t,t(Dr.UNAUTHENTICATED)},t.prototype.R=function(){this.I=null},t}(),Wr=function(){function t(t){var e=this;this.P=null,this.currentUser=Dr.UNAUTHENTICATED,this.g=!1,this.V=0,this.I=null,this.forceRefresh=!1,this.P=function(){e.V++,e.currentUser=e.p(),e.g=!0,e.I&&e.I(e.currentUser)},this.V=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.P):(this.P(null),t.get().then(function(t){e.auth=t,e.P&&e.auth.addAuthTokenListener(e.P)},function(){}))}return t.prototype.getToken=function(){var t=this,e=this.V,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.V!==e?(Rr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(qr("string"==typeof n.accessToken),new Gr(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.m=function(){this.forceRefresh=!0},t.prototype.A=function(t){this.I=t,this.g&&t(this.currentUser)},t.prototype.R=function(){this.auth&&this.auth.removeAuthTokenListener(this.P),this.P=null,this.I=null},t.prototype.p=function(){var t=this.auth&&this.auth.getUid();return qr(null===t||"string"==typeof t),new Dr(t)},t}(),Hr=function(){function t(t,e){this.v=t,this.S=e,this.type="FirstParty",this.user=Dr._}return Object.defineProperty(t.prototype,"T",{get:function(){var t={"X-Goog-AuthUser":this.S},e=this.v.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Xr=function(){function t(t,e){this.v=t,this.S=e}return t.prototype.getToken=function(){return Promise.resolve(new Hr(this.v,this.S))},t.prototype.A=function(t){t(Dr._)},t.prototype.R=function(){},t.prototype.m=function(){},t}();function Qr(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Yr=function(){function t(){}return t.D=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Qr(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Jr(t,e){return t<e?-1:t>e?1:0}function $r(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function Zr(t){return t+"\0"}var ti=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Br(zr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Br(zr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Br(zr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Br(zr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.C=function(t){return this.seconds===t.seconds?Jr(this.nanoseconds,t.nanoseconds):Jr(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),ei=function(){function t(t){this.timestamp=t}return t.N=function(e){return new t(e)},t.min=function(){return new t(new ti(0,0))},t.prototype.F=function(t){return this.timestamp.C(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.O=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.M=function(){return this.timestamp},t}(),ni=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Mr(),void 0===n?n=t.length-e:n>t.length-e&&Mr(),this.segments=t,this.offset=e,this.k=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.k},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.$(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.L(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.B=function(t){return this.L(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.q=function(){return this.L(this.segments,this.offset,this.length-1)},t.prototype.U=function(){return this.segments[this.offset]},t.prototype.K=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.W=function(){return 0===this.length},t.prototype.j=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.G=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.H=function(){return this.segments.slice(this.offset,this.limit())},t.$=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),ri=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(O.d)(e,t),e.prototype.L=function(t,n,r){return new e(t,n,r)},e.prototype.J=function(){return this.H().join("/")},e.prototype.toString=function(){return this.J()},e.Y=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var u=o[i];if(u.indexOf("//")>=0)throw new Br(zr.INVALID_ARGUMENT,"Invalid segment ("+u+"). Paths must not contain // in them.");r.push.apply(r,u.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.X=function(){return new e([])},e}(ni),ii=/^[_a-zA-Z][_a-zA-Z0-9]*$/,oi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(O.d)(e,t),e.prototype.L=function(t,n,r){return new e(t,n,r)},e.Z=function(t){return ii.test(t)},e.prototype.J=function(){return this.H().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.Z(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.J()},e.prototype.tt=function(){return 1===this.length&&"__name__"===this.get(0)},e.et=function(){return new e(["__name__"])},e.nt=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Br(zr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},u=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Br(zr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Br(zr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===s?(u=!u,i++):"."!==s||u?(r+=s,i++):(o(),i++)}if(o(),u)throw new Br(zr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.X=function(){return new e([])},e}(ni),ui=function(){function t(t){this.path=t}return t.st=function(e){return new t(ri.Y(e))},t.it=function(e){return new t(ri.Y(e).B(5))},t.prototype.rt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===ri.$(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.$=function(t,e){return ri.$(t.path,e.path)},t.ot=function(t){return t.length%2==0},t.ct=function(e){return new t(new ri(e.slice()))},t}();function si(t){return null==t}function ai(t){return 0===t&&1/t==-1/0}function ci(t){return"number"==typeof t&&Number.isInteger(t)&&!ai(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var hi=function(t,e,n,r,i,o,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=u,this.ut=null};function fi(t,e,n,r,i,o,u){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===u&&(u=null),new hi(t,e,n,r,i,o,u)}function li(t){var e=Fr(t);if(null===e.ut){var n=e.path.J();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.J()+t.op.toString()+so(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return function(t){return t.field.J()+t.dir}(t)}).join(","),si(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=hs(e.startAt)),e.endAt&&(n+="|ub:",n+=hs(e.endAt)),e.ut=n}return e.ut}function pi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!vs(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!ro(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ls(t.startAt,e.startAt)&&ls(t.endAt,e.endAt)}function di(t){return ui.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}var vi=function(){function t(t){this.at=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.at)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.at)},t.prototype.ht=function(){return 2*this.at.length},t.prototype.F=function(t){return Jr(this.at,t.at)},t.prototype.isEqual=function(t){return this.at===t.at},t}();vi.lt=new vi("");var yi,gi,bi=function(){function t(t,e,n,r,i,o,u){void 0===i&&(i=ei.min()),void 0===o&&(o=ei.min()),void 0===u&&(u=vi.lt),this.target=t,this.targetId=e,this._t=n,this.sequenceNumber=r,this.ft=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u}return t.prototype.dt=function(e){return new t(this.target,this.targetId,this._t,e,this.ft,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.wt=function(e,n){return new t(this.target,this.targetId,this._t,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Et=function(e){return new t(this.target,this.targetId,this._t,this.sequenceNumber,this.ft,e,this.resumeToken)},t}(),mi=function(t){this.count=t};function wi(t){switch(t){case zr.OK:return Mr();case zr.CANCELLED:case zr.UNKNOWN:case zr.DEADLINE_EXCEEDED:case zr.RESOURCE_EXHAUSTED:case zr.INTERNAL:case zr.UNAVAILABLE:case zr.UNAUTHENTICATED:return!1;case zr.INVALID_ARGUMENT:case zr.NOT_FOUND:case zr.ALREADY_EXISTS:case zr.PERMISSION_DENIED:case zr.FAILED_PRECONDITION:case zr.ABORTED:case zr.OUT_OF_RANGE:case zr.UNIMPLEMENTED:case zr.DATA_LOSS:return!0;default:return Mr()}}function _i(t){if(void 0===t)return Lr("GRPC error has no .code"),zr.UNKNOWN;switch(t){case yi.OK:return zr.OK;case yi.CANCELLED:return zr.CANCELLED;case yi.UNKNOWN:return zr.UNKNOWN;case yi.DEADLINE_EXCEEDED:return zr.DEADLINE_EXCEEDED;case yi.RESOURCE_EXHAUSTED:return zr.RESOURCE_EXHAUSTED;case yi.INTERNAL:return zr.INTERNAL;case yi.UNAVAILABLE:return zr.UNAVAILABLE;case yi.UNAUTHENTICATED:return zr.UNAUTHENTICATED;case yi.INVALID_ARGUMENT:return zr.INVALID_ARGUMENT;case yi.NOT_FOUND:return zr.NOT_FOUND;case yi.ALREADY_EXISTS:return zr.ALREADY_EXISTS;case yi.PERMISSION_DENIED:return zr.PERMISSION_DENIED;case yi.FAILED_PRECONDITION:return zr.FAILED_PRECONDITION;case yi.ABORTED:return zr.ABORTED;case yi.OUT_OF_RANGE:return zr.OUT_OF_RANGE;case yi.UNIMPLEMENTED:return zr.UNIMPLEMENTED;case yi.DATA_LOSS:return zr.DATA_LOSS;default:return Mr()}}(gi=yi||(yi={}))[gi.OK=0]="OK",gi[gi.CANCELLED=1]="CANCELLED",gi[gi.UNKNOWN=2]="UNKNOWN",gi[gi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",gi[gi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",gi[gi.NOT_FOUND=5]="NOT_FOUND",gi[gi.ALREADY_EXISTS=6]="ALREADY_EXISTS",gi[gi.PERMISSION_DENIED=7]="PERMISSION_DENIED",gi[gi.UNAUTHENTICATED=16]="UNAUTHENTICATED",gi[gi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",gi[gi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",gi[gi.ABORTED=10]="ABORTED",gi[gi.OUT_OF_RANGE=11]="OUT_OF_RANGE",gi[gi.UNIMPLEMENTED=12]="UNIMPLEMENTED",gi[gi.INTERNAL=13]="INTERNAL",gi[gi.UNAVAILABLE=14]="UNAVAILABLE",gi[gi.DATA_LOSS=15]="DATA_LOSS";var Ii=function(){function t(t,e){this.$=t,this.root=e||Ei.EMPTY}return t.prototype.Tt=function(e,n){return new t(this.$,this.root.Tt(e,n,this.$).copy(null,null,Ei.It,null,null))},t.prototype.remove=function(e){return new t(this.$,this.root.remove(e,this.$).copy(null,null,Ei.It,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.W();){var n=this.$(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.W();){var r=this.$(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.W=function(){return this.root.W()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.At=function(){return this.root.At()},t.prototype.Rt=function(){return this.root.Rt()},t.prototype.Pt=function(t){return this.root.Pt(t)},t.prototype.forEach=function(t){this.Pt(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.Pt(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.gt=function(t){return this.root.gt(t)},t.prototype.yt=function(){return new Oi(this.root,null,this.$,!1)},t.prototype.Vt=function(t){return new Oi(this.root,t,this.$,!1)},t.prototype.vt=function(){return new Oi(this.root,null,this.$,!0)},t.prototype.bt=function(t){return new Oi(this.root,t,this.$,!0)},t}(),Oi=function(){function t(t,e,n,r){this.St=r,this.Dt=[];for(var i=1;!t.W();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.St?t.left:t.right;else{if(0===i){this.Dt.push(t);break}this.Dt.push(t),t=this.St?t.right:t.left}}return t.prototype.Ct=function(){var t=this.Dt.pop(),e={key:t.key,value:t.value};if(this.St)for(t=t.left;!t.W();)this.Dt.push(t),t=t.right;else for(t=t.right;!t.W();)this.Dt.push(t),t=t.left;return e},t.prototype.Nt=function(){return this.Dt.length>0},t.prototype.xt=function(){if(0===this.Dt.length)return null;var t=this.Dt[this.Dt.length-1];return{key:t.key,value:t.value}},t}(),Ei=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.W=function(){return!1},t.prototype.Pt=function(t){return this.left.Pt(t)||t(this.key,this.value)||this.right.Pt(t)},t.prototype.gt=function(t){return this.right.gt(t)||t(this.key,this.value)||this.left.gt(t)},t.prototype.min=function(){return this.left.W()?this:this.left.min()},t.prototype.At=function(){return this.min().key},t.prototype.Rt=function(){return this.right.W()?this.key:this.right.Rt()},t.prototype.Tt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Tt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Tt(t,e,n))).Ft()},t.prototype.Ot=function(){if(this.left.W())return t.EMPTY;var e=this;return e.left.Mt()||e.left.left.Mt()||(e=e.kt()),(e=e.copy(null,null,null,e.left.Ot(),null)).Ft()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.W()||i.left.Mt()||i.left.left.Mt()||(i=i.kt()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.Mt()&&(i=i.$t()),i.right.W()||i.right.Mt()||i.right.left.Mt()||(i=i.Lt()),0===n(e,i.key)){if(i.right.W())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.Ot())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.Ft()},t.prototype.Mt=function(){return this.color},t.prototype.Ft=function(){var t=this;return t.right.Mt()&&!t.left.Mt()&&(t=t.Bt()),t.left.Mt()&&t.left.left.Mt()&&(t=t.$t()),t.left.Mt()&&t.right.Mt()&&(t=t.qt()),t},t.prototype.kt=function(){var t=this.qt();return t.right.left.Mt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.$t())).Bt()).qt()),t},t.prototype.Lt=function(){var t=this.qt();return t.left.left.Mt()&&(t=(t=t.$t()).qt()),t},t.prototype.Bt=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.$t=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ut=function(){var t=this.Qt();return Math.pow(2,t)<=this.size+1},t.prototype.Qt=function(){if(this.Mt()&&this.left.Mt())throw Mr();if(this.right.Mt())throw Mr();var t=this.left.Qt();if(t!==this.right.Qt())throw Mr();return t+(this.Mt()?0:1)},t}();Ei.EMPTY=null,Ei.RED=!0,Ei.It=!1,Ei.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.Tt=function(t,e,n){return new Ei(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.W=function(){return!0},t.prototype.Pt=function(t){return!1},t.prototype.gt=function(t){return!1},t.prototype.At=function(){return null},t.prototype.Rt=function(){return null},t.prototype.Mt=function(){return!1},t.prototype.Ut=function(){return!0},t.prototype.Qt=function(){return 0},t}());var Ti=function(){function t(t){this.$=t,this.data=new Ii(this.$)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.At()},t.prototype.last=function(){return this.data.Rt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Pt(function(e,n){return t(e),!1})},t.prototype.Kt=function(t,e){for(var n=this.data.Vt(t[0]);n.Nt();){var r=n.Ct();if(this.$(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Wt=function(t,e){var n;for(n=void 0!==e?this.data.Vt(e):this.data.yt();n.Nt();)if(!t(n.Ct().key))return},t.prototype.jt=function(t){var e=this.data.Vt(t);return e.Nt()?e.Ct().key:null},t.prototype.yt=function(){return new ji(this.data.yt())},t.prototype.Vt=function(t){return new ji(this.data.Vt(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).Tt(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.W=function(){return this.data.W()},t.prototype.Gt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.yt(),r=e.data.yt();n.Nt();){var i=n.Ct().key,o=r.Ct().key;if(0!==this.$(i,o))return!1}return!0},t.prototype.H=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.$);return n.data=e,n},t}(),ji=function(){function t(t){this.zt=t}return t.prototype.Ct=function(){return this.zt.Ct().key},t.prototype.Nt=function(){return this.zt.Nt()},t}(),Ai=new Ii(ui.$);function Ni(){return Ai}function xi(){return Ni()}var ki=new Ii(ui.$);function Si(){return ki}var Di=new Ii(ui.$),Ci=new Ti(ui.$);function Pi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ci,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Ri=new Ti(Jr);function Li(){return Ri}var Vi=function(){function t(t){this.$=t?function(e,n){return t(e,n)||ui.$(e.key,n.key)}:function(t,e){return ui.$(t.key,e.key)},this.Ht=Si(),this.Jt=new Ii(this.$)}return t.Yt=function(e){return new t(e.$)},t.prototype.has=function(t){return null!=this.Ht.get(t)},t.prototype.get=function(t){return this.Ht.get(t)},t.prototype.first=function(){return this.Jt.At()},t.prototype.last=function(){return this.Jt.Rt()},t.prototype.W=function(){return this.Jt.W()},t.prototype.indexOf=function(t){var e=this.Ht.get(t);return e?this.Jt.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Jt.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Jt.Pt(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ht.Tt(t.key,t),e.Jt.Tt(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ht.remove(t),this.Jt.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Jt.yt(),r=e.Jt.yt();n.Nt();){var i=n.Ct().key,o=r.Ct().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.$=this.$,r.Ht=e,r.Jt=n,r},t}(),Ui=function(){function t(){this.Xt=new Ii(ui.$)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Xt.get(e);n?0!==t.type&&3===n.type?this.Xt=this.Xt.Tt(e,t):3===t.type&&1!==n.type?this.Xt=this.Xt.Tt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Xt=this.Xt.Tt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Xt=this.Xt.remove(e):1===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):Mr():this.Xt=this.Xt.Tt(e,t)},t.prototype.Zt=function(){var t=[];return this.Xt.Pt(function(e,n){t.push(n)}),t},t}(),Mi=function(){function t(t,e,n,r,i,o,u,s){this.query=t,this.docs=e,this.te=n,this.docChanges=r,this.ee=i,this.fromCache=o,this.ne=u,this.se=s}return t.ie=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,Vi.Yt(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.ee.W()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.ne===t.ne&&this.ee.isEqual(t.ee)&&Qu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.te.isEqual(t.te)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),qi=function(){function t(t,e,n,r,i){this.ft=t,this.re=e,this.oe=n,this.ce=r,this.ue=i}return t.ae=function(e,n){var r=new Map;return r.set(e,Fi.he(e,n)),new t(ei.min(),r,Li(),Ni(),Pi())},t}(),Fi=function(){function t(t,e,n,r,i){this.resumeToken=t,this.le=e,this._e=n,this.fe=r,this.de=i}return t.he=function(e,n){return new t(vi.lt,n,Pi(),Pi(),Pi())},t}(),zi=function(t,e,n,r){this.we=t,this.removedTargetIds=e,this.key=n,this.Ee=r},Bi=function(t,e){this.targetId=t,this.Te=e},Gi=function(t,e,n,r){void 0===n&&(n=vi.lt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Ki=function(){function t(){this.Ie=0,this.me=Xi(),this.Ae=vi.lt,this.Re=!1,this.Pe=!0}return Object.defineProperty(t.prototype,"le",{get:function(){return this.Re},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Ae},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ge",{get:function(){return 0!==this.Ie},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ye",{get:function(){return this.Pe},enumerable:!1,configurable:!0}),t.prototype.Ve=function(t){t.ht()>0&&(this.Pe=!0,this.Ae=t)},t.prototype.pe=function(){var t=Pi(),e=Pi(),n=Pi();return this.me.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Mr()}}),new Fi(this.Ae,this.Re,t,e,n)},t.prototype.ve=function(){this.Pe=!1,this.me=Xi()},t.prototype.be=function(t,e){this.Pe=!0,this.me=this.me.Tt(t,e)},t.prototype.Se=function(t){this.Pe=!0,this.me=this.me.remove(t)},t.prototype.De=function(){this.Ie+=1},t.prototype.Ce=function(){this.Ie-=1},t.prototype.Ne=function(){this.Pe=!0,this.Re=!0},t}(),Wi=function(){function t(t){this.xe=t,this.Fe=new Map,this.Oe=Ni(),this.Me=Hi(),this.ke=new Ti(Jr)}return t.prototype.$e=function(t){for(var e=0,n=t.we;e<n.length;e++){var r=n[e];t.Ee instanceof Ru?this.Le(r,t.Ee):t.Ee instanceof Lu&&this.Be(r,t.key,t.Ee)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.Be(o[i],t.key,t.Ee)},t.prototype.qe=function(t){var e=this;this.Ue(t,function(n){var r=e.Qe(n);switch(t.state){case 0:e.Ke(n)&&r.Ve(t.resumeToken);break;case 1:r.Ce(),r.ge||r.ve(),r.Ve(t.resumeToken);break;case 2:r.Ce(),r.ge||e.removeTarget(n);break;case 3:e.Ke(n)&&(r.Ne(),r.Ve(t.resumeToken));break;case 4:e.Ke(n)&&(e.We(n),r.Ve(t.resumeToken));break;default:Mr()}})},t.prototype.Ue=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.Fe.forEach(function(t,r){n.Ke(r)&&e(r)})},t.prototype.je=function(t){var e=t.targetId,n=t.Te.count,r=this.Ge(e);if(r){var i=r.target;if(di(i))if(0===n){var o=new ui(i.path);this.Be(e,o,new Lu(o,ei.min()))}else qr(1===n);else this.ze(e)!==n&&(this.We(e),this.ke=this.ke.add(e))}},t.prototype.He=function(t){var e=this,n=new Map;this.Fe.forEach(function(r,i){var o=e.Ge(i);if(o){if(r.le&&di(o.target)){var u=new ui(o.target.path);null!==e.Oe.get(u)||e.Je(i,u)||e.Be(i,u,new Lu(u,t))}r.ye&&(n.set(i,r.pe()),r.ve())}});var r=Pi();this.Me.forEach(function(t,n){var i=!0;n.Wt(function(t){var n=e.Ge(t);return!n||2===n._t||(i=!1,!1)}),i&&(r=r.add(t))});var i=new qi(t,n,this.ke,this.Oe,r);return this.Oe=Ni(),this.Me=Hi(),this.ke=new Ti(Jr),i},t.prototype.Le=function(t,e){if(this.Ke(t)){var n=this.Je(t,e.key)?2:0;this.Qe(t).be(e.key,n),this.Oe=this.Oe.Tt(e.key,e),this.Me=this.Me.Tt(e.key,this.Ye(e.key).add(t))}},t.prototype.Be=function(t,e,n){if(this.Ke(t)){var r=this.Qe(t);this.Je(t,e)?r.be(e,1):r.Se(e),this.Me=this.Me.Tt(e,this.Ye(e).delete(t)),n&&(this.Oe=this.Oe.Tt(e,n))}},t.prototype.removeTarget=function(t){this.Fe.delete(t)},t.prototype.ze=function(t){var e=this.Qe(t).pe();return this.xe.Xe(t).size+e._e.size-e.de.size},t.prototype.De=function(t){this.Qe(t).De()},t.prototype.Qe=function(t){var e=this.Fe.get(t);return e||(e=new Ki,this.Fe.set(t,e)),e},t.prototype.Ye=function(t){var e=this.Me.get(t);return e||(e=new Ti(Jr),this.Me=this.Me.Tt(t,e)),e},t.prototype.Ke=function(t){var e=null!==this.Ge(t);return e||Rr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.Ge=function(t){var e=this.Fe.get(t);return e&&e.ge?null:this.xe.Ze(t)},t.prototype.We=function(t){var e=this;this.Fe.set(t,new Ki),this.xe.Xe(t).forEach(function(n){e.Be(t,n,null)})},t.prototype.Je=function(t,e){return this.xe.Xe(t).has(e)},t}();function Hi(){return new Ii(ui.$)}function Xi(){return new Ii(ui.$)}function Qi(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Yi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ji(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function $i(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Zi(t){var e=t.mapValue.fields.__previous_value__;return $i(e)?Zi(e):e}function to(t){var e=co(t.mapValue.fields.__local_write_time__.timestampValue);return new ti(e.seconds,e.nanos)}var eo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function no(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?$i(t)?4:10:Mr()}function ro(t,e){var n=no(t);if(n!==no(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return to(t).isEqual(to(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=co(t.timestampValue),r=co(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return fo(t.bytesValue).isEqual(fo(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return ho(t.geoPointValue.latitude)===ho(e.geoPointValue.latitude)&&ho(t.geoPointValue.longitude)===ho(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return ho(t.integerValue)===ho(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=ho(t.doubleValue),r=ho(e.doubleValue);return n===r?ai(n)===ai(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return $r(t.arrayValue.values||[],e.arrayValue.values||[],ro);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Qi(n)!==Qi(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!ro(n[i],r[i])))return!1;return!0}(t,e);default:return Mr()}}function io(t,e){return void 0!==(t.values||[]).find(function(t){return ro(t,e)})}function oo(t,e){var n=no(t),r=no(e);if(n!==r)return Jr(n,r);switch(n){case 0:return 0;case 1:return Jr(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=ho(t.integerValue||t.doubleValue),r=ho(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return uo(t.timestampValue,e.timestampValue);case 4:return uo(to(t),to(e));case 5:return Jr(t.stringValue,e.stringValue);case 6:return function(t,e){var n=fo(t),r=fo(e);return n.F(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Jr(n[i],r[i]);if(0!==o)return o}return Jr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Jr(ho(t.latitude),ho(e.latitude));return 0!==n?n:Jr(ho(t.longitude),ho(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=oo(n[i],r[i]);if(o)return o}return Jr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var u=0;u<r.length&&u<o.length;++u){var s=Jr(r[u],o[u]);if(0!==s)return s;var a=oo(n[r[u]],i[o[u]]);if(0!==a)return a}return Jr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Mr()}}function uo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Jr(t,e);var n=co(t),r=co(e),i=Jr(n.seconds,r.seconds);return 0!==i?i:Jr(n.nanos,r.nanos)}function so(t){return ao(t)}function ao(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=co(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?fo(t.bytesValue).toBase64():"referenceValue"in t?ui.it(t.referenceValue).toString():"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=ao(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+ao(t.fields[o])}return e+"}"}(t.mapValue):Mr();var e}function co(t){if(qr(!!t),"string"==typeof t){var e=0,n=eo.exec(t);if(qr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ho(t.seconds),nanos:ho(t.nanos)}}function ho(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function fo(t){return"string"==typeof t?vi.fromBase64String(t):vi.fromUint8Array(t)}function lo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.J()}}function po(t){return!!t&&"integerValue"in t}function vo(t){return!!t&&"arrayValue"in t}function yo(t){return!!t&&"nullValue"in t}function go(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function bo(t){return!!t&&"mapValue"in t}var mo={asc:"ASCENDING",desc:"DESCENDING"},wo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_o=function(t,e){this.t=t,this.tn=e};function Io(t){return{integerValue:""+t}}function Oo(t,e){if(t.tn){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ai(e)?"-0":e}}function Eo(t,e){return ci(e)?Io(e):Oo(t,e)}function To(t,e){return t.tn?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function jo(t,e){return t.tn?e.toBase64():e.toUint8Array()}function Ao(t,e){return To(t,e.M())}function No(t){return qr(!!t),ei.N(function(t){var e=co(t);return new ti(e.seconds,e.nanos)}(t))}function xo(t,e){return function(t){return new ri(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).J()}function ko(t){var e=ri.Y(t);return qr(Zo(e)),e}function So(t,e){return xo(t.t,e.path)}function Do(t,e){var n=ko(e);if(n.get(1)!==t.t.projectId)throw new Br(zr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.t.projectId);if(n.get(3)!==t.t.database)throw new Br(zr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.t.database);return new ui(Lo(n))}function Co(t,e){return xo(t.t,e)}function Po(t){var e=ko(t);return 4===e.length?ri.X():Lo(e)}function Ro(t){return new ri(["projects",t.t.projectId,"databases",t.t.database]).J()}function Lo(t){return qr(t.length>4&&"documents"===t.get(4)),t.B(5)}function Vo(t,e,n){return{name:So(t,e),fields:n.proto.mapValue.fields}}function Uo(t,e){var n;if(e instanceof Ou)n={update:Vo(t,e.key,e.value)};else if(e instanceof xu)n={delete:So(t,e.key)};else if(e instanceof Eu)n={update:Vo(t,e.key,e.data),updateMask:$o(e.en)};else if(e instanceof ju)n={transform:{document:So(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof iu)return{fieldPath:e.field.J(),setToServerValue:"REQUEST_TIME"};if(n instanceof ou)return{fieldPath:e.field.J(),appendMissingElements:{values:n.elements}};if(n instanceof su)return{fieldPath:e.field.J(),removeAllFromArray:{values:n.elements}};if(n instanceof cu)return{fieldPath:e.field.J(),increment:n.nn};throw Mr()}(0,t)})}};else{if(!(e instanceof ku))return Mr();n={verify:So(t,e.key)}}return e.rn.sn||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Ao(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Mr()}(t,e.rn)),n}function Mo(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?vu.updateTime(No(t.updateTime)):void 0!==t.exists?vu.exists(t.exists):vu.on()}(e.currentDocument):vu.on();if(e.update){var r=Do(t,e.update.name),i=new Su({mapValue:{fields:e.update.fields}});if(e.updateMask){var o=function(t){return new lu((t.fieldPaths||[]).map(function(t){return oi.nt(t)}))}(e.updateMask);return new Eu(r,i,o,n)}return new Ou(r,i,n)}if(e.delete){var u=Do(t,e.delete);return new xu(u,n)}if(e.transform){var s=Do(t,e.transform.document),a=e.transform.fieldTransforms.map(function(e){return function(t,e){var n=null;"setToServerValue"in e?(qr("REQUEST_TIME"===e.setToServerValue),n=new iu):"appendMissingElements"in e?n=new ou(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new su(e.removeAllFromArray.values||[]):"increment"in e?n=new cu(t,e.increment):Mr();var r=oi.nt(e.fieldPath);return new pu(r,n)}(t,e)});return qr(!0===n.exists),new ju(s,a)}if(e.verify){var c=Do(t,e.verify);return new ku(c,n)}return Mr()}function qo(t,e){return{documents:[Co(t,e.path)]}}function Fo(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Co(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Co(t,r.q()),n.structuredQuery.from=[{collectionId:r.K()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(go(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NAN"}};if(yo(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(go(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NOT_NAN"}};if(yo(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xo(t.field),op:Ho(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:Xo(t.field),direction:Wo(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var u=function(t,e){return t.tn||si(e)?e:{value:e}}(t,e.limit);return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=Go(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Go(e.endAt)),n}function zo(t){var e=Po(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){qr(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var u=[];n.where&&(u=Bo(n.where));var s=[];n.orderBy&&(s=n.orderBy.map(function(t){return function(t){return new ps(Qo(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var a=null;n.limit&&(a=function(t){var e;return si(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Ko(n.startAt));var h=null;return n.endAt&&(h=Ko(n.endAt)),Mu(e,i,s,u,a,"F",c,h)}function Bo(t){return t?void 0!==t.unaryFilter?[Jo(t)]:void 0!==t.fieldFilter?[Yo(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return Bo(t)}).reduce(function(t,e){return t.concat(e)}):Mr():[]}function Go(t){return{before:t.before,values:t.position}}function Ko(t){return new cs(t.values||[],!!t.before)}function Wo(t){return mo[t]}function Ho(t){return wo[t]}function Xo(t){return{fieldPath:t.J()}}function Qo(t){return oi.nt(t.fieldPath)}function Yo(t){return ts.create(Qo(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Mr()}}(t.fieldFilter.op),t.fieldFilter.value)}function Jo(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Qo(t.unaryFilter.field);return ts.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Qo(t.unaryFilter.field);return ts.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Qo(t.unaryFilter.field);return ts.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Qo(t.unaryFilter.field);return ts.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Mr()}}function $o(t){var e=[];return t.fields.forEach(function(t){return e.push(t.J())}),{fieldPaths:e}}function Zo(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var tu=function(){this.cn=void 0};function eu(t,e,n){return t instanceof iu?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof ou?uu(t,e):t instanceof su?au(t,e):function(t,e){var n=ru(t,e),r=hu(n)+hu(t.nn);return po(n)&&po(t.nn)?Io(r):Oo(t.serializer,r)}(t,e)}function nu(t,e,n){return t instanceof ou?uu(t,e):t instanceof su?au(t,e):n}function ru(t,e){return t instanceof cu?po(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var iu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(O.d)(e,t),e}(tu),ou=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(O.d)(e,t),e}(tu);function uu(t,e){for(var n=fu(e),r=function(t){n.some(function(e){return ro(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var su=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(O.d)(e,t),e}(tu);function au(t,e){for(var n=fu(e),r=function(t){n=n.filter(function(e){return!ro(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var cu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).serializer=e,r.nn=n,r}return Object(O.d)(e,t),e}(tu);function hu(t){return ho(t.integerValue||t.doubleValue)}function fu(t){return vo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var lu=function(){function t(t){this.fields=t,t.sort(oi.$)}return t.prototype.un=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].j(t))return!0;return!1},t.prototype.isEqual=function(t){return $r(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),pu=function(t,e){this.field=t,this.transform=e},du=function(t,e){this.version=t,this.transformResults=e},vu=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.on=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"sn",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function yu(t,e){return void 0!==t.updateTime?e instanceof Ru&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Ru}var gu=function(){};function bu(t,e,n){return t instanceof Ou?function(t,e,n){return new Ru(t.key,n.version,t.value,{hasCommittedMutations:!0})}(t,0,n):t instanceof Eu?function(t,e,n){if(!yu(t.rn,e))return new Vu(t.key,n.version);var r=Tu(t,e);return new Ru(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof ju?function(t,e,n){if(qr(null!=n.transformResults),!yu(t.rn,e))return new Vu(t.key,n.version);var r=Au(0,e),i=function(t,e,n){var r=[];qr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],u=o.transform,s=null;e instanceof Ru&&(s=e.field(o.field)),r.push(nu(u,s,n[i]))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,u=Nu(t,r.data(),i);return new Ru(t.key,o,u,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new Lu(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function mu(t,e,n,r){return t instanceof Ou?function(t,e){if(!yu(t.rn,e))return e;var n=Iu(e);return new Ru(t.key,n,t.value,{an:!0})}(t,e):t instanceof Eu?function(t,e){if(!yu(t.rn,e))return e;var n=Iu(e),r=Tu(t,e);return new Ru(t.key,n,r,{an:!0})}(t,e):t instanceof ju?function(t,e,n,r){if(!yu(t.rn,e))return e;var i=Au(0,e),o=function(t,e,n,r){for(var i=[],o=0,u=t;o<u.length;o++){var s=u[o],a=s.transform,c=null;n instanceof Ru&&(c=n.field(s.field)),null===c&&r instanceof Ru&&(c=r.field(s.field)),i.push(eu(a,c,e))}return i}(t.fieldTransforms,n,e,r),u=Nu(t,i.data(),o);return new Ru(t.key,i.version,u,{an:!0})}(t,e,r,n):function(t,e){return yu(t.rn,e)?new Lu(t.key,ei.min()):e}(t,e)}function wu(t,e){return t instanceof ju?function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],u=e instanceof Ru?e.field(o.field):void 0,s=ru(o.transform,u||null);null!=s&&(n=null==n?(new Du).set(o.field,s):n.set(o.field,s))}return n?n.hn():null}(t,e):null}function _u(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.rn.isEqual(e.rn)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.en.isEqual(e.en):2!==t.type||$r(t.fieldTransforms,t.fieldTransforms,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof ou&&e instanceof ou||t instanceof su&&e instanceof su?$r(t.elements,e.elements,ro):t instanceof cu&&e instanceof cu?ro(t.nn,e.nn):t instanceof iu&&e instanceof iu}(t.transform,e.transform)}(t,e)}))}function Iu(t){return t instanceof Ru?t.version:ei.min()}var Ou=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.rn=r,i.type=0,i}return Object(O.d)(e,t),e}(gu),Eu=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.en=r,o.rn=i,o.type=1,o}return Object(O.d)(e,t),e}(gu);function Tu(t,e){return function(t,e){var n=new Du(e);return t.en.fields.forEach(function(e){if(!e.W()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}}),n.hn()}(t,e instanceof Ru?e.data():Su.empty())}var ju=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.rn=vu.exists(!0),r}return Object(O.d)(e,t),e}(gu);function Au(t,e){return e}function Nu(t,e,n){for(var r=new Du(e),i=0;i<t.fieldTransforms.length;i++)r.set(t.fieldTransforms[i].field,n[i]);return r.hn()}var xu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.rn=n,r.type=3,r}return Object(O.d)(e,t),e}(gu),ku=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.rn=n,r.type=4,r}return Object(O.d)(e,t),e}(gu),Su=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.W())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!bo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.K()])||null},t.prototype.isEqual=function(t){return ro(this.proto,t.proto)},t}(),Du=function(){function t(t){void 0===t&&(t=Su.empty()),this.ln=t,this._n=new Map}return t.prototype.set=function(t,e){return this.fn(t,e),this},t.prototype.delete=function(t){return this.fn(t,null),this},t.prototype.fn=function(t,e){for(var n=this._n,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===no(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.K(),e)},t.prototype.hn=function(){var t=this.dn(oi.X(),this._n);return null!=t?new Su(t):this.ln},t.prototype.dn=function(t,e){var n=this,r=!1,i=this.ln.field(t),o=bo(i)?Object.assign({},i.mapValue.fields):{};return e.forEach(function(e,i){if(e instanceof Map){var u=n.dn(t.child(i),e);null!=u&&(o[i]=u,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)}),r?{mapValue:{fields:o}}:null},t}();function Cu(t){var e=[];return Yi(t.fields||{},function(t,n){var r=new oi([t]);if(bo(n)){var i=Cu(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,u=i;o<u.length;o++)e.push(r.child(u[o]))}else e.push(r)}),new lu(e)}var Pu=function(t,e){this.key=t,this.version=e},Ru=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).wn=r,o.an=!!i.an,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return Object(O.d)(e,t),e.prototype.field=function(t){return this.wn.field(t)},e.prototype.data=function(){return this.wn},e.prototype.En=function(){return this.wn.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.an===t.an&&this.hasCommittedMutations===t.hasCommittedMutations&&this.wn.isEqual(t.wn)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.wn.toString()+", {hasLocalMutations: "+this.an+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.an||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(Pu),Lu=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Object(O.d)(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Pu),Vu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(O.d)(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Pu),Uu=function(t,e,n,r,i,o,u,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===u&&(u=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.Tn=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=u,this.endAt=s,this.In=null,this.mn=null};function Mu(t,e,n,r,i,o,u,s){return new Uu(t,e,n,r,i,o,u,s)}function qu(t){return new Uu(t)}function Fu(t){return!si(t.limit)&&"F"===t.limitType}function zu(t){return!si(t.limit)&&"L"===t.limitType}function Bu(t){return t.Tn.length>0?t.Tn[0].field:null}function Gu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.An())return r.field}return null}function Ku(t){return null!==t.collectionGroup}function Wu(t){var e=Fr(t);if(null===e.In){e.In=[];var n=Gu(e),r=Bu(e);if(null!==n&&null===r)n.tt()||e.In.push(new ps(n)),e.In.push(new ps(oi.et(),"asc"));else{for(var i=!1,o=0,u=e.Tn;o<u.length;o++){var s=u[o];e.In.push(s),s.field.tt()&&(i=!0)}if(!i){var a=e.Tn.length>0?e.Tn[e.Tn.length-1].dir:"asc";e.In.push(new ps(oi.et(),a))}}}return e.In}function Hu(t){var e=Fr(t);if(!e.mn)if("F"===e.limitType)e.mn=fi(e.path,e.collectionGroup,Wu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Wu(e);r<i.length;r++){var o=i[r];n.push(new ps(o.field,"desc"===o.dir?"asc":"desc"))}var u=e.endAt?new cs(e.endAt.position,!e.endAt.before):null,s=e.startAt?new cs(e.startAt.position,!e.startAt.before):null;e.mn=fi(e.path,e.collectionGroup,n,e.filters,e.limit,u,s)}return e.mn}function Xu(t,e,n){return new Uu(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Qu(t,e){return pi(Hu(t),Hu(e))&&t.limitType===e.limitType}function Yu(t){return li(Hu(t))+"|lt:"+t.limitType}function Ju(t){return"Query(target="+function(t){var e=t.path.J();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.J()+" "+e.op+" "+so(e.value);var e}).join(", ")+"]"),si(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return function(t){return t.field.J()+" ("+t.dir+")"}(t)}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+hs(t.startAt)),t.endAt&&(e+=", endAt: "+hs(t.endAt)),"Target("+e+")"}(Hu(t))+"; limitType="+t.limitType+")"}function $u(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.rt(t.collectionGroup)&&t.path.j(n):ui.ot(t.path)?t.path.isEqual(n):t.path.G(n)}(t,e)&&function(t,e){for(var n=0,r=t.Tn;n<r.length;n++){var i=r[n];if(!i.field.tt()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!fs(t.startAt,Wu(t),e)||t.endAt&&fs(t.endAt,Wu(t),e))}(t,e)}function Zu(t){return function(e,n){for(var r=!1,i=0,o=Wu(t);i<o.length;i++){var u=o[i],s=ds(u,e,n);if(0!==s)return s;r=r||u.field.tt()}return 0}}var ts=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(O.d)(e,t),e.create=function(t,n,r){return t.tt()?"in"===n||"not-in"===n?this.Rn(t,n,r):new es(t,n,r):"array-contains"===n?new os(t,r):"in"===n?new us(t,r):"not-in"===n?new ss(t,r):"array-contains-any"===n?new as(t,r):new e(t,n,r)},e.Rn=function(t,e,n){return"in"===e?new ns(t,n):new rs(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Pn(oo(e,this.value)):null!==e&&no(this.value)===no(e)&&this.Pn(oo(e,this.value))},e.prototype.Pn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Mr()}},e.prototype.An=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),es=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=ui.it(r.referenceValue),i}return Object(O.d)(e,t),e.prototype.matches=function(t){var e=ui.$(t.key,this.key);return this.Pn(e)},e}(ts),ns=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=is(0,n),r}return Object(O.d)(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(ts),rs=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=is(0,n),r}return Object(O.d)(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(ts);function is(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return ui.it(t.referenceValue)})}var os=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(O.d)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return vo(e)&&io(e.arrayValue,this.value)},e}(ts),us=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(O.d)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&io(this.value.arrayValue,e)},e}(ts),ss=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(O.d)(e,t),e.prototype.matches=function(t){if(io(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!io(this.value.arrayValue,e)},e}(ts),as=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(O.d)(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!vo(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return io(e.value.arrayValue,t)})},e}(ts),cs=function(t,e){this.position=t,this.before=e};function hs(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return so(t)}).join(",")}function fs(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],u=t.position[i];if(r=o.field.tt()?ui.$(ui.it(u.referenceValue),n.key):oo(u,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ls(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!ro(t.position[n],e.position[n]))return!1;return!0}var ps=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function ds(t,e,n){var r=t.field.tt()?ui.$(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?oo(r,i):Mr()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Mr()}}function vs(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var ys=function(){function t(t,e,n,r){this.batchId=t,this.gn=e,this.baseMutations=n,this.mutations=r}return t.prototype.yn=function(t,e,n){for(var r=n.Vn,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=bu(o,e,r[i]))}return e},t.prototype.pn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=mu(i,e,e,this.gn))}for(var o=e,u=0,s=this.mutations;u<s.length;u++){var a=s[u];a.key.isEqual(t)&&(e=mu(a,e,o,this.gn))}return e},t.prototype.vn=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.pn(r.key,t.get(r.key));i&&(n=n.Tt(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Pi())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&$r(this.mutations,t.mutations,function(t,e){return _u(t,e)})&&$r(this.baseMutations,t.baseMutations,function(t,e){return _u(t,e)})},t}(),gs=function(){function t(t,e,n,r){this.batch=t,this.bn=e,this.Vn=n,this.Sn=r}return t.from=function(e,n,r){qr(e.mutations.length===r.length);for(var i=Di,o=e.mutations,u=0;u<o.length;u++)i=i.Tt(o[u].key,r[u].version);return new t(e,n,r,i)},t}(),bs=function(){function t(t,e){this.Dn=t,this.Cn=e,this.Nn={}}return t.prototype.get=function(t){var e=this.Dn(t),n=this.Nn[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],u=o[1];if(this.Cn(o[0],t))return u}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.Dn(t),r=this.Nn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.Cn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Nn[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.Dn(t),n=this.Nn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.Cn(n[r][0],t))return 1===n.length?delete this.Nn[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Yi(this.Nn,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}})},t.prototype.W=function(){return Ji(this.Nn)},t}(),ms=function(){function t(t){var e=this;this.xn=null,this.Fn=null,this.result=void 0,this.error=void 0,this.On=!1,this.Mn=!1,t(function(t){e.On=!0,e.result=t,e.xn&&e.xn(t)},function(t){e.On=!0,e.error=t,e.Fn&&e.Fn(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Mn&&Mr(),this.Mn=!0,this.On?this.error?this.kn(n,this.error):this.$n(e,this.result):new t(function(t,i){r.xn=function(n){r.$n(e,n).next(t,i)},r.Fn=function(e){r.kn(n,e).next(t,i)}})},t.prototype.Ln=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.Bn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.$n=function(e,n){return e?this.Bn(function(){return e(n)}):t.resolve(n)},t.prototype.kn=function(e,n){return e?this.Bn(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.qn=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.Un=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.qn(r)},t}(),ws=function(){function t(){this.Qn=new bs(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Kn=!1}return t.prototype.Wn=function(t){var e=this.Qn.get(t);return e?e.readTime:ei.min()},t.prototype.jn=function(t,e){this.Gn(),this.Qn.set(t.key,{zn:t,readTime:e})},t.prototype.Hn=function(t,e){void 0===e&&(e=null),this.Gn(),this.Qn.set(t,{zn:null,readTime:e})},t.prototype.Jn=function(t,e){this.Gn();var n=this.Qn.get(e);return void 0!==n?ms.resolve(n.zn):this.Yn(t,e)},t.prototype.getEntries=function(t,e){return this.Xn(t,e)},t.prototype.apply=function(t){return this.Gn(),this.Kn=!0,this.Zn(t)},t.prototype.Gn=function(){},t}(),_s=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})};function Is(t){return new _o(t,!0)}function Os(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Es="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ts=function(){function t(){this.ts=[]}return t.prototype.es=function(t){this.ts.push(t)},t.prototype.ns=function(){this.ts.forEach(function(t){return t()})},t}(),js=function(){function t(t,e,n){this.ss=t,this.rs=e,this.os=n}return t.prototype.cs=function(t,e){var n=this;return this.rs.us(t,e).next(function(r){return n.hs(t,e,r)})},t.prototype.hs=function(t,e,n){return this.ss.Jn(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].pn(e,t);return t})},t.prototype.ls=function(t,e,n){var r=xi();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].pn(t,e);r=r.Tt(t,e)}),r},t.prototype._s=function(t,e){var n=this;return this.ss.getEntries(t,e).next(function(e){return n.fs(t,e)})},t.prototype.fs=function(t,e){var n=this;return this.rs.ds(t,e).next(function(r){var i=n.ls(t,e,r),o=Ni();return i.forEach(function(t,e){e||(e=new Lu(t,ei.min())),o=o.Tt(t,e)}),o})},t.prototype.ws=function(t,e,n){return function(t){return ui.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Es(t,e.path):Ku(e)?this.Ts(t,e,n):this.Is(t,e,n)},t.prototype.Es=function(t,e){return this.cs(t,new ui(e)).next(function(t){var e=Si();return t instanceof Ru&&(e=e.Tt(t.key,t)),e})},t.prototype.Ts=function(t,e,n){var r=this,i=e.collectionGroup,o=Si();return this.os.As(t,i).next(function(u){return ms.forEach(u,function(u){var s=function(t,e){return new Uu(e,null,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,u.child(i));return r.Is(t,s,n).next(function(t){t.forEach(function(t,e){o=o.Tt(t,e)})})}).next(function(){return o})})},t.prototype.Is=function(t,e,n){var r,i,o=this;return this.ss.ws(t,e,n).next(function(n){return r=n,o.rs.Rs(t,e)}).next(function(e){return o.Ps(t,i=e,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],u=0,s=o.mutations;u<s.length;u++){var a=s[u],c=a.key,h=r.get(c),f=mu(a,h,h,o.gn);r=f instanceof Ru?r.Tt(c,f):r.remove(c)}})}).next(function(){return r.forEach(function(t,n){$u(e,n)||(r=r.remove(t))}),r})},t.prototype.Ps=function(t,e,n){for(var r=Pi(),i=0,o=e;i<o.length;i++)for(var u=0,s=o[i].mutations;u<s.length;u++){var a=s[u];a instanceof Eu&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.ss.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Ru&&(c=c.Tt(t,e))}),c})},t}(),As=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.gs=n,this.ys=r}return t.Vs=function(e,n){for(var r=Pi(),i=Pi(),o=0,u=n.docChanges;o<u.length;o++){var s=u[o];switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Ns=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.ps=function(t){return n.vs(t)},this.bs=function(t){return e.Ss(t)})}return t.prototype.vs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.bs&&this.bs(t),t},t}();Ns.Ds=-1;var xs=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Cs=t,this.Ns=e,this.xs=n,this.Fs=r,this.Os=i,this.Ms=0,this.ks=null,this.$s=Date.now(),this.reset()}return t.prototype.reset=function(){this.Ms=0},t.prototype.Ls=function(){this.Ms=this.Os},t.prototype.Bs=function(t){var e=this;this.cancel();var n=Math.floor(this.Ms+this.qs()),r=Math.max(0,Date.now()-this.$s),i=Math.max(0,n-r);i>0&&Rr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ms+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.ks=this.Cs.Us(this.Ns,i,function(){return e.$s=Date.now(),t()}),this.Ms*=this.Fs,this.Ms<this.xs&&(this.Ms=this.xs),this.Ms>this.Os&&(this.Ms=this.Os)},t.prototype.Qs=function(){null!==this.ks&&(this.ks.Ks(),this.ks=null)},t.prototype.cancel=function(){null!==this.ks&&(this.ks.cancel(),this.ks=null)},t.prototype.qs=function(){return(Math.random()-.5)*this.Ms},t}(),ks=function(){function t(e,n,r){this.name=e,this.version=n,this.Ws=r,12.2===t.js(Object(j.g)())&&Lr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Rr("SimpleDb","Removing database:",t),Ls(window.indexedDB.deleteDatabase(t)).Ln()},t.Gs=function(){if("undefined"==typeof indexedDB)return!1;if(t.zs())return!0;var e=Object(j.g)(),n=t.js(e),r=0<n&&n<10,i=t.Hs(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.zs=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Js)},t.Ys=function(t,e){return t.store(e)},t.js=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Hs=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Xs=function(t){return Object(O.b)(this,void 0,void 0,function(){var e,n=this;return Object(O.e)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(Rr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new Ds(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new Br(zr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new Ds(t,n))},i.onupgradeneeded=function(t){Rr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.Ws.createOrUpgrade(t.target.result,i.transaction,t.oldVersion,n.version).next(function(){Rr("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Zs&&(this.db.onversionchange=function(t){return n.Zs(t)}),this.db)]}})})},t.prototype.ti=function(t){this.Zs=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(O.b)(this,void 0,void 0,function(){var i,o,u,s,a;return Object(O.e)(this,function(c){switch(c.label){case 0:i="readonly"===e,o=0,u=function(){var e,u,a,c,h;return Object(O.e)(this,function(f){switch(f.label){case 0:++o,f.label=1;case 1:return f.trys.push([1,4,,5]),[4,s.Xs(t)];case 2:return s.db=f.sent(),e=Ps.open(s.db,t,i?"readonly":"readwrite",n),u=r(e).catch(function(t){return e.abort(t),ms.reject(t)}).Ln(),a={},u.catch(function(){}),[4,e.ei];case 3:return[2,(a.value=(f.sent(),u),a)];case 4:return Rr("SimpleDb","Transaction failed with error:",(c=f.sent()).message,"Retrying:",h="FirebaseError"!==c.name&&o<3),s.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},s=this,c.label=1;case 1:return[5,u()];case 2:if("object"==typeof(a=c.sent()))return[2,a.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Ss=function(){function t(t){this.ni=t,this.si=!1,this.ii=null}return Object.defineProperty(t.prototype,"On",{get:function(){return this.si},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ri",{get:function(){return this.ii},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.ni=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.si=!0},t.prototype.oi=function(t){this.ii=t},t.prototype.delete=function(){return Ls(this.ni.delete())},t}(),Ds=function(t){function e(e,n){var r=this;return(r=t.call(this,zr.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(O.d)(e,t),e}(Br);function Cs(t){return"IndexedDbTransactionError"===t.name}var Ps=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ci=new _s,this.transaction.oncomplete=function(){n.ci.resolve()},this.transaction.onabort=function(){e.error?n.ci.reject(new Ds(t,e.error)):n.ci.resolve()},this.transaction.onerror=function(e){var r=Us(e.target.error);n.ci.reject(new Ds(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Ds(n,e)}},Object.defineProperty(t.prototype,"ei",{get:function(){return this.ci.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ci.reject(t),this.aborted||(Rr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Rs(e)},t}(),Rs=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Rr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Rr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Ls(n)},t.prototype.add=function(t){return Rr("SimpleDb","ADD",this.store.name,t,t),Ls(this.store.add(t))},t.prototype.get=function(t){var e=this;return Ls(this.store.get(t)).next(function(n){return void 0===n&&(n=null),Rr("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return Rr("SimpleDb","DELETE",this.store.name,t),Ls(this.store.delete(t))},t.prototype.count=function(){return Rr("SimpleDb","COUNT",this.store.name),Ls(this.store.count())},t.prototype.ui=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.ai(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.hi=function(t,e){Rr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.li=!1;var r=this.cursor(n);return this.ai(r,function(t,e,n){return n.delete()})},t.prototype._i=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.ai(r,e)},t.prototype.fi=function(t){var e=this.cursor({});return new ms(function(n,r){e.onerror=function(t){var e=Us(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.ai=function(t,e){var n=[];return new ms(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Ss(i),u=e(i.primaryKey,i.value,o);if(u instanceof ms){var s=u.catch(function(t){return o.done(),ms.reject(t)});n.push(s)}o.On?r():null===o.ri?i.continue():i.continue(o.ri)}else r()}}).next(function(){return ms.qn(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.li?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Ls(t){return new ms(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=Us(t.target.error);n(e)}})}var Vs=!1;function Us(t){var e=ks.js(Object(j.g)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Br("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Vs||(Vs=!0,setTimeout(function(){throw r},0)),r}}return t}function Ms(){return"undefined"!=typeof window?window:null}function qs(){return"undefined"!=typeof document?document:null}var Fs=function(){function t(t,e,n,r,i){this.di=t,this.Ns=e,this.wi=n,this.op=r,this.Ei=i,this.Ti=new _s,this.then=this.Ti.promise.then.bind(this.Ti.promise),this.Ti.promise.catch(function(t){})}return t.Ii=function(e,n,r,i,o){var u=new t(e,n,Date.now()+r,i,o);return u.start(r),u},t.prototype.start=function(t){var e=this;this.mi=setTimeout(function(){return e.Ai()},t)},t.prototype.Ks=function(){return this.Ai()},t.prototype.cancel=function(t){null!==this.mi&&(this.clearTimeout(),this.Ti.reject(new Br(zr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.Ai=function(){var t=this;this.di.Ri(function(){return null!==t.mi?(t.clearTimeout(),t.op().then(function(e){return t.Ti.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.mi&&(this.Ei(this),clearTimeout(this.mi),this.mi=null)},t}(),zs=function(){function t(){var t=this;this.Pi=Promise.resolve(),this.gi=[],this.yi=!1,this.Vi=[],this.pi=null,this.vi=!1,this.bi=[],this.Si=new xs(this,"async_queue_retry"),this.Di=function(){var e=qs();e&&Rr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Si.Qs()};var e=qs();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Di)}return Object.defineProperty(t.prototype,"Ci",{get:function(){return this.yi},enumerable:!1,configurable:!0}),t.prototype.Ri=function(t){this.enqueue(t)},t.prototype.Ni=function(t){this.xi(),this.Fi(t)},t.prototype.Oi=function(){if(!this.yi){this.yi=!0;var t=qs();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Di)}},t.prototype.enqueue=function(t){return this.xi(),this.yi?new Promise(function(t){}):this.Fi(t)},t.prototype.Mi=function(t){var e=this;this.Ri(function(){return e.gi.push(t),e.ki()})},t.prototype.ki=function(){return Object(O.b)(this,void 0,void 0,function(){var t,e=this;return Object(O.e)(this,function(n){switch(n.label){case 0:if(0===this.gi.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.gi[0]()];case 2:return n.sent(),this.gi.shift(),this.Si.reset(),[3,4];case 3:if(!Cs(t=n.sent()))throw t;return Rr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.gi.length>0&&this.Si.Bs(function(){return e.ki()}),n.label=5;case 5:return[2]}})})},t.prototype.Fi=function(t){var e=this,n=this.Pi.then(function(){return e.vi=!0,t().catch(function(t){throw e.pi=t,e.vi=!1,Lr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.vi=!1,t})});return this.Pi=n,n},t.prototype.Us=function(t,e,n){var r=this;this.xi(),this.bi.indexOf(t)>-1&&(e=0);var i=Fs.Ii(this,t,e,n,function(t){return r.$i(t)});return this.Vi.push(i),i},t.prototype.xi=function(){this.pi&&Mr()},t.prototype.Li=function(){},t.prototype.Bi=function(){return Object(O.b)(this,void 0,void 0,function(){var t;return Object(O.e)(this,function(e){switch(e.label){case 0:return[4,t=this.Pi];case 1:e.sent(),e.label=2;case 2:if(t!==this.Pi)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.qi=function(t){for(var e=0,n=this.Vi;e<n.length;e++)if(n[e].Ns===t)return!0;return!1},t.prototype.Ui=function(t){var e=this;return this.Bi().then(function(){e.Vi.sort(function(t,e){return t.wi-e.wi});for(var n=0,r=e.Vi;n<r.length;n++){var i=r[n];if(i.Ks(),"all"!==t&&i.Ns===t)break}return e.Bi()})},t.prototype.Qi=function(t){this.bi.push(t)},t.prototype.$i=function(t){var e=this.Vi.indexOf(t);this.Vi.splice(e,1)},t}();function Bs(t,e){if(Lr("AsyncQueue",e+": "+t),Cs(t))return new Br(zr.UNAVAILABLE,e+": "+t);throw t}function Gs(t,e){var n=t[1],r=e[1],i=Jr(t[0],e[0]);return 0===i?Jr(n,r):i}var Ks=function(){function t(t){this.Ki=t,this.buffer=new Ti(Gs),this.Wi=0}return t.prototype.ji=function(){return++this.Wi},t.prototype.Gi=function(t){var e=[t,this.ji()];if(this.buffer.size<this.Ki)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Gs(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Ws={zi:!1,Hi:0,Ji:0,Yi:0},Hs=function(){function t(t,e,n){this.Xi=t,this.Zi=e,this.tr=n}return t.er=function(e){return new t(e,t.nr,t.sr)},t}();Hs.nr=10,Hs.sr=1e3,Hs.ir=new Hs(41943040,Hs.nr,Hs.sr),Hs.rr=new Hs(-1,0,0);var Xs=function(){function t(t,e){this.cr=t,this.di=e,this.ur=!1,this.ar=null}return t.prototype.start=function(t){-1!==this.cr.params.Xi&&this.hr(t)},t.prototype.stop=function(){this.ar&&(this.ar.cancel(),this.ar=null)},Object.defineProperty(t.prototype,"lr",{get:function(){return null!==this.ar},enumerable:!1,configurable:!0}),t.prototype.hr=function(t){var e=this,n=this.ur?3e5:6e4;Rr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ar=this.di.Us("lru_garbage_collection",n,function(){return Object(O.b)(e,void 0,void 0,function(){var e;return Object(O.e)(this,function(n){switch(n.label){case 0:this.ar=null,this.ur=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t._r(this.cr)];case 2:return n.sent(),[3,7];case 3:return Cs(e=n.sent())?(Rr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,_c(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.hr(t)];case 8:return n.sent(),[2]}})})})},t}(),Qs=function(){function t(t,e){this.dr=t,this.params=e}return t.prototype.wr=function(t,e){return this.dr.Er(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.Tr=function(t,e){var n=this;if(0===e)return ms.resolve(Ns.Ds);var r=new Ks(e);return this.dr.Ue(t,function(t){return r.Gi(t.sequenceNumber)}).next(function(){return n.dr.Ir(t,function(t){return r.Gi(t)})}).next(function(){return r.maxValue})},t.prototype.mr=function(t,e,n){return this.dr.mr(t,e,n)},t.prototype.Ar=function(t,e){return this.dr.Ar(t,e)},t.prototype.Rr=function(t,e){var n=this;return-1===this.params.Xi?(Rr("LruGarbageCollector","Garbage collection skipped; disabled"),ms.resolve(Ws)):this.Pr(t).next(function(r){return r<n.params.Xi?(Rr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Xi),Ws):n.gr(t,e)})},t.prototype.Pr=function(t){return this.dr.Pr(t)},t.prototype.gr=function(t,e){var n,r,i,o,u,s,a,c=this,h=Date.now();return this.wr(t,this.params.Zi).next(function(e){return e>c.params.tr?(Rr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.tr+" from "+e),r=c.params.tr):r=e,o=Date.now(),c.Tr(t,r)}).next(function(r){return n=r,u=Date.now(),c.mr(t,n,e)}).next(function(e){return i=e,s=Date.now(),c.Ar(t,n)}).next(function(t){return a=Date.now(),Pr()<=T.a.DEBUG&&Rr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(u-o)+"ms\n\tRemoved "+i+" targets in "+(s-u)+"ms\n\tRemoved "+t+" documents in "+(a-s)+"ms\nTotal Duration: "+(a-h)+"ms"),ms.resolve({zi:!0,Hi:r,Ji:i,Yi:t})})},t}();function Ys(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=$s(e)),e=Js(t.get(n),e);return $s(e)}function Js(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function $s(t){return t+"\x01\x01"}function Zs(t){var e=t.length;if(qr(e>=2),2===e)return qr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),ri.X();for(var n=e-2,r=[],i="",o=0;o<e;){var u=t.indexOf("\x01",o);switch((u<0||u>n)&&Mr(),t.charAt(u+1)){case"\x01":var s=t.substring(o,u),a=void 0;0===i.length?a=s:(a=i+=s,i=""),r.push(a);break;case"\x10":i+=t.substring(o,u),i+="\0";break;case"\x11":i+=t.substring(o,u+1);break;default:Mr()}o=u+2}return new ri(r)}var ta=function(t){this.yr=t};function ea(t,e){if(e.document)return function(t,e,n){var r=Do(t,e.name),i=No(e.updateTime),o=new Su({mapValue:{fields:e.fields}});return new Ru(r,i,o,{hasCommittedMutations:!!n})}(t.yr,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=ui.ct(e.noDocument.path),r=ua(e.noDocument.readTime);return new Lu(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=ui.ct(e.unknownDocument.path),o=ua(e.unknownDocument.version);return new Vu(i,o)}return Mr()}function na(t,e,n){var r=ra(n),i=e.key.path.q().H();if(e instanceof Ru){var o=function(t,e){return{name:So(t,e.key),fields:e.En().mapValue.fields,updateTime:To(t,e.version.M())}}(t.yr,e);return new Ca(null,null,o,e.hasCommittedMutations,r,i)}if(e instanceof Lu){var u=e.key.path.H(),s=oa(e.version),a=e.hasCommittedMutations;return new Ca(null,new Sa(u,s),null,a,r,i)}if(e instanceof Vu){var c=e.key.path.H(),h=oa(e.version);return new Ca(new Da(c,h),null,null,!0,r,i)}return Mr()}function ra(t){var e=t.M();return[e.seconds,e.nanoseconds]}function ia(t){var e=new ti(t[0],t[1]);return ei.N(e)}function oa(t){var e=t.M();return new ja(e.seconds,e.nanoseconds)}function ua(t){var e=new ti(t.seconds,t.nanoseconds);return ei.N(e)}function sa(t,e){var n=(e.baseMutations||[]).map(function(e){return Mo(t.yr,e)}),r=e.mutations.map(function(e){return Mo(t.yr,e)}),i=ti.fromMillis(e.localWriteTimeMs);return new ys(e.batchId,i,n,r)}function aa(t){var e,n,r=ua(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?ua(t.lastLimboFreeSnapshotVersion):ei.min();return void 0!==t.query.documents?(qr(1===(n=t.query).documents.length),e=Hu(qu(Po(n.documents[0])))):e=function(t){return Hu(zo(t))}(t.query),new bi(e,t.targetId,0,t.lastListenSequenceNumber,r,i,vi.fromBase64String(t.resumeToken))}function ca(t,e){var n,r=oa(e.ft),i=oa(e.lastLimboFreeSnapshotVersion);n=di(e.target)?qo(t.yr,e.target):Fo(t.yr,e.target);var o=e.resumeToken.toBase64();return new Ra(e.targetId,li(e.target),r,o,e.sequenceNumber,i,n)}function ha(t){var e=zo({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Xu(e,e.limit,"L"):e}var fa=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.os=n,this.Vr=r,this.pr={}}return t.vr=function(e,n,r,i){return qr(""!==e.uid),new t(e.u()?e.uid:"",n,r,i)},t.prototype.br=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return da(t)._i({index:xa.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.Sr=function(t,e,n,r){var i=this,o=va(t),u=da(t);return u.add({}).next(function(s){qr("number"==typeof s);for(var a=new ys(s,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return Uo(t.yr,e)}),i=n.mutations.map(function(e){return Uo(t.yr,e)});return new xa(e,n.batchId,n.gn.toMillis(),r,i)}(i.serializer,i.userId,a),h=[],f=new Ti(function(t,e){return Jr(t.J(),e.J())}),l=0,p=r;l<p.length;l++){var d=p[l],v=ka.key(i.userId,d.key.path,s);f=f.add(d.key.path.q()),h.push(u.put(c)),h.push(o.put(v,ka.PLACEHOLDER))}return f.forEach(function(e){h.push(i.os.Dr(t,e))}),t.es(function(){i.pr[s]=a.keys()}),ms.qn(h).next(function(){return a})})},t.prototype.Cr=function(t,e){var n=this;return da(t).get(e).next(function(t){return t?(qr(t.userId===n.userId),sa(n.serializer,t)):null})},t.prototype.Nr=function(t,e){var n=this;return this.pr[e]?ms.resolve(this.pr[e]):this.Cr(t,e).next(function(t){if(t){var r=t.keys();return n.pr[e]=r,r}return null})},t.prototype.Fr=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return da(t)._i({index:xa.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(qr(e.batchId>=r),o=sa(n.serializer,e)),i.done()}).next(function(){return o})},t.prototype.Or=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return da(t)._i({index:xa.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.Mr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return da(t).ui(xa.userMutationsIndex,n).next(function(t){return t.map(function(t){return sa(e.serializer,t)})})},t.prototype.us=function(t,e){var n=this,r=ka.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return va(t)._i({range:i},function(r,i,u){var s=r[0],a=r[2],c=Zs(r[1]);if(s===n.userId&&e.path.isEqual(c))return da(t).get(a).next(function(t){if(!t)throw Mr();qr(t.userId===n.userId),o.push(sa(n.serializer,t))});u.done()}).next(function(){return o})},t.prototype.ds=function(t,e){var n=this,r=new Ti(Jr),i=[];return e.forEach(function(e){var o=ka.prefixForPath(n.userId,e.path),u=IDBKeyRange.lowerBound(o),s=va(t)._i({range:u},function(t,i,o){var u=t[0],s=t[2],a=Zs(t[1]);u===n.userId&&e.path.isEqual(a)?r=r.add(s):o.done()});i.push(s)}),ms.qn(i).next(function(){return n.kr(t,r)})},t.prototype.Rs=function(t,e){var n=this,r=e.path,i=r.length+1,o=ka.prefixForPath(this.userId,r),u=IDBKeyRange.lowerBound(o),s=new Ti(Jr);return va(t)._i({range:u},function(t,e,o){var u=t[0],a=t[2],c=Zs(t[1]);u===n.userId&&r.j(c)?c.length===i&&(s=s.add(a)):o.done()}).next(function(){return n.kr(t,s)})},t.prototype.kr=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(da(t).get(e).next(function(t){if(null===t)throw Mr();qr(t.userId===n.userId),r.push(sa(n.serializer,t))}))}),ms.qn(i).next(function(){return r})},t.prototype.$r=function(t,e){var n=this;return pa(t.Lr,this.userId,e).next(function(r){return t.es(function(){n.Br(e.batchId)}),ms.forEach(r,function(e){return n.Vr.qr(t,e)})})},t.prototype.Br=function(t){delete this.pr[t]},t.prototype.Ur=function(t){var e=this;return this.br(t).next(function(n){if(!n)return ms.resolve();var r=IDBKeyRange.lowerBound(ka.prefixForUser(e.userId)),i=[];return va(t)._i({range:r},function(t,n,r){if(t[0]===e.userId){var o=Zs(t[1]);i.push(o)}else r.done()}).next(function(){qr(0===i.length)})})},t.prototype.Qr=function(t,e){return la(t,this.userId,e)},t.prototype.Kr=function(t){var e=this;return ya(t).get(this.userId).next(function(t){return t||new Na(e.userId,-1,"")})},t}();function la(t,e,n){var r=ka.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),u=!1;return va(t)._i({range:o,li:!0},function(t,n,r){t[0]===e&&t[1]===i&&(u=!0),r.done()}).next(function(){return u})}function pa(t,e,n){var r=t.store(xa.store),i=t.store(ka.store),o=[],u=IDBKeyRange.only(n.batchId),s=0,a=r._i({range:u},function(t,e,n){return s++,n.delete()});o.push(a.next(function(){qr(1===s)}));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=ka.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return ms.qn(o).next(function(){return c})}function da(t){return nc.Ys(t,xa.store)}function va(t){return nc.Ys(t,ka.store)}function ya(t){return nc.Ys(t,Na.store)}var ga=function(){function t(t,e){this.serializer=t,this.os=e}return t.prototype.jn=function(t,e,n){return wa(t).put(_a(e),n)},t.prototype.Hn=function(t,e){var n=wa(t),r=_a(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.Wr(t,r)})},t.prototype.Jn=function(t,e){var n=this;return wa(t).get(_a(e)).next(function(t){return n.jr(t)})},t.prototype.Gr=function(t,e){var n=this;return wa(t).get(_a(e)).next(function(t){var e=n.jr(t);return e?{zn:e,size:Ia(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=xi();return this.zr(t,e,function(t,e){var i=n.jr(e);r=r.Tt(t,i)}).next(function(){return r})},t.prototype.Hr=function(t,e){var n=this,r=xi(),i=new Ii(ui.$);return this.zr(t,e,function(t,e){var o=n.jr(e);o?(r=r.Tt(t,o),i=i.Tt(t,Ia(e))):(r=r.Tt(t,null),i=i.Tt(t,0))}).next(function(){return{Jr:r,Yr:i}})},t.prototype.zr=function(t,e,n){if(e.W())return ms.resolve();var r=IDBKeyRange.bound(e.first().path.H(),e.last().path.H()),i=e.yt(),o=i.Ct();return wa(t)._i({range:r},function(t,e,r){for(var u=ui.ct(t);o&&ui.$(o,u)<0;)n(o,null),o=i.Ct();o&&o.isEqual(u)&&(n(o,e),o=i.Nt()?i.Ct():null),o?r.oi(o.path.H()):r.done()}).next(function(){for(;o;)n(o,null),o=i.Nt()?i.Ct():null})},t.prototype.ws=function(t,e,n){var r=this,i=Si(),o=e.path.length+1,u={};if(n.isEqual(ei.min())){var s=e.path.H();u.range=IDBKeyRange.lowerBound(s)}else{var a=e.path.H(),c=ra(n);u.range=IDBKeyRange.lowerBound([a,c],!0),u.index=Ca.collectionReadTimeIndex}return wa(t)._i(u,function(t,n,u){if(t.length===o){var s=ea(r.serializer,n);e.path.j(s.key.path)?s instanceof Ru&&$u(e,s)&&(i=i.Tt(s.key,s)):u.done()}}).next(function(){return i})},t.prototype.Xr=function(t){return new ba(this,!!t&&t.Zr)},t.prototype.eo=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return ma(t).get(Pa.key).next(function(t){return qr(!!t),t})},t.prototype.Wr=function(t,e){return ma(t).put(Pa.key,e)},t.prototype.jr=function(t){if(t){var e=ea(this.serializer,t);return e instanceof Lu&&e.version.isEqual(ei.min())?null:e}return null},t}(),ba=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).no=e,r.Zr=n,r.so=new bs(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return Object(O.d)(e,t),e.prototype.Zn=function(t){var e=this,n=[],r=0,i=new Ti(function(t,e){return Jr(t.J(),e.J())});return this.Qn.forEach(function(o,u){var s=e.so.get(o);if(u.zn){var a=na(e.no.serializer,u.zn,e.Wn(o));i=i.add(o.path.q());var c=Ia(a);r+=c-s,n.push(e.no.jn(t,o,a))}else if(r-=s,e.Zr){var h=na(e.no.serializer,new Lu(o,ei.min()),e.Wn(o));n.push(e.no.jn(t,o,h))}else n.push(e.no.Hn(t,o))}),i.forEach(function(r){n.push(e.no.os.Dr(t,r))}),n.push(this.no.updateMetadata(t,r)),ms.qn(n)},e.prototype.Yn=function(t,e){var n=this;return this.no.Gr(t,e).next(function(t){return null===t?(n.so.set(e,0),null):(n.so.set(e,t.size),t.zn)})},e.prototype.Xn=function(t,e){var n=this;return this.no.Hr(t,e).next(function(t){var e=t.Jr;return t.Yr.forEach(function(t,e){n.so.set(t,e)}),e})},e}(ws);function ma(t){return nc.Ys(t,Pa.store)}function wa(t){return nc.Ys(t,Ca.store)}function _a(t){return t.path.H()}function Ia(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Mr();e=t.noDocument}return JSON.stringify(e).length}var Oa=function(){function t(){this.io=new Ea}return t.prototype.Dr=function(t,e){return this.io.add(e),ms.resolve()},t.prototype.As=function(t,e){return ms.resolve(this.io.getEntries(e))},t}(),Ea=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.K(),n=t.q(),r=this.index[e]||new Ti(ri.$),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.K(),n=t.q(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Ti(ri.$)).H()},t}(),Ta=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;qr(n<r&&n>=0&&r<=11);var o=new Ps("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Aa.store)}(t),function(t){t.createObjectStore(Na.store,{keyPath:Na.keyPath}),t.createObjectStore(xa.store,{keyPath:xa.keyPath,autoIncrement:!0}).createIndex(xa.userMutationsIndex,xa.userMutationsKeyPath,{unique:!0}),t.createObjectStore(ka.store)}(t),Ma(t),function(t){t.createObjectStore(Ca.store)}(t));var u=ms.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(La.store),t.deleteObjectStore(Ra.store),t.deleteObjectStore(Va.store)}(t),Ma(t)),u=u.next(function(){return function(t){var e=t.store(Va.store),n=new Va(0,0,ei.min().M(),0);return e.put(Va.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(u=u.next(function(){return function(t,e){return e.store(xa.store).ui().next(function(n){t.deleteObjectStore(xa.store),t.createObjectStore(xa.store,{keyPath:xa.keyPath,autoIncrement:!0}).createIndex(xa.userMutationsIndex,xa.userMutationsKeyPath,{unique:!0});var r=e.store(xa.store),i=n.map(function(t){return r.put(t)});return ms.qn(i)})}(t,o)})),u=u.next(function(){!function(t){t.createObjectStore(qa.store,{keyPath:qa.keyPath})}(t)})),n<5&&r>=5&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),n<6&&r>=6&&(u=u.next(function(){return function(t){t.createObjectStore(Pa.store)}(t),i.addDocumentGlobal(o)})),n<7&&r>=7&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),n<8&&r>=8&&(u=u.next(function(){return i.createCollectionParentIndex(t,o)})),n<9&&r>=9&&(u=u.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Ca.store);e.createIndex(Ca.readTimeIndex,Ca.readTimeIndexPath,{unique:!1}),e.createIndex(Ca.collectionReadTimeIndex,Ca.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),n<11&&r>=11&&(u=u.next(function(){!function(t){t.createObjectStore(Fa.store,{keyPath:Fa.keyPath})}(t),function(t){t.createObjectStore(za.store,{keyPath:za.keyPath})}(t)})),u},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(Ca.store)._i(function(t,n){e+=Ia(n)}).next(function(){var n=new Pa(e);return t.store(Pa.store).put(Pa.key,n)})},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(Na.store),r=t.store(xa.store);return n.ui().next(function(n){return ms.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.ui(xa.userMutationsIndex,i).next(function(r){return ms.forEach(r,function(r){qr(r.userId===n.userId);var i=sa(e.serializer,r);return pa(t,n.userId,i).next(function(){})})})})})},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(La.store),n=t.store(Ca.store);return t.store(Va.store).get(Va.key).next(function(t){var r=[];return n._i(function(n,i){var o=new ri(n),u=function(t){return[0,Ys(t)]}(o);r.push(e.get(u).next(function(n){return n?ms.resolve():function(n){return e.put(new La(0,Ys(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return ms.qn(r)})})},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Ua.store,{keyPath:Ua.keyPath});var n=e.store(Ua.store),r=new Ea,i=function(t){if(r.add(t)){var e=t.K(),i=t.q();return n.put({collectionId:e,parent:Ys(i)})}};return e.store(Ca.store)._i({li:!0},function(t,e){var n=new ri(t);return i(n.q())}).next(function(){return e.store(ka.store)._i({li:!0},function(t,e){var n=Zs(t[1]);return i(n.q())})})},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(Ra.store);return n._i(function(t,r){var i=aa(r),o=ca(e.serializer,i);return n.put(o)})},t}(),ja=function(t,e){this.seconds=t,this.nanoseconds=e},Aa=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Aa.store="owner",Aa.key="owner";var Na=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Na.store="mutationQueues",Na.keyPath="userId";var xa=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};xa.store="mutations",xa.keyPath="batchId",xa.userMutationsIndex="userMutationsIndex",xa.userMutationsKeyPath=["userId","batchId"];var ka=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Ys(e)]},t.key=function(t,e,n){return[t,Ys(e),n]},t}();ka.store="documentMutations",ka.PLACEHOLDER=new ka;var Sa=function(t,e){this.path=t,this.readTime=e},Da=function(t,e){this.path=t,this.version=e},Ca=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Ca.store="remoteDocuments",Ca.readTimeIndex="readTimeIndex",Ca.readTimeIndexPath="readTime",Ca.collectionReadTimeIndex="collectionReadTimeIndex",Ca.collectionReadTimeIndexPath=["parentPath","readTime"];var Pa=function(t){this.byteSize=t};Pa.store="remoteDocumentGlobal",Pa.key="remoteDocumentGlobalKey";var Ra=function(t,e,n,r,i,o,u){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=u};Ra.store="targets",Ra.keyPath="targetId",Ra.queryTargetsIndexName="queryTargetsIndex",Ra.queryTargetsKeyPath=["canonicalId","targetId"];var La=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};La.store="targetDocuments",La.keyPath=["targetId","path"],La.documentTargetsIndex="documentTargetsIndex",La.documentTargetsKeyPath=["path","targetId"];var Va=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Va.key="targetGlobalKey",Va.store="targetGlobal";var Ua=function(t,e){this.collectionId=t,this.parent=e};function Ma(t){t.createObjectStore(La.store,{keyPath:La.keyPath}).createIndex(La.documentTargetsIndex,La.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ra.store,{keyPath:Ra.keyPath}).createIndex(Ra.queryTargetsIndexName,Ra.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Va.store)}Ua.store="collectionParents",Ua.keyPath=["collectionId","parent"];var qa=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};qa.store="clientMetadata",qa.keyPath="clientId";var Fa=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Fa.store="bundles",Fa.keyPath="bundleId";var za=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};za.store="namedQueries",za.keyPath="name";var Ba=Object(O.i)(Object(O.i)(Object(O.i)(Object(O.i)([Na.store,xa.store,ka.store,Ca.store,Ra.store,Aa.store,Va.store,La.store],[qa.store]),[Pa.store]),[Ua.store]),[Fa.store,za.store]),Ga=function(){function t(t){this.serializer=t}return t.prototype.ro=function(t,e){return Ka(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:ua(e.createTime),version:e.version};var e})},t.prototype.oo=function(t,e){return Ka(t).put({bundleId:(n=e).id,createTime:oa(No(n.createTime)),version:n.version});var n},t.prototype.co=function(t,e){return Wa(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:ha(e.bundledQuery),readTime:ua(e.readTime)};var e})},t.prototype.uo=function(t,e){return Wa(t).put(function(t){return{name:t.name,readTime:oa(No(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Ka(t){return nc.Ys(t,Fa.store)}function Wa(t){return nc.Ys(t,za.store)}var Ha=function(){function t(){this.ao=new Ea}return t.prototype.Dr=function(t,e){var n=this;if(!this.ao.has(e)){var r=e.K(),i=e.q();t.es(function(){n.ao.add(e)});var o={collectionId:r,parent:Ys(i)};return Xa(t).put(o)}return ms.resolve()},t.prototype.As=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Zr(e),""],!1,!0);return Xa(t).ui(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Zs(o.parent))}return n})},t}();function Xa(t){return nc.Ys(t,Ua.store)}var Qa=function(){function t(t){this.ho=t}return t.prototype.next=function(){return this.ho+=2,this.ho},t.lo=function(){return new t(0)},t._o=function(){return new t(-1)},t}(),Ya=function(){function t(t,e){this.Vr=t,this.serializer=e}return t.prototype.fo=function(t){var e=this;return this.wo(t).next(function(n){var r=new Qa(n.highestTargetId);return n.highestTargetId=r.next(),e.Eo(t,n).next(function(){return n.highestTargetId})})},t.prototype.To=function(t){return this.wo(t).next(function(t){return ei.N(new ti(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.Io=function(t){return this.wo(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.mo=function(t,e,n){var r=this;return this.wo(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.M()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Eo(t,i)})},t.prototype.Ao=function(t,e){var n=this;return this.Ro(t,e).next(function(){return n.wo(t).next(function(r){return r.targetCount+=1,n.Po(e,r),n.Eo(t,r)})})},t.prototype.yo=function(t,e){return this.Ro(t,e)},t.prototype.Vo=function(t,e){var n=this;return this.po(t,e.targetId).next(function(){return Ja(t).delete(e.targetId)}).next(function(){return n.wo(t)}).next(function(e){return qr(e.targetCount>0),e.targetCount-=1,n.Eo(t,e)})},t.prototype.mr=function(t,e,n){var r=this,i=0,o=[];return Ja(t)._i(function(u,s){var a=aa(s);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Vo(t,a)))}).next(function(){return ms.qn(o)}).next(function(){return i})},t.prototype.Ue=function(t,e){return Ja(t)._i(function(t,n){var r=aa(n);e(r)})},t.prototype.wo=function(t){return $a(t).get(Va.key).next(function(t){return qr(null!==t),t})},t.prototype.Eo=function(t,e){return $a(t).put(Va.key,e)},t.prototype.Ro=function(t,e){return Ja(t).put(ca(this.serializer,e))},t.prototype.Po=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.vo=function(t){return this.wo(t).next(function(t){return t.targetCount})},t.prototype.bo=function(t,e){var n=li(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Ja(t)._i({range:r,index:Ra.queryTargetsIndexName},function(t,n,r){var o=aa(n);pi(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.So=function(t,e,n){var r=this,i=[],o=Za(t);return e.forEach(function(e){var u=Ys(e.path);i.push(o.put(new La(n,u))),i.push(r.Vr.Do(t,n,e))}),ms.qn(i)},t.prototype.Co=function(t,e,n){var r=this,i=Za(t);return ms.forEach(e,function(e){var o=Ys(e.path);return ms.qn([i.delete([n,o]),r.Vr.No(t,n,e)])})},t.prototype.po=function(t,e){var n=Za(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.xo=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Za(t),i=Pi();return r._i({range:n,li:!0},function(t,e,n){var r=Zs(t[1]),o=new ui(r);i=i.add(o)}).next(function(){return i})},t.prototype.Qr=function(t,e){var n=Ys(e.path),r=IDBKeyRange.bound([n],[Zr(n)],!1,!0),i=0;return Za(t)._i({index:La.documentTargetsIndex,li:!0,range:r},function(t,e,n){0!==t[0]&&(i++,n.done())}).next(function(){return i>0})},t.prototype.Ze=function(t,e){return Ja(t).get(e).next(function(t){return t?aa(t):null})},t}();function Ja(t){return nc.Ys(t,Ra.store)}function $a(t){return nc.Ys(t,Va.store)}function Za(t){return nc.Ys(t,La.store)}var tc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",ec=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Lr=e,r.Fo=n,r}return Object(O.d)(e,t),e}(Ts),nc=function(){function t(e,n,r,i,o,u,s,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Cs=o,this.window=u,this.document=s,this.Oo=c,this.Mo=h,this.ko=null,this.$o=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Lo=null,this.inForeground=!1,this.Bo=null,this.qo=null,this.Uo=Number.NEGATIVE_INFINITY,this.Qo=function(t){return Promise.resolve()},!t.Gs())throw new Br(zr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Vr=new oc(this,i),this.Ko=n+"main",this.serializer=new ta(a),this.Wo=new ks(this.Ko,11,new Ta(this.serializer)),this.jo=new Ya(this.Vr,this.serializer),this.os=new Ha,this.ss=function(t,e){return new ga(t,e)}(this.serializer,this.os),this.Go=new Ga(this.serializer),this.window&&this.window.localStorage?this.zo=this.window.localStorage:(this.zo=null,!1===h&&Lr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.Ys=function(t,e){if(t instanceof ec)return ks.Ys(t.Lr,e);throw Mr()},t.prototype.start=function(){var t=this;return this.Ho().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Br(zr.FAILED_PRECONDITION,tc);return t.Jo(),t.Yo(),t.Xo(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.jo.Io(e)})}).then(function(e){t.ko=new Ns(e,t.Oo)}).then(function(){t.$o=!0}).catch(function(e){return t.Wo&&t.Wo.close(),Promise.reject(e)})},t.prototype.Zo=function(t){var e=this;return this.Qo=function(n){return Object(O.b)(e,void 0,void 0,function(){return Object(O.e)(this,function(e){return this.lr?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.tc=function(t){var e=this;this.Wo.ti(function(n){return Object(O.b)(e,void 0,void 0,function(){return Object(O.e)(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.ec=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Cs.Ri(function(){return Object(O.b)(e,void 0,void 0,function(){return Object(O.e)(this,function(t){switch(t.label){case 0:return this.lr?[4,this.Ho()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.Ho=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return ic(e).put(new qa(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.nc(e).next(function(e){e||(t.isPrimary=!1,t.Cs.Mi(function(){return t.Qo(!1)}))})}).next(function(){return t.sc(e)}).next(function(n){return t.isPrimary&&!n?t.ic(e).next(function(){return!1}):!!n&&t.rc(e).next(function(){return!0})})}).catch(function(e){if(Cs(e))return Rr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Rr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.Cs.Mi(function(){return t.Qo(e)}),t.isPrimary=e})},t.prototype.nc=function(t){var e=this;return rc(t).get(Aa.key).next(function(t){return ms.resolve(e.oc(t))})},t.prototype.cc=function(t){return ic(t).delete(this.clientId)},t.prototype.uc=function(){return Object(O.b)(this,void 0,void 0,function(){var e,n,r,i=this;return Object(O.e)(this,function(o){switch(o.label){case 0:return!this.isPrimary||this.ac(this.Uo,18e5)?[3,2]:(this.Uo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(e){var n=t.Ys(e,qa.store);return n.ui().next(function(t){var e=i.hc(t,18e5),r=t.filter(function(t){return-1===e.indexOf(t)});return ms.forEach(r,function(t){return n.delete(t.clientId)}).next(function(){return r})})}).catch(function(){return[]})]);case 1:if(e=o.sent(),this.zo)for(n=0,r=e;n<r.length;n++)this.zo.removeItem(this.lc(r[n].clientId));o.label=2;case 2:return[2]}})})},t.prototype.Xo=function(){var t=this;this.qo=this.Cs.Us("client_metadata_refresh",4e3,function(){return t.Ho().then(function(){return t.uc()}).then(function(){return t.Xo()})})},t.prototype.oc=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.sc=function(t){var e=this;return this.Mo?ms.resolve(!0):rc(t).get(Aa.key).next(function(n){if(null!==n&&e.ac(n.leaseTimestampMs,5e3)&&!e._c(n.ownerId)){if(e.oc(n)&&e.networkEnabled)return!0;if(!e.oc(n)){if(!n.allowTabSynchronization)throw new Br(zr.FAILED_PRECONDITION,tc);return!1}}return!(!e.networkEnabled||!e.inForeground)||ic(t).ui().next(function(t){return void 0===e.hc(t,5e3).find(function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))})})}).next(function(t){return e.isPrimary!==t&&Rr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.fc=function(){return Object(O.b)(this,void 0,void 0,function(){var t=this;return Object(O.e)(this,function(e){switch(e.label){case 0:return this.$o=!1,this.dc(),this.qo&&(this.qo.cancel(),this.qo=null),this.wc(),this.Ec(),[4,this.Wo.runTransaction("shutdown","readwrite",[Aa.store,qa.store],function(e){var n=new ec(e,Ns.Ds);return t.ic(n).next(function(){return t.cc(n)})})];case 1:return e.sent(),this.Wo.close(),this.Tc(),[2]}})})},t.prototype.hc=function(t,e){var n=this;return t.filter(function(t){return n.ac(t.updateTimeMs,e)&&!n._c(t.clientId)})},t.prototype.Ic=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return ic(e).ui().next(function(e){return t.hc(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"lr",{get:function(){return this.$o},enumerable:!1,configurable:!0}),t.prototype.mc=function(t){return fa.vr(t,this.serializer,this.os,this.Vr)},t.prototype.Ac=function(){return this.jo},t.prototype.Rc=function(){return this.ss},t.prototype.Pc=function(){return this.os},t.prototype.gc=function(){return this.Go},t.prototype.runTransaction=function(t,e,n){var r,i=this;return Rr("IndexedDbPersistence","Starting transaction:",t),this.Wo.runTransaction(t,"readonly"===e?"readonly":"readwrite",Ba,function(o){return r=new ec(o,i.ko?i.ko.next():Ns.Ds),"readwrite-primary"===e?i.nc(r).next(function(t){return!!t||i.sc(r)}).next(function(e){if(!e)throw Lr("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.Cs.Mi(function(){return i.Qo(!1)}),new Br(zr.FAILED_PRECONDITION,Es);return n(r)}).next(function(t){return i.rc(r).next(function(){return t})}):i.yc(r).next(function(){return n(r)})}).then(function(t){return r.ns(),t})},t.prototype.yc=function(t){var e=this;return rc(t).get(Aa.key).next(function(t){if(null!==t&&e.ac(t.leaseTimestampMs,5e3)&&!e._c(t.ownerId)&&!e.oc(t)&&!(e.Mo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Br(zr.FAILED_PRECONDITION,tc)})},t.prototype.rc=function(t){var e=new Aa(this.clientId,this.allowTabSynchronization,Date.now());return rc(t).put(Aa.key,e)},t.Gs=function(){return ks.Gs()},t.prototype.ic=function(t){var e=this,n=rc(t);return n.get(Aa.key).next(function(t){return e.oc(t)?(Rr("IndexedDbPersistence","Releasing primary lease."),n.delete(Aa.key)):ms.resolve()})},t.prototype.ac=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Lr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Jo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Bo=function(){t.Cs.Ri(function(){return t.inForeground="visible"===t.document.visibilityState,t.Ho()})},this.document.addEventListener("visibilitychange",this.Bo),this.inForeground="visible"===this.document.visibilityState)},t.prototype.wc=function(){this.Bo&&(this.document.removeEventListener("visibilitychange",this.Bo),this.Bo=null)},t.prototype.Yo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Lo=function(){e.dc(),e.Cs.Ri(function(){return e.fc()})},this.window.addEventListener("unload",this.Lo))},t.prototype.Ec=function(){this.Lo&&(this.window.removeEventListener("unload",this.Lo),this.Lo=null)},t.prototype._c=function(t){var e;try{var n=null!==(null===(e=this.zo)||void 0===e?void 0:e.getItem(this.lc(t)));return Rr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Lr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.dc=function(){if(this.zo)try{this.zo.setItem(this.lc(this.clientId),String(Date.now()))}catch(t){Lr("Failed to set zombie client id.",t)}},t.prototype.Tc=function(){if(this.zo)try{this.zo.removeItem(this.lc(this.clientId))}catch(t){}},t.prototype.lc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function rc(t){return nc.Ys(t,Aa.store)}function ic(t){return nc.Ys(t,qa.store)}var oc=function(){function t(t,e){this.db=t,this.cr=new Qs(this,e)}return t.prototype.Er=function(t){var e=this.Vc(t);return this.db.Ac().vo(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.Vc=function(t){var e=0;return this.Ir(t,function(t){e++}).next(function(){return e})},t.prototype.Ue=function(t,e){return this.db.Ac().Ue(t,e)},t.prototype.Ir=function(t,e){return this.vc(t,function(t,n){return e(n)})},t.prototype.Do=function(t,e,n){return uc(t,n)},t.prototype.No=function(t,e,n){return uc(t,n)},t.prototype.mr=function(t,e,n){return this.db.Ac().mr(t,e,n)},t.prototype.qr=function(t,e){return uc(t,e)},t.prototype.bc=function(t,e){return function(t,e){var n=!1;return ya(t).fi(function(r){return la(t,r,e).next(function(t){return t&&(n=!0),ms.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.Ar=function(t,e){var n=this,r=this.db.Rc().Xr(),i=[],o=0;return this.vc(t,function(u,s){if(s<=e){var a=n.bc(t,u).next(function(e){if(!e)return o++,r.Jn(t,u).next(function(){return r.Hn(u),Za(t).delete([0,Ys(u.path)])})});i.push(a)}}).next(function(){return ms.qn(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.dt(t.Fo);return this.db.Ac().yo(t,n)},t.prototype.Sc=function(t,e){return uc(t,e)},t.prototype.vc=function(t,e){var n,r=Za(t),i=Ns.Ds;return r._i({index:La.documentTargetsIndex},function(t,r){var o=r.path,u=r.sequenceNumber;0===t[0]?(i!==Ns.Ds&&e(new ui(Zs(n)),i),i=u,n=o):i=Ns.Ds}).next(function(){i!==Ns.Ds&&e(new ui(Zs(n)),i)})},t.prototype.Pr=function(t){return this.db.Rc().eo(t)},t}();function uc(t,e){return Za(t).put(function(t,e){return new La(0,Ys(t.path),e)}(e,t.Fo))}function sc(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var ac=function(){function t(t,e,n,r){this.persistence=t,this.Dc=e,this.serializer=r,this.Cc=new Ii(Jr),this.Nc=new bs(function(t){return li(t)},pi),this.xc=ei.min(),this.rs=t.mc(n),this.Fc=t.Rc(),this.jo=t.Ac(),this.Oc=new js(this.Fc,this.rs,this.persistence.Pc()),this.Go=t.gc(),this.Dc.Mc(this.Oc)}return t.prototype._r=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.Rr(n,e.Cc)})},t}();function cc(t,e,n,r){return new ac(t,e,n,r)}function hc(t,e){return Object(O.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(O.e)(this,function(u){switch(u.label){case 0:return n=Fr(t),r=n.rs,i=n.Oc,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n.rs.Mr(t).next(function(u){return o=u,r=n.persistence.mc(e),i=new js(n.Fc,r,n.persistence.Pc()),r.Mr(t)}).next(function(e){for(var n=[],r=[],u=Pi(),s=0,a=o;s<a.length;s++){var c=a[s];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++)u=u.add(f[h].key)}for(var l=0,p=e;l<p.length;l++){var d=p[l];r.push(d.batchId);for(var v=0,y=d.mutations;v<y.length;v++)u=u.add(y[v].key)}return i._s(t,u).next(function(t){return{kc:t,$c:n,Lc:r}})})})];case 1:return o=u.sent(),[2,(n.rs=r,n.Oc=i,n.Dc.Mc(n.Oc),o)]}})})}function fc(t,e){var n=Fr(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.Fc.Xr({Zr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),u=ms.resolve();return o.forEach(function(t){u=u.next(function(){return r.Jn(e,t)}).next(function(e){var o=e,u=n.Sn.get(t);qr(null!==u),(!o||o.version.F(u)<0)&&(o=i.yn(t,o,n))&&r.jn(o,n.bn)})}),u.next(function(){return t.rs.$r(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n.rs.Ur(t)}).next(function(){return n.Oc._s(t,r)})})}function lc(t){var e=Fr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.jo.To(t)})}function pc(t,e){var n=Fr(t),r=e.ft,i=n.Cc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.Fc.Xr({Zr:!0});i=n.Cc;var u=[];e.re.forEach(function(e,o){var s=i.get(o);if(s){u.push(n.jo.Co(t,e.de,o).next(function(){return n.jo.So(t,e._e,o)}));var a=e.resumeToken;if(a.ht()>0){var c=s.wt(a,r).dt(t.Fo);i=i.Tt(o,c),function(t,e,n){return qr(e.resumeToken.ht()>0),0===t.resumeToken.ht()||e.ft.O()-t.ft.O()>=3e8||n._e.size+n.fe.size+n.de.size>0}(s,c,e)&&u.push(n.jo.yo(t,c))}}});var s=Ni();if(e.ce.forEach(function(r,i){e.ue.has(r)&&u.push(n.persistence.Vr.Sc(t,r))}),u.push(function(t,e,n,r,i){var o=Pi();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var i=Ni();return n.forEach(function(n,o){var u=t.get(n),s=r;o instanceof Lu&&o.version.isEqual(ei.min())?(e.Hn(n,s),i=i.Tt(n,o)):null==u||o.version.F(u.version)>0||0===o.version.F(u.version)&&u.hasPendingWrites?(e.jn(o,s),i=i.Tt(n,o)):Rr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",u.version," Watch version:",o.version)}),i})}(t,o,e.ce,r).next(function(t){s=t})),!r.isEqual(ei.min())){var a=n.jo.To(t).next(function(e){return n.jo.mo(t,t.Fo,r)});u.push(a)}return ms.qn(u).next(function(){return o.apply(t)}).next(function(){return n.Oc.fs(t,s)})}).then(function(t){return n.Cc=i,t})}function dc(t,e){var n=Fr(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.rs.Fr(t,e)})}function vc(t,e){var n=Fr(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.jo.bo(t,e).next(function(i){return i?ms.resolve(r=i):n.jo.fo(t).next(function(i){return r=new bi(e,i,0,t.Fo),n.jo.Ao(t,r).next(function(){return r})})})}).then(function(t){var r=n.Cc.get(t.targetId);return(null===r||t.ft.F(r.ft)>0)&&(n.Cc=n.Cc.Tt(t.targetId,t),n.Nc.set(e,t.targetId)),t})}function yc(t,e,n){return Object(O.b)(this,void 0,void 0,function(){var r,i,o,u;return Object(O.e)(this,function(s){switch(s.label){case 0:r=Fr(t),i=r.Cc.get(e),o=n?"readwrite":"readwrite-primary",s.label=1;case 1:return s.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.Vr.removeTarget(t,i)})];case 2:s.sent(),s.label=3;case 3:return[3,5];case 4:if(!Cs(u=s.sent()))throw u;return Rr("LocalStore","Failed to update sequence numbers for target "+e+": "+u),[3,5];case 5:return r.Cc=r.Cc.remove(e),r.Nc.delete(i.target),[2]}})})}function gc(t,e,n){var r=Fr(t),i=ei.min(),o=Pi();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=Fr(t),i=r.Nc.get(n);return void 0!==i?ms.resolve(r.Cc.get(i)):r.jo.bo(e,n)}(r,t,Hu(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.jo.xo(t,e.targetId).next(function(t){o=t})}).next(function(){return r.Dc.ws(t,e,n?i:ei.min(),n?o:Pi())}).next(function(t){return{documents:t,Bc:o}})})}function bc(t,e){var n=Fr(t),r=Fr(n.jo),i=n.Cc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Ze(t,e).next(function(t){return t?t.target:null})})}function mc(t){var e=Fr(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=Fr(t),i=Ni(),o=ra(n),u=wa(e),s=IDBKeyRange.lowerBound(o,!0);return u._i({index:Ca.readTimeIndex,range:s},function(t,e){var n=ea(r.serializer,e);i=i.Tt(n.key,n),o=e.readTime}).next(function(){return{qc:i,readTime:ia(o)}})}(e.Fc,t,e.xc)}).then(function(t){var n=t.qc;return e.xc=t.readTime,n})}function wc(t){return Object(O.b)(this,void 0,void 0,function(){var e;return Object(O.e)(this,function(n){return[2,(e=Fr(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=wa(t),n=ei.min();return e._i({index:Ca.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=ia(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){e.xc=t})]})})}function _c(t){return Object(O.b)(this,void 0,void 0,function(){return Object(O.e)(this,function(e){if(t.code!==zr.FAILED_PRECONDITION||t.message!==Es)throw t;return Rr("LocalStore","Unexpectedly lost primary lease"),[2]})})}var Ic=function(){function t(t,e,n,r,i,o){this.Cs=t,this.Uc=n,this.Qc=r,this.Kc=i,this.listener=o,this.state=0,this.Wc=0,this.jc=null,this.stream=null,this.Si=new xs(t,e)}return t.prototype.Gc=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.zc=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Hc()},t.prototype.stop=function(){return Object(O.b)(this,void 0,void 0,function(){return Object(O.e)(this,function(t){switch(t.label){case 0:return this.Gc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.Jc=function(){this.state=0,this.Si.reset()},t.prototype.Yc=function(){var t=this;this.zc()&&null===this.jc&&(this.jc=this.Cs.Us(this.Uc,6e4,function(){return t.Xc()}))},t.prototype.Zc=function(t){this.tu(),this.stream.send(t)},t.prototype.Xc=function(){return Object(O.b)(this,void 0,void 0,function(){return Object(O.e)(this,function(t){return this.zc()?[2,this.close(0)]:[2]})})},t.prototype.tu=function(){this.jc&&(this.jc.cancel(),this.jc=null)},t.prototype.close=function(t,e){return Object(O.b)(this,void 0,void 0,function(){return Object(O.e)(this,function(n){switch(n.label){case 0:return this.tu(),this.Si.cancel(),this.Wc++,3!==t?this.Si.reset():e&&e.code===zr.RESOURCE_EXHAUSTED?(Lr(e.toString()),Lr("Using maximum backoff delay to prevent overloading the backend."),this.Si.Ls()):e&&e.code===zr.UNAUTHENTICATED&&this.Kc.m(),null!==this.stream&&(this.eu(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.nu(e)];case 1:return n.sent(),[2]}})})},t.prototype.eu=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.su(this.Wc),n=this.Wc;this.Kc.getToken().then(function(e){t.Wc===n&&t.iu(e)},function(n){e(function(){var e=new Br(zr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.ru(e)})})},t.prototype.iu=function(t){var e=this,n=this.su(this.Wc);this.stream=this.ou(t),this.stream.cu(function(){n(function(){return e.state=2,e.listener.cu()})}),this.stream.nu(function(t){n(function(){return e.ru(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.Hc=function(){var t=this;this.state=4,this.Si.Bs(function(){return Object(O.b)(t,void 0,void 0,function(){return Object(O.e)(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.ru=function(t){return Rr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.su=function(t){var e=this;return function(n){e.Cs.Ri(function(){return e.Wc===t?n():(Rr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),Oc=function(t){function e(e,n,r,i,o){var u=this;return(u=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,u}return Object(O.d)(e,t),e.prototype.ou=function(t){return this.Qc.uu("Listen",t)},e.prototype.onMessage=function(t){this.Si.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Mr()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.tn?(qr(void 0===e||"string"==typeof e),vi.fromBase64String(e||"")):(qr(void 0===e||e instanceof Uint8Array),vi.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),u=e.targetChange.cause,s=u&&function(t){var e=void 0===t.code?zr.UNKNOWN:_i(t.code);return new Br(e,t.message||"")}(u);n=new Gi(r,i,o,s||null)}else if("documentChange"in e){var a=e.documentChange,c=Do(t,a.document.name),h=No(a.document.updateTime),f=new Su({mapValue:{fields:a.document.fields}}),l=new Ru(c,h,f,{});n=new zi(a.targetIds||[],a.removedTargetIds||[],l.key,l)}else if("documentDelete"in e){var p=e.documentDelete,d=Do(t,p.document),v=p.readTime?No(p.readTime):ei.min(),y=new Lu(d,v);n=new zi([],p.removedTargetIds||[],y.key,y)}else if("documentRemove"in e){var g=e.documentRemove,b=Do(t,g.document);n=new zi([],g.removedTargetIds||[],b,null)}else{if(!("filter"in e))return Mr();var m=e.filter,w=new mi(m.count||0);n=new Bi(m.targetId,w)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return ei.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?ei.min():e.readTime?No(e.readTime):ei.min()}(t);return this.listener.au(e,n)},e.prototype.hu=function(t){var e={};e.database=Ro(this.serializer),e.addTarget=function(t,e){var n,r=e.target;return(n=di(r)?{documents:qo(t,r)}:{query:Fo(t,r)}).targetId=e.targetId,e.resumeToken.ht()>0?n.resumeToken=jo(t,e.resumeToken):e.ft.F(ei.min())>0&&(n.readTime=To(t,e.ft.M())),n}(this.serializer,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Mr()}}(0,e._t);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.Zc(e)},e.prototype.lu=function(t){var e={};e.database=Ro(this.serializer),e.removeTarget=t,this.Zc(e)},e}(Ic),Ec=function(t){function e(e,n,r,i,o){var u=this;return(u=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,u._u=!1,u}return Object(O.d)(e,t),Object.defineProperty(e.prototype,"fu",{get:function(){return this._u},enumerable:!1,configurable:!0}),e.prototype.start=function(){this._u=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.eu=function(){this._u&&this.du([])},e.prototype.ou=function(t){return this.Qc.uu("Write",t)},e.prototype.onMessage=function(t){if(qr(!!t.streamToken),this.lastStreamToken=t.streamToken,this._u){this.Si.reset();var e=function(t,e){return t&&t.length>0?(qr(void 0!==e),t.map(function(t){return function(t,e){var n=No(t.updateTime?t.updateTime:e);n.isEqual(ei.min())&&(n=No(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new du(n,r)}(t,e)})):[]}(t.writeResults,t.commitTime),n=No(t.commitTime);return this.listener.wu(n,e)}return qr(!t.writeResults||0===t.writeResults.length),this._u=!0,this.listener.Eu()},e.prototype.Tu=function(){var t={};t.database=Ro(this.serializer),this.Zc(t)},e.prototype.du=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Uo(e.serializer,t)})};this.Zc(n)},e}(Ic),Tc=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Qc=n,i.serializer=r,i.Iu=!1,i}return Object(O.d)(e,t),e.prototype.mu=function(){if(this.Iu)throw new Br(zr.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Au=function(t,e,n){var r=this;return this.mu(),this.credentials.getToken().then(function(i){return r.Qc.Au(t,e,n,i)}).catch(function(t){throw t.code===zr.UNAUTHENTICATED&&r.credentials.m(),t})},e.prototype.Ru=function(t,e,n){var r=this;return this.mu(),this.credentials.getToken().then(function(i){return r.Qc.Ru(t,e,n,i)}).catch(function(t){throw t.code===zr.UNAUTHENTICATED&&r.credentials.m(),t})},e.prototype.terminate=function(){this.Iu=!1},e}(function(){}),jc=function(){function t(t,e){this.di=t,this.Pu=e,this.state="Unknown",this.gu=0,this.yu=null,this.Vu=!0}return t.prototype.pu=function(){var t=this;0===this.gu&&(this.vu("Unknown"),this.yu=this.di.Us("online_state_timeout",1e4,function(){return t.yu=null,t.bu("Backend didn't respond within 10 seconds."),t.vu("Offline"),Promise.resolve()}))},t.prototype.Su=function(t){"Online"===this.state?this.vu("Unknown"):(this.gu++,this.gu>=1&&(this.Du(),this.bu("Connection failed 1 times. Most recent error: "+t.toString()),this.vu("Offline")))},t.prototype.set=function(t){this.Du(),this.gu=0,"Online"===t&&(this.Vu=!1),this.vu(t)},t.prototype.vu=function(t){t!==this.state&&(this.state=t,this.Pu(t))},t.prototype.bu=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vu?(Lr(e),this.Vu=!1):Rr("OnlineStateTracker",e)},t.prototype.Du=function(){null!==this.yu&&(this.yu.cancel(),this.yu=null)},t}(),Ac=function(t,e,n,r,i){var o=this;this.Cu=t,this.Nu=e,this.di=n,this.xu={},this.Fu=[],this.Ou=new Map,this.Mu=new Set,this.ku=[],this.$u=i,this.$u.Lu(function(t){n.Ri(function(){return Object(O.b)(o,void 0,void 0,function(){return Object(O.e)(this,function(t){switch(t.label){case 0:return Lc(this)?(Rr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(O.b)(this,void 0,void 0,function(){var e;return Object(O.e)(this,function(n){switch(n.label){case 0:return(e=Fr(t)).Mu.add(4),[4,xc(e)];case 1:return n.sent(),e.Bu.set("Unknown"),e.Mu.delete(4),[4,Nc(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Bu=new jc(n,r)};function Nc(t){return Object(O.b)(this,void 0,void 0,function(){var e,n;return Object(O.e)(this,function(r){switch(r.label){case 0:if(!Lc(t))return[3,4];e=0,n=t.ku,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function xc(t){return Object(O.b)(this,void 0,void 0,function(){var e,n;return Object(O.e)(this,function(r){switch(r.label){case 0:e=0,n=t.ku,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function kc(t,e){var n=Fr(t);n.Ou.has(e.targetId)||(n.Ou.set(e.targetId,e),Rc(n)?Pc(n):Jc(n).zc()&&Dc(n,e))}function Sc(t,e){var n=Fr(t),r=Jc(n);n.Ou.delete(e),r.zc()&&Cc(n,e),0===n.Ou.size&&(r.zc()?r.Yc():Lc(n)&&n.Bu.set("Unknown"))}function Dc(t,e){t.qu.De(e.targetId),Jc(t).hu(e)}function Cc(t,e){t.qu.De(e),Jc(t).lu(e)}function Pc(t){t.qu=new Wi({Xe:function(e){return t.xu.Xe(e)},Ze:function(e){return t.Ou.get(e)||null}}),Jc(t).start(),t.Bu.pu()}function Rc(t){return Lc(t)&&!Jc(t).Gc()&&t.Ou.size>0}function Lc(t){return 0===Fr(t).Mu.size}function Vc(t){t.qu=void 0}function Uc(t){return Object(O.b)(this,void 0,void 0,function(){return Object(O.e)(this,function(e){return t.Ou.forEach(function(e,n){Dc(t,e)}),[2]})})}function Mc(t,e){return Object(O.b)(this,void 0,void 0,function(){return Object(O.e)(this,function(n){return Vc(t),Rc(t)?(t.Bu.Su(e),Pc(t)):t.Bu.set("Unknown"),[2]})})}function qc(t,e,n){return Object(O.b)(this,void 0,void 0,function(){var r,i,o;return Object(O.e)(this,function(u){switch(u.label){case 0:if(t.Bu.set("Online"),!(e instanceof Gi&&2===e.state&&e.cause))return[3,6];u.label=1;case 1:return u.trys.push([1,3,,5]),[4,function(t,e){return Object(O.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(O.e)(this,function(u){switch(u.label){case 0:n=e.cause,r=0,i=e.targetIds,u.label=1;case 1:return r<i.length?t.Ou.has(o=i[r])?[4,t.xu.Uu(o,n)]:[3,3]:[3,5];case 2:u.sent(),t.Ou.delete(o),t.qu.removeTarget(o),u.label=3;case 3:u.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return u.sent(),[3,5];case 3:return r=u.sent(),Rr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,Fc(t,r)];case 4:return u.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof zi?t.qu.$e(e):e instanceof Bi?t.qu.je(e):t.qu.qe(e),n.isEqual(ei.min()))return[3,13];u.label=7;case 7:return u.trys.push([7,11,,13]),[4,lc(t.Cu)];case 8:return i=u.sent(),n.F(i)>=0?[4,function(t,e){var n=t.qu.He(e);return n.re.forEach(function(n,r){if(n.resumeToken.ht()>0){var i=t.Ou.get(r);i&&t.Ou.set(r,i.wt(n.resumeToken,e))}}),n.oe.forEach(function(e){var n=t.Ou.get(e);if(n){t.Ou.set(e,n.wt(vi.lt,n.ft)),Cc(t,e);var r=new bi(n.target,e,1,n.sequenceNumber);Dc(t,r)}}),t.xu.Qu(n)}(t,n)]:[3,10];case 9:u.sent(),u.label=10;case 10:return[3,13];case 11:return Rr("RemoteStore","Failed to raise snapshot:",o=u.sent()),[4,Fc(t,o)];case 12:return u.sent(),[3,13];case 13:return[2]}})})}function Fc(t,e,n){return Object(O.b)(this,void 0,void 0,function(){var r=this;return Object(O.e)(this,function(i){switch(i.label){case 0:if(!Cs(e))throw e;return t.Mu.add(1),[4,xc(t)];case 1:return i.sent(),t.Bu.set("Offline"),n||(n=function(){return lc(t.Cu)}),t.di.Mi(function(){return Object(O.b)(r,void 0,void 0,function(){return Object(O.e)(this,function(e){switch(e.label){case 0:return Rr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Mu.delete(1),[4,Nc(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function zc(t,e){return e().catch(function(n){return Fc(t,n,e)})}function Bc(t){return Object(O.b)(this,void 0,void 0,function(){var e,n,r,i,o;return Object(O.e)(this,function(u){switch(u.label){case 0:e=Fr(t),n=$c(e),r=e.Fu.length>0?e.Fu[e.Fu.length-1].batchId:-1,u.label=1;case 1:if(!function(t){return Lc(t)&&t.Fu.length<10}(e))return[3,7];u.label=2;case 2:return u.trys.push([2,4,,6]),[4,dc(e.Cu,r)];case 3:return null===(i=u.sent())?(0===e.Fu.length&&n.Yc(),[3,7]):(r=i.batchId,function(t,e){t.Fu.push(e);var n=$c(t);n.zc()&&n.fu&&n.du(e.mutations)}(e,i),[3,6]);case 4:return o=u.sent(),[4,Fc(e,o)];case 5:return u.sent(),[3,6];case 6:return[3,1];case 7:return Gc(e)&&Kc(e),[2]}})})}function Gc(t){return Lc(t)&&!$c(t).Gc()&&t.Fu.length>0}function Kc(t){$c(t).start()}function Wc(t){return Object(O.b)(this,void 0,void 0,function(){return Object(O.e)(this,function(e){return $c(t).Tu(),[2]})})}function Hc(t){return Object(O.b)(this,void 0,void 0,function(){var e,n,r;return Object(O.e)(this,function(i){for(e=$c(t),n=0,r=t.Fu;n<r.length;n++)e.du(r[n].mutations);return[2]})})}function Xc(t,e,n){return Object(O.b)(this,void 0,void 0,function(){var r,i;return Object(O.e)(this,function(o){switch(o.label){case 0:return r=t.Fu.shift(),i=gs.from(r,e,n),[4,zc(t,function(){return t.xu.Ku(i)})];case 1:return o.sent(),[4,Bc(t)];case 2:return o.sent(),[2]}})})}function Qc(t,e){return Object(O.b)(this,void 0,void 0,function(){return Object(O.e)(this,function(n){switch(n.label){case 0:return e&&$c(t).fu?[4,function(t,e){return Object(O.b)(this,void 0,void 0,function(){var n,r;return Object(O.e)(this,function(i){switch(i.label){case 0:return wi(r=e.code)&&r!==zr.ABORTED?(n=t.Fu.shift(),$c(t).Jc(),[4,zc(t,function(){return t.xu.Wu(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,Bc(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Gc(t)&&Kc(t),[2]}})})}function Yc(t,e){return Object(O.b)(this,void 0,void 0,function(){var n;return Object(O.e)(this,function(r){switch(r.label){case 0:return n=Fr(t),e?(n.Mu.delete(2),[4,Nc(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Mu.add(2),[4,xc(n)]);case 3:r.sent(),n.Bu.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function Jc(t){var e=this;return t.ju||(t.ju=function(t,e,n){var r=Fr(t);return r.mu(),new Oc(e,r.Qc,r.credentials,r.serializer,n)}(t.Nu,t.di,{cu:Uc.bind(null,t),nu:Mc.bind(null,t),au:qc.bind(null,t)}),t.ku.push(function(n){return Object(O.b)(e,void 0,void 0,function(){return Object(O.e)(this,function(e){switch(e.label){case 0:return n?(t.ju.Jc(),Rc(t)?Pc(t):t.Bu.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.ju.stop()];case 2:e.sent(),Vc(t),e.label=3;case 3:return[2]}})})})),t.ju}function $c(t){var e=this;return t.Gu||(t.Gu=function(t,e,n){var r=Fr(t);return r.mu(),new Ec(e,r.Qc,r.credentials,r.serializer,n)}(t.Nu,t.di,{cu:Wc.bind(null,t),nu:Qc.bind(null,t),Eu:Hc.bind(null,t),wu:Xc.bind(null,t)}),t.ku.push(function(n){return Object(O.b)(e,void 0,void 0,function(){return Object(O.e)(this,function(e){switch(e.label){case 0:return n?(t.Gu.Jc(),[4,Bc(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Gu.stop()];case 3:e.sent(),t.Fu.length>0&&(Rr("RemoteStore","Stopping write stream with "+t.Fu.length+" pending writes"),t.Fu=[]),e.label=4;case 4:return[2]}})})})),t.Gu}var Zc=function(){this.zu=void 0,this.listeners=[]},th=function(){this.queries=new bs(function(t){return Yu(t)},Qu),this.onlineState="Unknown",this.Hu=new Set};function eh(t,e){return Object(O.b)(this,void 0,void 0,function(){var n,r,i,o,u,s,a;return Object(O.e)(this,function(c){switch(c.label){case 0:if(n=Fr(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new Zc),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),u=o,[4,n.Ju(r)];case 2:return u.zu=c.sent(),[3,4];case 3:return s=c.sent(),a=Bs(s,"Initialization of query '"+Ju(e.query)+"' failed"),[2,void e.onError(a)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.Yu(n.onlineState),o.zu&&e.Xu(o.zu)&&oh(n),[2]}})})}function nh(t,e){return Object(O.b)(this,void 0,void 0,function(){var n,r,i,o,u;return Object(O.e)(this,function(s){return n=Fr(t),i=!1,(o=n.queries.get(r=e.query))&&(u=o.listeners.indexOf(e))>=0&&(o.listeners.splice(u,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.Zu(r))]:[2]})})}function rh(t,e){for(var n=Fr(t),r=!1,i=0,o=e;i<o.length;i++){var u=o[i],s=n.queries.get(u.query);if(s){for(var a=0,c=s.listeners;a<c.length;a++)c[a].Xu(u)&&(r=!0);s.zu=u}}r&&oh(n)}function ih(t,e,n){var r=Fr(t),i=r.queries.get(e);if(i)for(var o=0,u=i.listeners;o<u.length;o++)u[o].onError(n);r.queries.delete(e)}function oh(t){t.Hu.forEach(function(t){t.next()})}var uh=function(){function t(t,e,n){this.query=t,this.ta=e,this.ea=!1,this.na=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Xu=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Mi(t.query,t.docs,t.te,e,t.ee,t.fromCache,t.ne,!0)}var o=!1;return this.ea?this.sa(t)&&(this.ta.next(t),o=!0):this.ia(t,this.onlineState)&&(this.ra(t),o=!0),this.na=t,o},t.prototype.onError=function(t){this.ta.error(t)},t.prototype.Yu=function(t){this.onlineState=t;var e=!1;return this.na&&!this.ea&&this.ia(this.na,t)&&(this.ra(this.na),e=!0),e},t.prototype.ia=function(t,e){return!t.fromCache||!(this.options.oa&&"Offline"!==e||t.docs.W()&&"Offline"!==e)},t.prototype.sa=function(t){return t.docChanges.length>0||!!(t.ne||this.na&&this.na.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.ra=function(t){t=Mi.ie(t.query,t.docs,t.ee,t.fromCache),this.ea=!0,this.ta.next(t)},t}(),sh=function(){function t(){this.ca=new Ti(ah.ua),this.aa=new Ti(ah.ha)}return t.prototype.W=function(){return this.ca.W()},t.prototype.Do=function(t,e){var n=new ah(t,e);this.ca=this.ca.add(n),this.aa=this.aa.add(n)},t.prototype.la=function(t,e){var n=this;t.forEach(function(t){return n.Do(t,e)})},t.prototype.No=function(t,e){this._a(new ah(t,e))},t.prototype.fa=function(t,e){var n=this;t.forEach(function(t){return n.No(t,e)})},t.prototype.da=function(t){var e=this,n=new ui(new ri([])),r=new ah(n,t),i=new ah(n,t+1),o=[];return this.aa.Kt([r,i],function(t){e._a(t),o.push(t.key)}),o},t.prototype.wa=function(){var t=this;this.ca.forEach(function(e){return t._a(e)})},t.prototype._a=function(t){this.ca=this.ca.delete(t),this.aa=this.aa.delete(t)},t.prototype.Ea=function(t){var e=new ui(new ri([])),n=new ah(e,t),r=new ah(e,t+1),i=Pi();return this.aa.Kt([n,r],function(t){i=i.add(t.key)}),i},t.prototype.Qr=function(t){var e=new ah(t,0),n=this.ca.jt(e);return null!==n&&t.isEqual(n.key)},t}(),ah=function(){function t(t,e){this.key=t,this.Ta=e}return t.ua=function(t,e){return ui.$(t.key,e.key)||Jr(t.Ta,e.Ta)},t.ha=function(t,e){return Jr(t.Ta,e.Ta)||ui.$(t.key,e.key)},t}();function ch(t,e){return"firestore_clients_"+t+"_"+e}function hh(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.u()&&(r+="_"+e.uid),r}function fh(t,e){return"firestore_targets_"+t+"_"+e}var lh=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Ia=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),u=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(u=new Br(i.error.code,i.error.message)),o?new t(e,n,i.state,u):(Lr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ma=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),ph=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Ia=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Br(r.error.code,r.error.message)),i?new t(e,r.state,o):(Lr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ma=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),dh=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Ia=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Li(),u=0;i&&u<r.activeTargetIds.length;++u)i=ci(r.activeTargetIds[u]),o=o.add(r.activeTargetIds[u]);return i?new t(e,o):(Lr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),vh=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Ia=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Lr("SharedClientState","Failed to parse online state: "+e),null)},t}(),yh=function(){function t(){this.activeTargetIds=Li()}return t.prototype.Aa=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Ra=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ma=function(){var t={activeTargetIds:this.activeTargetIds.H(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),gh=function(){function t(t,e,n,r,i){this.window=t,this.Cs=e,this.persistenceKey=n,this.Pa=r,this.ga=null,this.Pu=null,this.ps=null,this.ya=this.Va.bind(this),this.pa=new Ii(Jr),this.lr=!1,this.va=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ba=ch(this.persistenceKey,this.Pa),this.Sa=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.pa=this.pa.Tt(this.Pa,new yh),this.Da=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Ca=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Na=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.xa=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Fa=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.ya)}return t.Gs=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(O.b)(this,void 0,void 0,function(){var t,e,n,r,i,o,u,s,a,c,h=this;return Object(O.e)(this,function(f){switch(f.label){case 0:return[4,this.ga.Ic()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Pa&&(i=this.getItem(ch(this.persistenceKey,r)))&&(o=dh.Ia(r,i))&&(this.pa=this.pa.Tt(o.clientId,o));for(this.Oa(),(u=this.storage.getItem(this.xa))&&(s=this.Ma(u))&&this.ka(s),a=0,c=this.va;a<c.length;a++)this.Va(c[a]);return this.va=[],this.window.addEventListener("unload",function(){return h.fc()}),this.lr=!0,[2]}})})},t.prototype.Ss=function(t){this.setItem(this.Sa,JSON.stringify(t))},t.prototype.$a=function(){return this.La(this.pa)},t.prototype.Ba=function(t){var e=!1;return this.pa.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.qa=function(t){this.Ua(t,"pending")},t.prototype.Qa=function(t,e,n){this.Ua(t,e,n),this.Ka(t)},t.prototype.Wa=function(t){var e="not-current";if(this.Ba(t)){var n=this.storage.getItem(fh(this.persistenceKey,t));if(n){var r=ph.Ia(t,n);r&&(e=r.state)}}return this.ja.Aa(t),this.Oa(),e},t.prototype.Ga=function(t){this.ja.Ra(t),this.Oa()},t.prototype.za=function(t){return this.ja.activeTargetIds.has(t)},t.prototype.Ha=function(t){this.removeItem(fh(this.persistenceKey,t))},t.prototype.Ja=function(t,e,n){this.Ya(t,e,n)},t.prototype.Xa=function(t,e,n){var r=this;e.forEach(function(t){r.Ka(t)}),this.currentUser=t,n.forEach(function(t){r.qa(t)})},t.prototype.Za=function(t){this.th(t)},t.prototype.eh=function(){this.nh()},t.prototype.fc=function(){this.lr&&(this.window.removeEventListener("storage",this.ya),this.removeItem(this.ba),this.lr=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Rr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Rr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Rr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Va=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Rr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ba)return void Lr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Cs.Mi(function(){return Object(O.b)(e,void 0,void 0,function(){var t,e,r,i,o,u;return Object(O.e)(this,function(s){if(this.lr){if(null!==n.key)if(this.Da.test(n.key)){if(null==n.newValue)return t=this.sh(n.key),[2,this.ih(t,null)];if(e=this.rh(n.key,n.newValue))return[2,this.ih(e.clientId,e)]}else if(this.Ca.test(n.key)){if(null!==n.newValue&&(r=this.oh(n.key,n.newValue)))return[2,this.uh(r)]}else if(this.Na.test(n.key)){if(null!==n.newValue&&(i=this.ah(n.key,n.newValue)))return[2,this.hh(i)]}else if(n.key===this.xa){if(null!==n.newValue&&(o=this.Ma(n.newValue)))return[2,this.ka(o)]}else if(n.key===this.Sa)(u=function(t){var e=Ns.Ds;if(null!=t)try{var n=JSON.parse(t);qr("number"==typeof n),e=n}catch(t){Lr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Ns.Ds&&this.ps(u);else if(n.key===this.Fa)return[2,this.ga.lh()]}else this.va.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"ja",{get:function(){return this.pa.get(this.Pa)},enumerable:!1,configurable:!0}),t.prototype.Oa=function(){this.setItem(this.ba,this.ja.ma())},t.prototype.Ua=function(t,e,n){var r=new lh(this.currentUser,t,e,n),i=hh(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ma())},t.prototype.Ka=function(t){var e=hh(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.th=function(t){this.storage.setItem(this.xa,JSON.stringify({clientId:this.Pa,onlineState:t}))},t.prototype.Ya=function(t,e,n){var r=fh(this.persistenceKey,t),i=new ph(t,e,n);this.setItem(r,i.ma())},t.prototype.nh=function(){this.setItem(this.Fa,"value-not-used")},t.prototype.sh=function(t){var e=this.Da.exec(t);return e?e[1]:null},t.prototype.rh=function(t,e){var n=this.sh(t);return dh.Ia(n,e)},t.prototype.oh=function(t,e){var n=this.Ca.exec(t),r=Number(n[1]);return lh.Ia(new Dr(void 0!==n[2]?n[2]:null),r,e)},t.prototype.ah=function(t,e){var n=this.Na.exec(t),r=Number(n[1]);return ph.Ia(r,e)},t.prototype.Ma=function(t){return vh.Ia(t)},t.prototype.uh=function(t){return Object(O.b)(this,void 0,void 0,function(){return Object(O.e)(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.ga._h(t.batchId,t.state,t.error)]:(Rr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.hh=function(t){return this.ga.fh(t.targetId,t.state,t.error)},t.prototype.ih=function(t,e){var n=this,r=e?this.pa.Tt(t,e):this.pa.remove(t),i=this.La(this.pa),o=this.La(r),u=[],s=[];return o.forEach(function(t){i.has(t)||u.push(t)}),i.forEach(function(t){o.has(t)||s.push(t)}),this.ga.dh(u,s).then(function(){n.pa=r})},t.prototype.ka=function(t){this.pa.get(t.clientId)&&this.Pu(t.onlineState)},t.prototype.La=function(t){var e=Li();return t.forEach(function(t,n){e=e.Gt(n.activeTargetIds)}),e},t}(),bh=function(){function t(){this.wh=new yh,this.Eh={},this.Pu=null,this.ps=null}return t.prototype.qa=function(t){},t.prototype.Qa=function(t,e,n){},t.prototype.Wa=function(t){return this.wh.Aa(t),this.Eh[t]||"not-current"},t.prototype.Ja=function(t,e,n){this.Eh[t]=e},t.prototype.Ga=function(t){this.wh.Ra(t)},t.prototype.za=function(t){return this.wh.activeTargetIds.has(t)},t.prototype.Ha=function(t){delete this.Eh[t]},t.prototype.$a=function(){return this.wh.activeTargetIds},t.prototype.Ba=function(t){return this.wh.activeTargetIds.has(t)},t.prototype.start=function(){return this.wh=new yh,Promise.resolve()},t.prototype.Xa=function(t,e,n){},t.prototype.Za=function(t){},t.prototype.fc=function(){},t.prototype.Ss=function(t){},t.prototype.eh=function(){},t}(),mh=function(t){this.key=t},wh=function(t){this.key=t},_h=function(){function t(t,e){this.query=t,this.Th=e,this.Ih=null,this.le=!1,this.mh=Pi(),this.ee=Pi(),this.Ah=Zu(t),this.Rh=new Vi(this.Ah)}return Object.defineProperty(t.prototype,"Ph",{get:function(){return this.Th},enumerable:!1,configurable:!0}),t.prototype.gh=function(t,e){var n=this,r=e?e.yh:new Ui,i=e?e.Rh:this.Rh,o=e?e.ee:this.ee,u=i,s=!1,a=Fu(this.query)&&i.size===this.query.limit?i.last():null,c=zu(this.query)&&i.size===this.query.limit?i.first():null;if(t.Pt(function(t,e){var h=i.get(t),f=e instanceof Ru?e:null;f&&(f=$u(n.query,f)?f:null);var l=!!h&&n.ee.has(h.key),p=!!f&&(f.an||n.ee.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.Vh(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.Ah(f,a)>0||c&&n.Ah(f,c)<0)&&(s=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(s=!0)),d&&(f?(u=u.add(f),o=p?o.add(t):o.delete(t)):(u=u.delete(t),o=o.delete(t)))}),Fu(this.query)||zu(this.query))for(;u.size>this.query.limit;){var h=Fu(this.query)?u.last():u.first();u=u.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{Rh:u,yh:r,ph:s,ee:o}},t.prototype.Vh=function(t,e){return t.an&&e.hasCommittedMutations&&!e.an},t.prototype.Zn=function(t,e,n){var r=this,i=this.Rh;this.Rh=t.Rh,this.ee=t.ee;var o=t.yh.Zt();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Mr()}};return n(t)-n(e)}(t.type,e.type)||r.Ah(t.doc,e.doc)}),this.bh(n);var u=e?this.Sh():[],s=0===this.mh.size&&this.le?1:0,a=s!==this.Ih;return this.Ih=s,0!==o.length||a?{snapshot:new Mi(this.query,t.Rh,i,o,t.ee,0===s,a,!1),Dh:u}:{Dh:u}},t.prototype.Yu=function(t){return this.le&&"Offline"===t?(this.le=!1,this.Zn({Rh:this.Rh,yh:new Ui,ee:this.ee,ph:!1},!1)):{Dh:[]}},t.prototype.Ch=function(t){return!this.Th.has(t)&&!!this.Rh.has(t)&&!this.Rh.get(t).an},t.prototype.bh=function(t){var e=this;t&&(t._e.forEach(function(t){return e.Th=e.Th.add(t)}),t.fe.forEach(function(t){}),t.de.forEach(function(t){return e.Th=e.Th.delete(t)}),this.le=t.le)},t.prototype.Sh=function(){var t=this;if(!this.le)return[];var e=this.mh;this.mh=Pi(),this.Rh.forEach(function(e){t.Ch(e.key)&&(t.mh=t.mh.add(e.key))});var n=[];return e.forEach(function(e){t.mh.has(e)||n.push(new wh(e))}),this.mh.forEach(function(t){e.has(t)||n.push(new mh(t))}),n},t.prototype.Nh=function(t){this.Th=t.Bc,this.mh=Pi();var e=this.gh(t.documents);return this.Zn(e,!0)},t.prototype.xh=function(){return Mi.ie(this.query,this.Rh,this.ee,0===this.Ih)},t}(),Ih=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Oh=function(t){this.key=t,this.Fh=!1},Eh=function(){function t(t,e,n,r,i,o){this.Cu=t,this.Oh=e,this.Mh=n,this.kh=r,this.currentUser=i,this.$h=o,this.Lh={},this.Bh=new bs(function(t){return Yu(t)},Qu),this.qh=new Map,this.Uh=[],this.Qh=new Ii(ui.$),this.Kh=new Map,this.Wh=new sh,this.jh={},this.Gh=new Map,this.zh=Qa._o(),this.onlineState="Unknown",this.Hh=void 0}return Object.defineProperty(t.prototype,"Jh",{get:function(){return!0===this.Hh},enumerable:!1,configurable:!0}),t}();function Th(t,e){return Object(O.b)(this,void 0,void 0,function(){var n,r,i,o,u;return Object(O.e)(this,function(s){switch(s.label){case 0:return n=tf(t),(i=n.Bh.get(e))?(n.kh.Wa(i.targetId),r=i.view.xh(),[3,4]):[3,1];case 1:return[4,vc(n.Cu,Hu(e))];case 2:return o=s.sent(),u=n.kh.Wa(o.targetId),[4,jh(n,e,o.targetId,"current"===u)];case 3:r=s.sent(),n.Jh&&kc(n.Oh,o),s.label=4;case 4:return[2,r]}})})}function jh(t,e,n,r){return Object(O.b)(this,void 0,void 0,function(){var i,o,u,s,a,c;return Object(O.e)(this,function(h){switch(h.label){case 0:return t.Yh=function(e,n,r){return function(t,e,n,r){return Object(O.b)(this,void 0,void 0,function(){var i,o,u;return Object(O.e)(this,function(s){switch(s.label){case 0:return(i=e.view.gh(n)).ph?[4,gc(t.Cu,e.query,!1).then(function(t){return e.view.gh(t.documents,i)})]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return o=r&&r.re.get(e.targetId),u=e.view.Zn(i,t.Jh,o),[2,(Mh(t,e.targetId,u.Dh),u.snapshot)]}})})}(t,e,n,r)},[4,gc(t.Cu,e,!0)];case 1:return i=h.sent(),o=new _h(e,i.Bc),u=o.gh(i.documents),s=Fi.he(n,r&&"Offline"!==t.onlineState),a=o.Zn(u,t.Jh,s),Mh(t,n,a.Dh),c=new Ih(e,n,o),[2,(t.Bh.set(e,c),t.qh.has(n)?t.qh.get(n).push(e):t.qh.set(n,[e]),a.snapshot)]}})})}function Ah(t,e){return Object(O.b)(this,void 0,void 0,function(){var n,r,i;return Object(O.e)(this,function(o){switch(o.label){case 0:return n=Fr(t),r=n.Bh.get(e),(i=n.qh.get(r.targetId)).length>1?[2,(n.qh.set(r.targetId,i.filter(function(t){return!Qu(t,e)})),void n.Bh.delete(e))]:n.Jh?(n.kh.Ga(r.targetId),n.kh.Ba(r.targetId)?[3,2]:[4,yc(n.Cu,r.targetId,!1).then(function(){n.kh.Ha(r.targetId),Sc(n.Oh,r.targetId),Vh(n,r.targetId)}).catch(_c)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Vh(n,r.targetId),[4,yc(n.Cu,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function Nh(t,e,n){return Object(O.b)(this,void 0,void 0,function(){var r,i,o,u;return Object(O.e)(this,function(s){switch(s.label){case 0:r=ef(t),s.label=1;case 1:return s.trys.push([1,5,,6]),[4,function(t,e){var n,r=Fr(t),i=ti.now(),o=e.reduce(function(t,e){return t.add(e.key)},Pi());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Oc._s(t,o).next(function(o){n=o;for(var u=[],s=0,a=e;s<a.length;s++){var c=a[s],h=wu(c,n.get(c.key));null!=h&&u.push(new Eu(c.key,h,Cu(h.proto.mapValue),vu.exists(!0)))}return r.rs.Sr(t,i,u,e)})}).then(function(t){var e=t.vn(n);return{batchId:t.batchId,Qn:e}})}(r.Cu,e)];case 2:return i=s.sent(),r.kh.qa(i.batchId),function(t,e,n){var r=t.jh[t.currentUser.h()];r||(r=new Ii(Jr)),r=r.Tt(e,n),t.jh[t.currentUser.h()]=r}(r,i.batchId,n),[4,zh(r,i.Qn)];case 3:return s.sent(),[4,Bc(r.Oh)];case 4:return s.sent(),[3,6];case 5:return o=s.sent(),u=Bs(o,"Failed to persist write"),n.reject(u),[3,6];case 6:return[2]}})})}function xh(t,e){return Object(O.b)(this,void 0,void 0,function(){var n,r;return Object(O.e)(this,function(i){switch(i.label){case 0:n=Fr(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,pc(n.Cu,e)];case 2:return r=i.sent(),e.re.forEach(function(t,e){var r=n.Kh.get(e);r&&(qr(t._e.size+t.fe.size+t.de.size<=1),t._e.size>0?r.Fh=!0:t.fe.size>0?qr(r.Fh):t.de.size>0&&(qr(r.Fh),r.Fh=!1))}),[4,zh(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,_c(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function kh(t,e,n){var r=Fr(t);if(r.Jh&&0===n||!r.Jh&&1===n){var i=[];r.Bh.forEach(function(t,n){var r=n.view.Yu(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=Fr(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Yu(e)&&(r=!0)}),r&&oh(n)}(r.Mh,e),i.length&&r.Lh.au(i),r.onlineState=e,r.Jh&&r.kh.Za(e)}}function Sh(t,e,n){return Object(O.b)(this,void 0,void 0,function(){var r,i,o,u,s,a;return Object(O.e)(this,function(c){switch(c.label){case 0:return(r=Fr(t)).kh.Ja(e,"rejected",n),i=r.Kh.get(e),(o=i&&i.key)?(u=(u=new Ii(ui.$)).Tt(o,new Lu(o,ei.min())),s=Pi().add(o),a=new qi(ei.min(),new Map,new Ti(Jr),u,s),[4,xh(r,a)]):[3,2];case 1:return c.sent(),r.Qh=r.Qh.remove(o),r.Kh.delete(e),Fh(r),[3,4];case 2:return[4,yc(r.Cu,e,!1).then(function(){return Vh(r,e,n)}).catch(_c)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function Dh(t,e){return Object(O.b)(this,void 0,void 0,function(){var n,r,i;return Object(O.e)(this,function(o){switch(o.label){case 0:n=Fr(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,fc(n.Cu,e)];case 2:return i=o.sent(),Lh(n,r,null),Rh(n,r),n.kh.Qa(r,"acknowledged"),[4,zh(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,_c(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Ch(t,e,n){return Object(O.b)(this,void 0,void 0,function(){var r,i;return Object(O.e)(this,function(o){switch(o.label){case 0:r=Fr(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Fr(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n.rs.Cr(t,e).next(function(e){return qr(null!==e),r=e.keys(),n.rs.$r(t,e)}).next(function(){return n.rs.Ur(t)}).next(function(){return n.Oc._s(t,r)})})}(r.Cu,e)];case 2:return i=o.sent(),Lh(r,e,n),Rh(r,e),r.kh.Qa(e,"rejected",n),[4,zh(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,_c(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Ph(t,e){return Object(O.b)(this,void 0,void 0,function(){var n,r,i,o,u;return Object(O.e)(this,function(s){switch(s.label){case 0:Lc((n=Fr(t)).Oh)||Rr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,function(t){var e=Fr(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.rs.Or(t)})}(n.Cu)];case 2:return-1===(r=s.sent())?[2,void e.resolve()]:((i=n.Gh.get(r)||[]).push(e),n.Gh.set(r,i),[3,4]);case 3:return o=s.sent(),u=Bs(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(u),[3,4];case 4:return[2]}})})}function Rh(t,e){(t.Gh.get(e)||[]).forEach(function(t){t.resolve()}),t.Gh.delete(e)}function Lh(t,e,n){var r=Fr(t),i=r.jh[r.currentUser.h()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.jh[r.currentUser.h()]=i}}function Vh(t,e,n){void 0===n&&(n=null),t.kh.Ga(e);for(var r=0,i=t.qh.get(e);r<i.length;r++){var o=i[r];t.Bh.delete(o),n&&t.Lh.Xh(o,n)}t.qh.delete(e),t.Jh&&t.Wh.da(e).forEach(function(e){t.Wh.Qr(e)||Uh(t,e)})}function Uh(t,e){var n=t.Qh.get(e);null!==n&&(Sc(t.Oh,n),t.Qh=t.Qh.remove(e),t.Kh.delete(n),Fh(t))}function Mh(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof mh?(t.Wh.Do(o.key,e),qh(t,o)):o instanceof wh?(Rr("SyncEngine","Document no longer in limbo: "+o.key),t.Wh.No(o.key,e),t.Wh.Qr(o.key)||Uh(t,o.key)):Mr()}}function qh(t,e){var n=e.key;t.Qh.get(n)||(Rr("SyncEngine","New document in limbo: "+n),t.Uh.push(n),Fh(t))}function Fh(t){for(;t.Uh.length>0&&t.Qh.size<t.$h;){var e=t.Uh.shift(),n=t.zh.next();t.Kh.set(n,new Oh(e)),t.Qh=t.Qh.Tt(e,n),kc(t.Oh,new bi(Hu(qu(e.path)),n,2,Ns.Ds))}}function zh(t,e,n){return Object(O.b)(this,void 0,void 0,function(){var r,i,o,u;return Object(O.e)(this,function(s){switch(s.label){case 0:return r=Fr(t),i=[],o=[],u=[],r.Bh.W()?[3,3]:(r.Bh.forEach(function(t,s){u.push(r.Yh(s,e,n).then(function(t){if(t){r.Jh&&r.kh.Ja(s.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=As.Vs(s.targetId,t);o.push(e)}}))}),[4,Promise.all(u)]);case 1:return s.sent(),r.Lh.au(i),[4,function(t,e){return Object(O.b)(this,void 0,void 0,function(){var n,r,i,o,u,s,a,c;return Object(O.e)(this,function(h){switch(h.label){case 0:n=Fr(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return ms.forEach(e,function(e){return ms.forEach(e.gs,function(r){return n.persistence.Vr.Do(t,e.targetId,r)}).next(function(){return ms.forEach(e.ys,function(r){return n.persistence.Vr.No(t,e.targetId,r)})})})})];case 2:return h.sent(),[3,4];case 3:if(!Cs(r=h.sent()))throw r;return Rr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)s=(u=o[i]).targetId,u.fromCache||(a=n.Cc.get(s),c=a.Et(a.ft),n.Cc=n.Cc.Tt(s,c));return[2]}})})}(r.Cu,o)];case 2:s.sent(),s.label=3;case 3:return[2]}})})}function Bh(t,e){return Object(O.b)(this,void 0,void 0,function(){var n,r;return Object(O.e)(this,function(i){switch(i.label){case 0:return(n=Fr(t)).currentUser.isEqual(e)?[3,3]:(Rr("SyncEngine","User change. New user:",e.h()),[4,hc(n.Cu,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Gh.forEach(function(t){t.forEach(function(t){t.reject(new Br(zr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.Gh.clear()}(n),n.kh.Xa(e,r.$c,r.Lc),[4,zh(n,r.kc)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function Gh(t,e){var n=Fr(t),r=n.Kh.get(e);if(r&&r.Fh)return Pi().add(r.key);var i=Pi(),o=n.qh.get(e);if(!o)return i;for(var u=0,s=o;u<s.length;u++){var a=n.Bh.get(s[u]);i=i.Gt(a.view.Ph)}return i}function Kh(t,e){return Object(O.b)(this,void 0,void 0,function(){var n,r,i;return Object(O.e)(this,function(o){switch(o.label){case 0:return[4,gc((n=Fr(t)).Cu,e.query,!0)];case 1:return r=o.sent(),i=e.view.Nh(r),[2,(n.Jh&&Mh(n,e.targetId,i.Dh),i)]}})})}function Wh(t){return Object(O.b)(this,void 0,void 0,function(){var e;return Object(O.e)(this,function(n){return[2,mc((e=Fr(t)).Cu).then(function(t){return zh(e,t)})]})})}function Hh(t,e,n,r){return Object(O.b)(this,void 0,void 0,function(){var i,o;return Object(O.e)(this,function(u){switch(u.label){case 0:return[4,function(t,e){var n=Fr(t),r=Fr(n.rs);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.Nr(t,e).next(function(e){return e?n.Oc._s(t,e):ms.resolve(null)})})}((i=Fr(t)).Cu,e)];case 1:return null===(o=u.sent())?[3,6]:"pending"!==n?[3,3]:[4,Bc(i.Oh)];case 2:return u.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Lh(i,e,r||null),Rh(i,e),function(t,e){Fr(Fr(t).rs).Br(e)}(i.Cu,e)):Mr(),u.label=4;case 4:return[4,zh(i,o)];case 5:return u.sent(),[3,7];case 6:Rr("SyncEngine","Cannot apply mutation batch with id: "+e),u.label=7;case 7:return[2]}})})}function Xh(t,e){return Object(O.b)(this,void 0,void 0,function(){var n,r,i,o,u,s,a;return Object(O.e)(this,function(c){switch(c.label){case 0:return tf(n=Fr(t)),ef(n),!0!==e||!0===n.Hh?[3,3]:(r=n.kh.$a(),[4,Qh(n,r.H())]);case 1:return i=c.sent(),n.Hh=!0,[4,Yc(n.Oh,!0)];case 2:for(c.sent(),o=0,u=i;o<u.length;o++)kc(n.Oh,u[o]);return[3,7];case 3:return!1!==e||!1===n.Hh?[3,7]:(s=[],a=Promise.resolve(),n.qh.forEach(function(t,e){n.kh.za(e)?s.push(e):a=a.then(function(){return Vh(n,e),yc(n.Cu,e,!0)}),Sc(n.Oh,e)}),[4,a]);case 4:return c.sent(),[4,Qh(n,s)];case 5:return c.sent(),function(t){var e=Fr(t);e.Kh.forEach(function(t,n){Sc(e.Oh,n)}),e.Wh.wa(),e.Kh=new Map,e.Qh=new Ii(ui.$)}(n),n.Hh=!1,[4,Yc(n.Oh,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})}function Qh(t,e,n){return Object(O.b)(this,void 0,void 0,function(){var n,r,i,o,u,s,a,c,h,f,l,p,d;return Object(O.e)(this,function(v){switch(v.label){case 0:n=Fr(t),r=[],i=[],o=0,u=e,v.label=1;case 1:return o<u.length?(a=void 0,(c=n.qh.get(s=u[o]))&&0!==c.length?[4,vc(n.Cu,Hu(c[0]))]:[3,7]):[3,13];case 2:a=v.sent(),h=0,f=c,v.label=3;case 3:return h<f.length?(l=n.Bh.get(f[h]),[4,Kh(n,l)]):[3,6];case 4:(p=v.sent()).snapshot&&i.push(p.snapshot),v.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,bc(n.Cu,s)];case 8:return d=v.sent(),[4,vc(n.Cu,d)];case 9:return a=v.sent(),[4,jh(n,Yh(d),s,!1)];case 10:v.sent(),v.label=11;case 11:r.push(a),v.label=12;case 12:return o++,[3,1];case 13:return[2,(n.Lh.au(i),r)]}})})}function Yh(t){return Mu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Jh(t){var e=Fr(t);return Fr(Fr(e.Cu).persistence).Ic()}function $h(t,e,n,r){return Object(O.b)(this,void 0,void 0,function(){var i,o,u;return Object(O.e)(this,function(s){switch(s.label){case 0:return(i=Fr(t)).Hh?(Rr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.qh.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,mc(i.Cu)];case 3:return o=s.sent(),u=qi.ae(e,"current"===n),[4,zh(i,o,u)];case 4:return s.sent(),[3,8];case 5:return[4,yc(i.Cu,e,!0)];case 6:return s.sent(),Vh(i,e,r),[3,8];case 7:Mr(),s.label=8;case 8:return[2]}})})}function Zh(t,e,n){return Object(O.b)(this,void 0,void 0,function(){var r,i,o,u,s,a,c,h,f;return Object(O.e)(this,function(l){switch(l.label){case 0:if(!(r=tf(t)).Hh)return[3,10];i=0,o=e,l.label=1;case 1:return i<o.length?r.qh.has(u=o[i])?(Rr("SyncEngine","Adding an already active target "+u),[3,5]):[4,bc(r.Cu,u)]:[3,6];case 2:return s=l.sent(),[4,vc(r.Cu,s)];case 3:return a=l.sent(),[4,jh(r,Yh(s),a.targetId,!1)];case 4:l.sent(),kc(r.Oh,a),l.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(O.e)(this,function(e){switch(e.label){case 0:return r.qh.has(t)?[4,yc(r.Cu,t,!1).then(function(){Sc(r.Oh,t),Vh(r,t)}).catch(_c)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},h=0,f=n,l.label=7;case 7:return h<f.length?[5,c(f[h])]:[3,10];case 8:l.sent(),l.label=9;case 9:return h++,[3,7];case 10:return[2]}})})}function tf(t){var e=Fr(t);return e.Oh.xu.Qu=xh.bind(null,e),e.Oh.xu.Xe=Gh.bind(null,e),e.Oh.xu.Uu=Sh.bind(null,e),e.Lh.au=rh.bind(null,e.Mh),e.Lh.Xh=ih.bind(null,e.Mh),e}function ef(t){var e=Fr(t);return e.Oh.xu.Ku=Dh.bind(null,e),e.Oh.xu.Wu=Ch.bind(null,e),e}var nf=function(){function t(){}return t.prototype.Mc=function(t){this.Zh=t},t.prototype.ws=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.Tn.length||1===t.Tn.length&&t.Tn[0].field.tt())}(e)||n.isEqual(ei.min())?this.tl(t,e):this.Zh._s(t,r).next(function(o){var u=i.el(e,o);return(Fu(e)||zu(e))&&i.ph(e.limitType,u,r,n)?i.tl(t,e):(Pr()<=T.a.DEBUG&&Rr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Ju(e)),i.Zh.ws(t,e,n).next(function(t){return u.forEach(function(e){t=t.Tt(e.key,e)}),t}))})},t.prototype.el=function(t,e){var n=new Ti(Zu(t));return e.forEach(function(e,r){r instanceof Ru&&$u(t,r)&&(n=n.add(r))}),n},t.prototype.ph=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.F(r)>0)},t.prototype.tl=function(t,e){return Pr()<=T.a.DEBUG&&Rr("IndexFreeQueryEngine","Using full collection scan to execute query:",Ju(e)),this.Zh.ws(t,e,ei.min())},t}(),rf=function(){function t(t,e){this.os=t,this.Vr=e,this.rs=[],this.nl=1,this.sl=new Ti(ah.ua)}return t.prototype.br=function(t){return ms.resolve(0===this.rs.length)},t.prototype.Sr=function(t,e,n,r){var i=this.nl;this.nl++;var o=new ys(i,e,n,r);this.rs.push(o);for(var u=0,s=r;u<s.length;u++){var a=s[u];this.sl=this.sl.add(new ah(a.key,i)),this.os.Dr(t,a.key.path.q())}return ms.resolve(o)},t.prototype.Cr=function(t,e){return ms.resolve(this.il(e))},t.prototype.Fr=function(t,e){var n=this.rl(e+1),r=n<0?0:n;return ms.resolve(this.rs.length>r?this.rs[r]:null)},t.prototype.Or=function(){return ms.resolve(0===this.rs.length?-1:this.nl-1)},t.prototype.Mr=function(t){return ms.resolve(this.rs.slice())},t.prototype.us=function(t,e){var n=this,r=new ah(e,0),i=new ah(e,Number.POSITIVE_INFINITY),o=[];return this.sl.Kt([r,i],function(t){var e=n.il(t.Ta);o.push(e)}),ms.resolve(o)},t.prototype.ds=function(t,e){var n=this,r=new Ti(Jr);return e.forEach(function(t){var e=new ah(t,0),i=new ah(t,Number.POSITIVE_INFINITY);n.sl.Kt([e,i],function(t){r=r.add(t.Ta)})}),ms.resolve(this.ol(r))},t.prototype.Rs=function(t,e){var n=e.path,r=n.length+1,i=n;ui.ot(i)||(i=i.child(""));var o=new ah(new ui(i),0),u=new Ti(Jr);return this.sl.Wt(function(t){var e=t.key.path;return!!n.j(e)&&(e.length===r&&(u=u.add(t.Ta)),!0)},o),ms.resolve(this.ol(u))},t.prototype.ol=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.il(t);null!==r&&n.push(r)}),n},t.prototype.$r=function(t,e){var n=this;qr(0===this.cl(e.batchId,"removed")),this.rs.shift();var r=this.sl;return ms.forEach(e.mutations,function(i){var o=new ah(i.key,e.batchId);return r=r.delete(o),n.Vr.qr(t,i.key)}).next(function(){n.sl=r})},t.prototype.Br=function(t){},t.prototype.Qr=function(t,e){var n=new ah(e,0),r=this.sl.jt(n);return ms.resolve(e.isEqual(r&&r.key))},t.prototype.Ur=function(t){return ms.resolve()},t.prototype.cl=function(t,e){return this.rl(t)},t.prototype.rl=function(t){return 0===this.rs.length?0:t-this.rs[0].batchId},t.prototype.il=function(t){var e=this.rl(t);return e<0||e>=this.rs.length?null:this.rs[e]},t}(),of=function(){function t(t,e){this.os=t,this.ul=e,this.docs=new Ii(ui.$),this.size=0}return t.prototype.jn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,u=this.ul(e);return this.docs=this.docs.Tt(r,{zn:e,size:u,readTime:n}),this.size+=u-o,this.os.Dr(t,r.path.q())},t.prototype.Hn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Jn=function(t,e){var n=this.docs.get(e);return ms.resolve(n?n.zn:null)},t.prototype.getEntries=function(t,e){var n=this,r=xi();return e.forEach(function(t){var e=n.docs.get(t);r=r.Tt(t,e?e.zn:null)}),ms.resolve(r)},t.prototype.ws=function(t,e,n){for(var r=Si(),i=new ui(e.path.child("")),o=this.docs.Vt(i);o.Nt();){var u=o.Ct(),s=u.value,a=s.zn,c=s.readTime;if(!e.path.j(u.key.path))break;c.F(n)<=0||a instanceof Ru&&$u(e,a)&&(r=r.Tt(a.key,a))}return ms.resolve(r)},t.prototype.al=function(t,e){return ms.forEach(this.docs,function(t){return e(t)})},t.prototype.Xr=function(t){return new uf(this)},t.prototype.eo=function(t){return ms.resolve(this.size)},t}(),uf=function(t){function e(e){var n=this;return(n=t.call(this)||this).no=e,n}return Object(O.d)(e,t),e.prototype.Zn=function(t){var e=this,n=[];return this.Qn.forEach(function(r,i){i&&i.zn?n.push(e.no.jn(t,i.zn,e.Wn(r))):e.no.Hn(r)}),ms.qn(n)},e.prototype.Yn=function(t,e){return this.no.Jn(t,e)},e.prototype.Xn=function(t,e){return this.no.getEntries(t,e)},e}(ws),sf=function(){function t(t){this.persistence=t,this.hl=new bs(function(t){return li(t)},pi),this.lastRemoteSnapshotVersion=ei.min(),this.highestTargetId=0,this.ll=0,this._l=new sh,this.targetCount=0,this.fl=Qa.lo()}return t.prototype.Ue=function(t,e){return this.hl.forEach(function(t,n){return e(n)}),ms.resolve()},t.prototype.To=function(t){return ms.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Io=function(t){return ms.resolve(this.ll)},t.prototype.fo=function(t){return this.highestTargetId=this.fl.next(),ms.resolve(this.highestTargetId)},t.prototype.mo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ll&&(this.ll=e),ms.resolve()},t.prototype.Ro=function(t){this.hl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.fl=new Qa(e),this.highestTargetId=e),t.sequenceNumber>this.ll&&(this.ll=t.sequenceNumber)},t.prototype.Ao=function(t,e){return this.Ro(e),this.targetCount+=1,ms.resolve()},t.prototype.yo=function(t,e){return this.Ro(e),ms.resolve()},t.prototype.Vo=function(t,e){return this.hl.delete(e.target),this._l.da(e.targetId),this.targetCount-=1,ms.resolve()},t.prototype.mr=function(t,e,n){var r=this,i=0,o=[];return this.hl.forEach(function(u,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.hl.delete(u),o.push(r.po(t,s.targetId)),i++)}),ms.qn(o).next(function(){return i})},t.prototype.vo=function(t){return ms.resolve(this.targetCount)},t.prototype.bo=function(t,e){var n=this.hl.get(e)||null;return ms.resolve(n)},t.prototype.So=function(t,e,n){return this._l.la(e,n),ms.resolve()},t.prototype.Co=function(t,e,n){this._l.fa(e,n);var r=this.persistence.Vr,i=[];return r&&e.forEach(function(e){i.push(r.qr(t,e))}),ms.qn(i)},t.prototype.po=function(t,e){return this._l.da(e),ms.resolve()},t.prototype.xo=function(t,e){var n=this._l.Ea(e);return ms.resolve(n)},t.prototype.Qr=function(t,e){return ms.resolve(this._l.Qr(e))},t}(),af=function(){function t(t){this.serializer=t,this.dl=new Map,this.wl=new Map}return t.prototype.ro=function(t,e){return ms.resolve(this.dl.get(e))},t.prototype.oo=function(t,e){var n;return this.dl.set(e.id,{id:(n=e).id,version:n.version,createTime:No(n.createTime)}),ms.resolve()},t.prototype.co=function(t,e){return ms.resolve(this.wl.get(e))},t.prototype.uo=function(t,e){var n;return this.wl.set(e.name,{name:(n=e).name,query:ha(n.bundledQuery),readTime:No(n.readTime)}),ms.resolve()},t}(),cf=function(){function t(t,e){var n=this;this.El={},this.ko=new Ns(0),this.$o=!1,this.$o=!0,this.Vr=t(this),this.jo=new sf(this),this.os=new Oa,this.ss=function(t,e){return new of(t,function(t){return n.Vr.Tl(t)})}(this.os),this.serializer=new ta(e),this.Go=new af(this.serializer)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.fc=function(){return this.$o=!1,Promise.resolve()},Object.defineProperty(t.prototype,"lr",{get:function(){return this.$o},enumerable:!1,configurable:!0}),t.prototype.tc=function(){},t.prototype.ec=function(){},t.prototype.Pc=function(){return this.os},t.prototype.mc=function(t){var e=this.El[t.h()];return e||(e=new rf(this.os,this.Vr),this.El[t.h()]=e),e},t.prototype.Ac=function(){return this.jo},t.prototype.Rc=function(){return this.ss},t.prototype.gc=function(){return this.Go},t.prototype.runTransaction=function(t,e,n){var r=this;Rr("MemoryPersistence","Starting transaction:",t);var i=new hf(this.ko.next());return this.Vr.Il(),n(i).next(function(t){return r.Vr.ml(i).next(function(){return t})}).Ln().then(function(t){return i.ns(),t})},t.prototype.Al=function(t,e){return ms.Un(Object.values(this.El).map(function(n){return function(){return n.Qr(t,e)}}))},t}(),hf=function(t){function e(e){var n=this;return(n=t.call(this)||this).Fo=e,n}return Object(O.d)(e,t),e}(Ts),ff=function(){function t(t){this.persistence=t,this.Rl=new sh,this.Pl=null}return t.gl=function(e){return new t(e)},Object.defineProperty(t.prototype,"yl",{get:function(){if(this.Pl)return this.Pl;throw Mr()},enumerable:!1,configurable:!0}),t.prototype.Do=function(t,e,n){return this.Rl.Do(n,e),this.yl.delete(n.toString()),ms.resolve()},t.prototype.No=function(t,e,n){return this.Rl.No(n,e),this.yl.add(n.toString()),ms.resolve()},t.prototype.qr=function(t,e){return this.yl.add(e.toString()),ms.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.Rl.da(e.targetId).forEach(function(t){return n.yl.add(t.toString())});var r=this.persistence.Ac();return r.xo(t,e.targetId).next(function(t){t.forEach(function(t){return n.yl.add(t.toString())})}).next(function(){return r.Vo(t,e)})},t.prototype.Il=function(){this.Pl=new Set},t.prototype.ml=function(t){var e=this,n=this.persistence.Rc().Xr();return ms.forEach(this.yl,function(r){var i=ui.st(r);return e.Vl(t,i).next(function(t){t||n.Hn(i)})}).next(function(){return e.Pl=null,n.apply(t)})},t.prototype.Sc=function(t,e){var n=this;return this.Vl(t,e).next(function(t){t?n.yl.delete(e.toString()):n.yl.add(e.toString())})},t.prototype.Tl=function(t){return 0},t.prototype.Vl=function(t,e){var n=this;return ms.Un([function(){return ms.resolve(n.Rl.Qr(e))},function(){return n.persistence.Ac().Qr(t,e)},function(){return n.persistence.Al(t,e)}])},t}(),lf=function(){function t(t){this.pl=t.pl,this.vl=t.vl}return t.prototype.cu=function(t){this.bl=t},t.prototype.nu=function(t){this.Sl=t},t.prototype.onMessage=function(t){this.Dl=t},t.prototype.close=function(){this.vl()},t.prototype.send=function(t){this.pl(t)},t.prototype.Cl=function(){this.bl()},t.prototype.Nl=function(t){this.Sl(t)},t.prototype.xl=function(t){this.Dl(t)},t}(),pf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},df=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.i=e.i,n}return Object(O.d)(e,t),e.prototype.Ll=function(t,e,n,r){return new Promise(function(i,o){var u=new Nr;u.listenOnce(Tr.COMPLETE,function(){try{switch(u.getLastErrorCode()){case Er.NO_ERROR:var e=u.getResponseJson();Rr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Er.TIMEOUT:Rr("Connection",'RPC "'+t+'" timed out'),o(new Br(zr.DEADLINE_EXCEEDED,"Request time out"));break;case Er.HTTP_ERROR:var n=u.getStatus();if(Rr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",u.getResponseText()),n>0){var r=u.getResponseJson().error;if(r&&r.status&&r.message){var s=function(t){var e=t.toLowerCase().replace("_","-");return Object.values(zr).indexOf(e)>=0?e:zr.UNKNOWN}(r.status);o(new Br(s,r.message))}else o(new Br(zr.UNKNOWN,"Server responded with status "+u.getStatus()))}else o(new Br(zr.UNAVAILABLE,"Connection failed."));break;default:Mr()}}finally{Rr("Connection",'RPC "'+t+'" completed.')}});var s=JSON.stringify(r);u.send(e,"POST",s,n,15)})},e.prototype.uu=function(t,e){var n=[this.Ol,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new mr,i=_e(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.$l(o.initMessageHeaders,e),Object(j.l)()||Object(j.n)()||Object(j.j)()||Object(j.k)()||Object(j.o)()||Object(j.i)()||(o.httpHeadersOverwriteParam="$httpHeaders");var u=n.join("");Rr("Connection","Creating WebChannel: "+u,o);var s=r.createWebChannel(u,o),a=!1,c=!1,h=new lf({pl:function(t){c?Rr("Connection","Not sending because WebChannel is closed:",t):(a||(Rr("Connection","Opening WebChannel transport."),s.open(),a=!0),Rr("Connection","WebChannel sending:",t),s.send(t))},vl:function(){return s.close()}}),f=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return f(s,Ar.EventType.OPEN,function(){c||Rr("Connection","WebChannel transport opened.")}),f(s,Ar.EventType.CLOSE,function(){c||(c=!0,Rr("Connection","WebChannel transport closed"),h.Nl())}),f(s,Ar.EventType.ERROR,function(t){c||(c=!0,Vr("Connection","WebChannel transport errored:",t),h.Nl(new Br(zr.UNAVAILABLE,"The operation could not be completed")))}),f(s,Ar.EventType.MESSAGE,function(t){var e;if(!c){var n=t.data[0];qr(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){Rr("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=yi[t];if(void 0!==e)return _i(e)}(i),u=r.message;void 0===o&&(o=zr.INTERNAL,u="Unknown error status: "+i+" with message "+r.message),c=!0,h.Nl(new Br(o,u)),s.close()}else Rr("Connection","WebChannel received:",n),h.xl(n)}}),f(i,jr.STAT_EVENT,function(t){10===t.stat?Rr("Connection","Detected buffering proxy"):11===t.stat&&Rr("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Cl()},0),h},e}(function(){function t(t){this.Fl=t,this.t=t.t,this.Ol=(t.ssl?"https":"http")+"://"+t.host,this.Ml="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}return t.prototype.Au=function(t,e,n,r){var i=this.kl(t,e);Rr("RestConnection","Sending: ",i,n);var o={};return this.$l(o,r),this.Ll(t,i,o,n).then(function(t){return Rr("RestConnection","Received: ",t),t},function(e){throw Vr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.Ru=function(t,e,n,r){return this.Au(t,e,n,r)},t.prototype.$l=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.1",t["Content-Type"]="text/plain",e)for(var n in e.T)e.T.hasOwnProperty(n)&&(t[n]=e.T[n])},t.prototype.kl=function(t,e){return this.Ol+"/v1/"+e+":"+pf[t]},t}()),vf=function(){function t(){var t=this;this.Bl=function(){return t.ql()},this.Ul=function(){return t.Ql()},this.Kl=[],this.Wl()}return t.prototype.Lu=function(t){this.Kl.push(t)},t.prototype.fc=function(){window.removeEventListener("online",this.Bl),window.removeEventListener("offline",this.Ul)},t.prototype.Wl=function(){window.addEventListener("online",this.Bl),window.addEventListener("offline",this.Ul)},t.prototype.ql=function(){Rr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(0)},t.prototype.Ql=function(){Rr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(1)},t.Gs=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),yf=function(){function t(){}return t.prototype.Lu=function(t){},t.prototype.fc=function(){},t}(),gf=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(O.b)(this,void 0,void 0,function(){return Object(O.e)(this,function(e){switch(e.label){case 0:return this.serializer=Is(t.Fl.t),this.kh=this.jl(t),this.persistence=this.Gl(t),[4,this.persistence.start()];case 1:return e.sent(),this.zl=this.Hl(t),this.Cu=this.Jl(t),[2]}})})},t.prototype.Hl=function(t){return null},t.prototype.Jl=function(t){return cc(this.persistence,new nf,t.Yl,this.serializer)},t.prototype.Gl=function(t){return new cf(ff.gl,this.serializer)},t.prototype.jl=function(t){return new bh},t.prototype.terminate=function(){return Object(O.b)(this,void 0,void 0,function(){return Object(O.e)(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.kh.fc()];case 1:return t.sent(),[4,this.persistence.fc()];case 2:return t.sent(),[2]}})})},t}(),bf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(O.d)(e,t),e.prototype.initialize=function(e){return Object(O.b)(this,void 0,void 0,function(){return Object(O.e)(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,wc(this.Cu)];case 2:return n.sent(),[4,this.Xl.initialize(this,e)];case 3:return n.sent(),[4,ef(this.Xl.ga)];case 4:return n.sent(),[4,Bc(this.Xl.Oh)];case 5:return n.sent(),[2]}})})},e.prototype.Jl=function(t){return cc(this.persistence,new nf,t.Yl,this.serializer)},e.prototype.Hl=function(t){return new Xs(this.persistence.Vr.cr,t.di)},e.prototype.Gl=function(t){var e=sc(t.Fl.t,t.Fl.persistenceKey),n=void 0!==this.cacheSizeBytes?Hs.er(this.cacheSizeBytes):Hs.ir;return new nc(this.synchronizeTabs,e,t.clientId,n,t.di,Ms(),qs(),this.serializer,this.kh,!!this.forceOwnership)},e.prototype.jl=function(t){return new bh},e}(gf),mf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Xl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(O.d)(e,t),e.prototype.initialize=function(e){return Object(O.b)(this,void 0,void 0,function(){var n,r=this;return Object(O.e)(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Xl.ga,this.kh instanceof gh?(this.kh.ga={_h:Hh.bind(null,n),fh:$h.bind(null,n),dh:Zh.bind(null,n),Ic:Jh.bind(null,n),lh:Wh.bind(null,n)},[4,this.kh.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.Zo(function(t){return Object(O.b)(r,void 0,void 0,function(){return Object(O.e)(this,function(e){switch(e.label){case 0:return[4,Xh(this.Xl.ga,t)];case 1:return e.sent(),this.zl&&(t&&!this.zl.lr?this.zl.start(this.Cu):t||this.zl.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.jl=function(t){var e=Ms();if(!gh.Gs(e))throw new Br(zr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=sc(t.Fl.t,t.Fl.persistenceKey);return new gh(e,t.di,n,t.clientId,t.Yl)},e}(bf),wf=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(O.b)(this,void 0,void 0,function(){var n=this;return Object(O.e)(this,function(r){switch(r.label){case 0:return this.Cu?[3,2]:(this.Cu=t.Cu,this.kh=t.kh,this.Nu=this.Zl(e),this.Oh=this.t_(e),this.Mh=this.e_(e),this.ga=this.n_(e,!t.synchronizeTabs),this.kh.Pu=function(t){return kh(n.ga,t,1)},this.Oh.xu.s_=Bh.bind(null,this.ga),[4,Yc(this.Oh,this.ga.Jh)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.e_=function(t){return new th},t.prototype.Zl=function(t){var e=Is(t.Fl.t),n=new df(t.Fl);return function(t,e,n){return new Tc(t,e,n)}(t.credentials,n,e)},t.prototype.t_=function(t){var e,n,r,i,o,u=this;return e=this.Cu,n=this.Nu,r=t.di,i=function(t){return kh(u.ga,t,0)},o=vf.Gs()?new vf:new yf,new Ac(e,n,r,i,o)},t.prototype.n_=function(t,e){return function(t,e,n,r,i,o,u){var s=new Eh(t,e,n,r,i,o);return u&&(s.Hh=!0),s}(this.Cu,this.Oh,this.Mh,this.kh,t.Yl,t.$h,e)},t.prototype.terminate=function(){return function(t){return Object(O.b)(this,void 0,void 0,function(){var e;return Object(O.e)(this,function(n){switch(n.label){case 0:return e=Fr(t),Rr("RemoteStore","RemoteStore shutting down."),e.Mu.add(5),[4,xc(e)];case 1:return n.sent(),e.$u.fc(),e.Bu.set("Unknown"),[2]}})})}(this.Oh)},t}(),_f=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.r_=function(){this.muted=!0},t.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),If=function(t){this.o_=t};function Of(t,e,n){if(!n)throw new Br(zr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Ef(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Br(zr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Tf(t,e,n,r){if(!0===e&&!0===r)throw new Br(zr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function jf(t){if(!ui.ot(t))throw new Br(zr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Af(t){if(ui.ot(t))throw new Br(zr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Nf(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Mr()}function xf(t,e){if(t instanceof If&&(t=t.o_),!(t instanceof e)){if(e.name===t.constructor.name)throw new Br(zr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Nf(t);throw new Br(zr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function kf(t,e){if(e<=0)throw new Br(zr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Sf=function(t){this.c_=t},Df=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(O.d)(e,t),e.prototype.u_=function(t){if(2!==t.a_)throw t.h_(1===t.a_?this.c_+"() can only appear at the top level of your update data":this.c_+"() cannot be used with set() unless you pass {merge:true}");return t.en.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Sf);function Cf(t,e,n){return new Ll({a_:3,l_:e.settings.l_,methodName:t.c_,__:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var Pf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(O.d)(e,t),e.prototype.u_=function(t){return new pu(t.path,new iu)},e.prototype.isEqual=function(t){return t instanceof e},e}(Sf),Rf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).f_=n,r}return Object(O.d)(e,t),e.prototype.u_=function(t){var e=Cf(this,t,!0),n=this.f_.map(function(t){return zl(t,e)}),r=new ou(n);return new pu(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Sf),Lf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).f_=n,r}return Object(O.d)(e,t),e.prototype.u_=function(t){var e=Cf(this,t,!0),n=this.f_.map(function(t){return zl(t,e)}),r=new su(n);return new pu(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Sf),Vf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).d_=n,r}return Object(O.d)(e,t),e.prototype.u_=function(t){var e=new cu(t.serializer,Eo(t.serializer,this.d_));return new pu(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Sf),Uf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Br(zr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Br(zr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.w_=t,this.E_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.w_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.E_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.w_===t.w_&&this.E_===t.E_},t.prototype.toJSON=function(){return{latitude:this.w_,longitude:this.E_}},t.prototype.C=function(t){return Jr(this.w_,t.w_)||Jr(this.E_,t.E_)},t}(),Mf=function(){function t(t){this.T_=t}return t.fromBase64String=function(e){try{return new t(vi.fromBase64String(e))}catch(e){throw new Br(zr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(vi.fromUint8Array(e))},t.prototype.toBase64=function(){return this.T_.toBase64()},t.prototype.toUint8Array=function(){return this.T_.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.T_.isEqual(t.T_)},t}(),qf=new Map,Ff=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Br(zr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Br(zr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Tf("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),zf=function(){function t(t,e){this.I_="(lite)",this.m_=new Ff({}),this.A_=!1,t instanceof Sr?(this.R_=t,this.P_=new Kr):(this.g_=t,this.R_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Br(zr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Sr(t.options.projectId)}(t),this.P_=new Wr(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.g_)throw new Br(zr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.g_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y_",{get:function(){return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"V_",{get:function(){return void 0!==this.p_},enumerable:!1,configurable:!0}),t.prototype.v_=function(t){if(this.A_)throw new Br(zr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.m_=new Ff(t),void 0!==t.credentials&&(this.P_=function(t){if(!t)return new Kr;switch(t.type){case"gapi":var e=t.client;return qr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Xr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Br(zr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.b_=function(){return this.m_},t.prototype.S_=function(){return this.A_=!0,this.m_},t.prototype._delete=function(){return this.p_||(this.p_=this.D_()),this.p_},t.prototype.D_=function(){return function(t){var e=qf.get(t);e&&(Rr("ComponentProvider","Removing Datastore"),qf.delete(t),e.terminate())}(this),Promise.resolve()},t}();function Bf(){if("undefined"==typeof Uint8Array)throw new Br(zr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Gf(){if("undefined"==typeof atob)throw new Br(zr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Kf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(O.d)(e,t),e.fromBase64String=function(t){return Gf(),new e(Mf.fromBase64String(t))},e.fromUint8Array=function(t){return Bf(),new e(Mf.fromUint8Array(t))},e.prototype.toBase64=function(){return Gf(),this.o_.toBase64()},e.prototype.toUint8Array=function(){return Bf(),this.o_.toUint8Array()},e.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(If),Wf=function(){function t(){}return t.prototype.C_=function(t,e){switch(void 0===e&&(e="none"),no(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ho(t.integerValue||t.doubleValue);case 3:return this.N_(t.timestampValue);case 4:return this.x_(t,e);case 5:return t.stringValue;case 6:return this.F_(fo(t.bytesValue));case 7:return this.O_(t.referenceValue);case 8:return this.M_(t.geoPointValue);case 9:return this.k_(t.arrayValue,e);case 10:return this.L_(t.mapValue,e);default:throw Mr()}},t.prototype.L_=function(t,e){var n=this,r={};return Yi(t.fields||{},function(t,i){r[t]=n.C_(i,e)}),r},t.prototype.M_=function(t){return new Uf(ho(t.latitude),ho(t.longitude))},t.prototype.k_=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.C_(t,e)})},t.prototype.x_=function(t,e){switch(e){case"previous":var n=Zi(t);return null==n?null:this.C_(n,e);case"estimate":return this.N_(to(t));default:return null}},t.prototype.N_=function(t){var e=co(t);return new ti(e.seconds,e.nanos)},t.prototype.B_=function(t,e){var n=ri.Y(t);qr(Zo(n));var r=new Sr(n.get(1),n.get(3)),i=new ui(n.B(5));return r.isEqual(e)||Lr("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),Hf=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(O.d)(e,t),e.prototype.F_=function(t){return new Kf(new Mf(t))},e.prototype.O_=function(t){var e=this.B_(t,this.firestore.R_);return wp.q_(e,this.firestore,null)},e}(Wf),Xf=function(){function t(t,e,n,r,i){this.U_=t,this.Q_=e,this.K_=n,this.W_=r,this.j_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.K_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new fl(this.U_,this.j_,this.K_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.W_},t.prototype.data=function(){if(this.W_){if(this.j_){var t=new Qf(this.U_,this.Q_,this.K_,this.W_,null);return this.j_.fromFirestore(t)}return this.Q_.C_(this.W_.En())}},t.prototype.get=function(t){if(this.W_){var e=this.W_.data().field(Yf("DocumentSnapshot.get",t));if(null!==e)return this.Q_.C_(e)}},t}(),Qf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(O.d)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Xf);function Yf(t,e){return"string"==typeof e?Xl(t,e):e instanceof If?e.o_.G_:e.G_}var Jf=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Br(zr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.G_=new oi(t)}return t.prototype.isEqual=function(t){return this.G_.isEqual(t.G_)},t}(),$f=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).z_=new zs,r.I_="name"in e?e.name:"[DEFAULT]",r}return Object(O.d)(e,t),e.prototype.D_=function(){return this.H_||gp(this),this.H_.terminate()},e}(zf);function Zf(t,e,n){var r=this,i=new _s;return t.di.enqueue(function(){return Object(O.b)(r,void 0,void 0,function(){var r;return Object(O.e)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,tp(t,n)];case 1:return o.sent(),[4,ep(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===zr.FAILED_PRECONDITION||t.code===zr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function tl(t){if(t.y_||t.V_)throw new Br(zr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var el=function(t){function e(e,n,r,i,o,u){var s=this;return(s=t.call(this,e,n,r,i,u)||this).U_=e,s.J_=e,s.metadata=o,s}return Object(O.d)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.W_){if(this.j_){var e=new nl(this.U_,this.Q_,this.K_,this.W_,this.metadata,null);return this.j_.fromFirestore(e,t)}return this.Q_.C_(this.W_.En(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.W_){var n=this.W_.data().field(Yf("DocumentSnapshot.get",t));if(null!==n)return this.Q_.C_(n,e.serverTimestamps)}},e}(Xf),nl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(O.d)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(el),rl=function(){function t(t,e,n,r){this.U_=t,this.Q_=e,this.Y_=r,this.metadata=new Ep(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.Y_.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.Y_.docs.forEach(function(r){t.call(e,new nl(n.U_,n.Q_,r.key,r,new Ep(n.Y_.ee.has(r.key),n.Y_.fromCache),n.query.j_))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this.Y_.se)throw new Br(zr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.X_&&this.Z_===e||(this.X_=function(t,e){if(t.Y_.te.W()){var n=0;return t.Y_.docChanges.map(function(e){return{type:"added",doc:new nl(t.U_,t.Q_,e.doc.key,e.doc,new Ep(t.Y_.ee.has(e.doc.key),t.Y_.fromCache),t.query.j_),oldIndex:-1,newIndex:n++}})}var r=t.Y_.te;return t.Y_.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new nl(t.U_,t.Q_,e.doc.key,e.doc,new Ep(t.Y_.ee.has(e.doc.key),t.Y_.fromCache),t.query.j_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:il(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this.Z_=e),this.X_},t}();function il(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Mr()}}function ol(t,e){return t instanceof el&&e instanceof el?t.U_===e.U_&&t.K_.isEqual(e.K_)&&(null===t.W_?null===e.W_:t.W_.isEqual(e.W_))&&t.j_===e.j_:t instanceof rl&&e instanceof rl&&t.U_===e.U_&&kl(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.Y_.isEqual(e.Y_)}var ul=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(O.d)(e,t),e.prototype.F_=function(t){return new Mf(t)},e.prototype.O_=function(t){var e=this.B_(t,this.firestore.R_);return new fl(this.firestore,null,e)},e}(Wf);function sl(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=xf(t.firestore,$f),u=Sl(o);return e instanceof If&&(e=e.o_),cl(o,("string"==typeof e||e instanceof Jf?ql(u,"updateDoc",t.K_,e,n,r):Ml(u,"updateDoc",t.K_,e)).ef(t.K_,vu.exists(!0)))}function al(t){for(var e,n,r,i=this,o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var s={includeMetadataChanges:!1},a=0;"object"!=typeof o[a]||Os(o[a])||(s=o[a],a++);var c,h,f,l={includeMetadataChanges:s.includeMetadataChanges};if(Os(o[a])){var p=o[a];o[a]=null===(e=p.next)||void 0===e?void 0:e.bind(p),o[a+1]=null===(n=p.error)||void 0===n?void 0:n.bind(p),o[a+2]=null===(r=p.complete)||void 0===r?void 0:r.bind(p)}if(t instanceof fl)h=xf(t.firestore,$f),f=qu(t.K_.path),c={next:function(e){o[a]&&o[a](hl(h,t,e))},error:o[a+1],complete:o[a+2]};else{h=xf(t.firestore,$f),f=t.tf;var d=new ul(h);c={next:function(e){o[a]&&o[a](new rl(h,d,t,e))},error:o[a+1],complete:o[a+2]},El(t.tf)}var v=yp(h),y=new _f(c),g=new uh(f,y,l);return h.z_.Ri(function(){return Object(O.b)(i,void 0,void 0,function(){var t;return Object(O.e)(this,function(e){switch(e.label){case 0:return t=eh,[4,ap(v)];case 1:return[2,t.apply(void 0,[e.sent(),g])]}})})}),function(){y.r_(),h.z_.Ri(function(){return Object(O.b)(i,void 0,void 0,function(){var t;return Object(O.e)(this,function(e){switch(e.label){case 0:return t=nh,[4,ap(v)];case 1:return[2,t.apply(void 0,[e.sent(),g])]}})})})}}function cl(t,e){return function(t,e){var n=this,r=new _s;return t.di.Ri(function(){return Object(O.b)(n,void 0,void 0,function(){var n;return Object(O.e)(this,function(i){switch(i.label){case 0:return n=Nh,[4,sp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(yp(t),e)}function hl(t,e,n){var r=n.docs.get(e.K_),i=new ul(t);return new el(t,i,e.K_,r,new Ep(n.hasPendingWrites,n.fromCache),e.j_)}var fl=function(){function t(t,e,n){this.j_=e,this.K_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"nf",{get:function(){return this.K_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.K_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.K_.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Tl(this.firestore,this.j_,this.K_.path.q())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.K_)},t}(),ll=function(){function t(t,e,n){this.j_=e,this.tf=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.tf)},t}(),pl=function(){};function dl(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o.sf(t)}return t}var vl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).rf=e,i.cf=n,i.uf=r,i.type="where",i}return Object(O.d)(e,t),e.prototype.sf=function(t){var e=Sl(t.firestore),n=function(t,e,n,r,i,o,u){var s;if(i.tt()){if("array-contains"===o||"array-contains-any"===o)throw new Br(zr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Il(u,o);for(var a=[],c=0,h=u;c<h.length;c++)a.push(_l(r,t,h[c]));s={arrayValue:{values:a}}}else s=_l(r,t,u)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Il(u,o),s=Fl(n,"where",u,"in"===o||"not-in"===o);var f=ts.create(i,o,s);return function(t,e){if(e.An()){var n=Gu(t);if(null!==n&&!n.isEqual(e.field))throw new Br(zr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Bu(t);null!==r&&Ol(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new Br(zr.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t.tf,0,e,t.firestore.R_,this.rf,this.cf,this.uf);return new ll(t.firestore,t.j_,function(t,e){var n=t.filters.concat([e]);return new Uu(t.path,t.collectionGroup,t.Tn.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.tf,n))},e}(pl),yl=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).rf=e,r.af=n,r.type="orderBy",r}return Object(O.d)(e,t),e.prototype.sf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Br(zr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Br(zr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ps(e,n);return function(t,e){if(null===Bu(t)){var n=Gu(t);null!==n&&Ol(0,n,e.field)}}(t,r),r}(t.tf,this.rf,this.af);return new ll(t.firestore,t.j_,function(t,e){var n=t.Tn.concat([e]);return new Uu(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.tf,e))},e}(pl),gl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.hf=n,i.lf=r,i}return Object(O.d)(e,t),e.prototype.sf=function(t){return new ll(t.firestore,t.j_,Xu(t.tf,this.hf,this.lf))},e}(pl),bl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i._f=n,i.ff=r,i}return Object(O.d)(e,t),e.prototype.sf=function(t){var e=wl(t,this.type,this._f,this.ff);return new ll(t.firestore,t.j_,function(t,e){return new Uu(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.tf,e))},e}(pl),ml=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i._f=n,i.ff=r,i}return Object(O.d)(e,t),e.prototype.sf=function(t){var e=wl(t,this.type,this._f,this.ff);return new ll(t.firestore,t.j_,function(t,e){return new Uu(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.tf,e))},e}(pl);function wl(t,e,n,r){if(n[0]instanceof If&&(n[0]=n[0].o_),n[0]instanceof Xf)return function(t,e,n,r,i){if(!r)throw new Br(zr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],u=0,s=Wu(t);u<s.length;u++){var a=s[u];if(a.field.tt())o.push(lo(e,r.key));else{var c=r.field(a.field);if($i(c))throw new Br(zr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.J();throw new Br(zr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new cs(o,i)}(t.tf,t.firestore.R_,e,n[0].W_,r);var i=Sl(t.firestore);return function(t,e,n,r,i,o){var u=t.Tn;if(i.length>u.length)throw new Br(zr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var s=[],a=0;a<i.length;a++){var c=i[a];if(u[a].field.tt()){if("string"!=typeof c)throw new Br(zr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Ku(t)&&-1!==c.indexOf("/"))throw new Br(zr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ri.Y(c));if(!ui.ot(h))throw new Br(zr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new ui(h);s.push(lo(e,f))}else{var l=Fl(n,r,c);s.push(l)}}return new cs(s,o)}(t.tf,t.firestore.R_,i,e,n,r)}function _l(t,e,n){if(n instanceof If&&(n=n.o_),"string"==typeof n){if(""===n)throw new Br(zr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ku(e)&&-1!==n.indexOf("/"))throw new Br(zr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ri.Y(n));if(!ui.ot(r))throw new Br(zr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return lo(t,new ui(r))}if(n instanceof fl)return lo(t,n.K_);throw new Br(zr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Nf(n)+".")}function Il(t,e){if(!Array.isArray(t)||0===t.length)throw new Br(zr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Br(zr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Ol(t,e,n){if(!n.isEqual(e))throw new Br(zr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function El(t){if(zu(t)&&0===t.Tn.length)throw new Br(zr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Tl=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,qu(r))||this).firestore=e,i.nf=r,i.type="collection",i}return Object(O.d)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.tf.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.tf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.nf.q();return t.W()?null:new fl(this.firestore,null,new ui(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.nf)},e}(ll);function jl(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(Of("collection","path",e),t instanceof zf){var i=ri.Y.apply(ri,Object(O.i)([e],n));return Af(i),new Tl(t,null,i)}if(!(t instanceof fl||t instanceof Tl))throw new Br(zr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=ri.Y.apply(ri,Object(O.i)([t.path],n)).child(ri.Y(e));return Af(o),new Tl(t.firestore,null,o)}function Al(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(1===arguments.length&&(e=Yr.D()),Of("doc","path",e),t instanceof zf){var i=ri.Y.apply(ri,Object(O.i)([e],n));return jf(i),new fl(t,null,new ui(i))}if(!(t instanceof fl||t instanceof Tl))throw new Br(zr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=t.nf.child(ri.Y.apply(ri,Object(O.i)([e],n)));return jf(o),new fl(t.firestore,t instanceof Tl?t.j_:null,new ui(o))}var Nl=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(O.d)(e,t),e.prototype.F_=function(t){return new Mf(t)},e.prototype.O_=function(t){var e=this.B_(t,this.firestore.R_);return new fl(this.firestore,null,e)},e}(Wf);function xl(t,e){return(t instanceof fl||t instanceof Tl)&&(e instanceof fl||e instanceof Tl)&&t.firestore===e.firestore&&t.path===e.path&&t.j_===e.j_}function kl(t,e){return t instanceof ll&&e instanceof ll&&t.firestore===e.firestore&&Qu(t.tf,e.tf)&&t.j_===e.j_}function Sl(t){var e=t.S_(),n=Is(t.R_);return new Vl(t.R_,!!e.ignoreUndefinedProperties,n)}var Dl=/^__.*__$/,Cl=function(){function t(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}return t.prototype.ef=function(t,e){var n=[];return n.push(null!==this.en?new Eu(t,this.data,this.en,e):new Ou(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new ju(t,this.fieldTransforms)),n},t}(),Pl=function(){function t(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}return t.prototype.ef=function(t,e){var n=[new Eu(t,this.data,this.en,e)];return this.fieldTransforms.length>0&&n.push(new ju(t,this.fieldTransforms)),n},t}();function Rl(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Mr()}}var Ll=function(){function t(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.df(),this.fieldTransforms=i||[],this.en=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"a_",{get:function(){return this.settings.a_},enumerable:!1,configurable:!0}),t.prototype.wf=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.en)},t.prototype.Ef=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.wf({path:n,__:!1});return r.Tf(t),r},t.prototype.If=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.wf({path:n,__:!1});return r.df(),r},t.prototype.mf=function(t){return this.wf({path:void 0,__:!0})},t.prototype.h_=function(t){return Ql(t,this.settings.methodName,this.settings.Af||!1,this.path,this.settings.l_)},t.prototype.contains=function(t){return void 0!==this.en.find(function(e){return t.j(e)})||void 0!==this.fieldTransforms.find(function(e){return t.j(e.field)})},t.prototype.df=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Tf(this.path.get(t))},t.prototype.Tf=function(t){if(0===t.length)throw this.h_("Document fields must not be empty");if(Rl(this.a_)&&Dl.test(t))throw this.h_('Document fields cannot begin and end with "__"')},t}(),Vl=function(){function t(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||Is(t)}return t.prototype.Rf=function(t,e,n,r){return void 0===r&&(r=!1),new Ll({a_:t,methodName:e,l_:n,path:oi.X(),__:!1,Af:r},this.t,this.serializer,this.ignoreUndefinedProperties)},t}();function Ul(t,e,n,r,i,o){void 0===o&&(o={});var u=t.Rf(o.merge||o.mergeFields?2:0,e,n,i);Kl("Data must be an object, but it was:",u,r);var s,a,c=Bl(r,u);if(o.merge)s=new lu(u.en),a=u.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=Wl(e,l[f],n);if(!u.contains(p))throw new Br(zr.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Yl(h,p)||h.push(p)}s=new lu(h),a=u.fieldTransforms.filter(function(t){return s.un(t.field)})}else s=null,a=u.fieldTransforms;return new Cl(new Su(c),s,a)}function Ml(t,e,n,r){var i=t.Rf(1,e,n);Kl("Data must be an object, but it was:",i,r);var o=[],u=new Du;Yi(r,function(t,r){var s=Xl(e,t,n);r instanceof If&&(r=r.o_);var a=i.If(s);if(r instanceof Df)o.push(s);else{var c=zl(r,a);null!=c&&(o.push(s),u.set(s,c))}});var s=new lu(o);return new Pl(u.hn(),s,i.fieldTransforms)}function ql(t,e,n,r,i,o){var u=t.Rf(1,e,n),s=[Wl(e,r,n)],a=[i];if(o.length%2!=0)throw new Br(zr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)s.push(Wl(e,o[c])),a.push(o[c+1]);for(var h=[],f=new Du,l=s.length-1;l>=0;--l)if(!Yl(h,s[l])){var p=s[l],d=a[l];d instanceof If&&(d=d.o_);var v=u.If(p);if(d instanceof Df)h.push(p);else{var y=zl(d,v);null!=y&&(h.push(p),f.set(p,y))}}var g=new lu(h);return new Pl(f.hn(),g,u.fieldTransforms)}function Fl(t,e,n,r){return void 0===r&&(r=!1),zl(n,t.Rf(r?4:3,e))}function zl(t,e){if(t instanceof If&&(t=t.o_),Gl(t))return Kl("Unsupported field value:",e,t),Bl(t,e);if(t instanceof Sf)return function(t,e){if(!Rl(e.a_))throw e.h_(t.c_+"() can only be used with update() and set()");if(!e.path)throw e.h_(t.c_+"() is not currently supported inside arrays");var n=t.u_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.en.push(e.path),t instanceof Array){if(e.settings.__&&4!==e.a_)throw e.h_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var u=zl(o[i],e.mf(r));null==u&&(u={nullValue:"NULL_VALUE"}),n.push(u),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof If&&(t=t.o_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Eo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ti.fromDate(t);return{timestampValue:To(e.serializer,n)}}if(t instanceof ti){var r=new ti(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:To(e.serializer,r)}}if(t instanceof Uf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Mf)return{bytesValue:jo(e.serializer,t.T_)};if(t instanceof fl){var i=e.t,o=t.firestore.R_;if(!o.isEqual(i))throw e.h_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:xo(t.firestore.R_||e.t,t.K_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.h_("Unsupported field value: "+Nf(t))}(t,e)}function Bl(t,e){var n={};return Ji(t)?e.path&&e.path.length>0&&e.en.push(e.path):Yi(t,function(t,r){var i=zl(r,e.Ef(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function Gl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ti||t instanceof Uf||t instanceof Mf||t instanceof fl||t instanceof Sf)}function Kl(t,e,n){if(!Gl(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Nf(n);throw e.h_("an object"===r?t+" a custom object":t+" "+r)}}function Wl(t,e,n){if(e instanceof If&&(e=e.o_),e instanceof Jf)return e.G_;if("string"==typeof e)return Xl(t,e);throw Ql("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Hl=new RegExp("[~\\*/\\[\\]]");function Xl(t,e,n){if(e.search(Hl)>=0)throw Ql("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(Jf.bind.apply(Jf,Object(O.i)([void 0],e.split("."))))).G_}catch(r){throw Ql("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Ql(t,e,n,r,i){var o=r&&!r.W(),u=void 0!==i,s="Function "+e+"() called with invalid data";n&&(s+=" (via `toFirestore()`)");var a="";return(o||u)&&(a+=" (found",o&&(a+=" in field "+r),u&&(a+=" in document "+i),a+=")"),new Br(zr.INVALID_ARGUMENT,(s+=". ")+t+a)}function Yl(t,e){return t.some(function(t){return t.isEqual(e)})}var Jl=function(){function t(t){this.Nu=t,this.Pf=new Map,this.mutations=[],this.gf=!1,this.yf=null,this.Vf=new Set}return t.prototype.pf=function(t){return Object(O.b)(this,void 0,void 0,function(){var e,n=this;return Object(O.e)(this,function(r){switch(r.label){case 0:if(this.vf(),this.mutations.length>0)throw new Br(zr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(O.b)(this,void 0,void 0,function(){var n,r,i,o,u,s;return Object(O.e)(this,function(a){switch(a.label){case 0:return n=Fr(t),r=Ro(n.serializer)+"/documents",i={documents:e.map(function(t){return So(n.serializer,t)})},[4,n.Ru("BatchGetDocuments",r,i)];case 1:return o=a.sent(),u=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){qr(!!e.found);var n=Do(t,e.found.name),r=No(e.found.updateTime),i=new Su({mapValue:{fields:e.found.fields}});return new Ru(n,r,i,{})}(t,e):"missing"in e?function(t,e){qr(!!e.missing),qr(!!e.readTime);var n=Do(t,e.missing),r=No(e.readTime);return new Lu(n,r)}(t,e):Mr()}(n.serializer,t);u.set(e.key.toString(),e)}),s=[],[2,(e.forEach(function(t){var e=u.get(t.toString());qr(!!e),s.push(e)}),s)]}})})}(this.Nu,t)];case 1:return[2,((e=r.sent()).forEach(function(t){t instanceof Lu||t instanceof Ru?n.bf(t):Mr()}),e)]}})})},t.prototype.set=function(t,e){this.write(e.ef(t,this.rn(t))),this.Vf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.ef(t,this.Sf(t)))}catch(t){this.yf=t}this.Vf.add(t.toString())},t.prototype.delete=function(t){this.write([new xu(t,this.rn(t))]),this.Vf.add(t.toString())},t.prototype.commit=function(){return Object(O.b)(this,void 0,void 0,function(){var t,e=this;return Object(O.e)(this,function(n){switch(n.label){case 0:if(this.vf(),this.yf)throw this.yf;return t=this.Pf,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=ui.st(n);e.mutations.push(new ku(r,e.rn(r)))}),[4,function(t,e){return Object(O.b)(this,void 0,void 0,function(){var n,r,i;return Object(O.e)(this,function(o){switch(o.label){case 0:return n=Fr(t),r=Ro(n.serializer)+"/documents",i={writes:e.map(function(t){return Uo(n.serializer,t)})},[4,n.Au("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.Nu,this.mutations)];case 1:return n.sent(),this.gf=!0,[2]}})})},t.prototype.bf=function(t){var e;if(t instanceof Ru)e=t.version;else{if(!(t instanceof Lu))throw Mr();e=ei.min()}var n=this.Pf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Br(zr.ABORTED,"Document version changed between two reads.")}else this.Pf.set(t.key.toString(),e)},t.prototype.rn=function(t){var e=this.Pf.get(t.toString());return!this.Vf.has(t.toString())&&e?vu.updateTime(e):vu.on()},t.prototype.Sf=function(t){var e=this.Pf.get(t.toString());if(!this.Vf.has(t.toString())&&e){if(e.isEqual(ei.min()))throw new Br(zr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return vu.updateTime(e)}return vu.exists(!0)},t.prototype.write=function(t){this.vf(),this.mutations=this.mutations.concat(t)},t.prototype.vf=function(){},t}(),$l=function(){function t(t,e,n,r){this.di=t,this.Nu=e,this.updateFunction=n,this.Ti=r,this.Df=5,this.Si=new xs(this.di,"transaction_retry")}return t.prototype.run=function(){this.Cf()},t.prototype.Cf=function(){var t=this;this.Si.Bs(function(){return Object(O.b)(t,void 0,void 0,function(){var t,e,n=this;return Object(O.e)(this,function(r){return t=new Jl(this.Nu),(e=this.Nf(t))&&e.then(function(e){n.di.Ri(function(){return t.commit().then(function(){n.Ti.resolve(e)}).catch(function(t){n.xf(t)})})}).catch(function(t){n.xf(t)}),[2]})})})},t.prototype.Nf=function(t){try{var e=this.updateFunction(t);return!si(e)&&e.catch&&e.then?e:(this.Ti.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ti.reject(t),null}},t.prototype.xf=function(t){var e=this;this.Df>0&&this.Ff(t)?(this.Df-=1,this.di.Ri(function(){return e.Cf(),Promise.resolve()})):this.Ti.reject(t)},t.prototype.Ff=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!wi(e)}return!1},t}(),Zl=function(){function t(t,e,n){var r=this;this.credentials=t,this.di=e,this.Fl=n,this.user=Dr.UNAUTHENTICATED,this.clientId=Yr.D(),this.Of=function(){},this.g=new _s,this.credentials.A(function(t){Rr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.Of(t)),r.g.resolve()})}return t.prototype.getConfiguration=function(){return Object(O.b)(this,void 0,void 0,function(){return Object(O.e)(this,function(t){switch(t.label){case 0:return[4,this.g.promise];case 1:return[2,(t.sent(),{di:this.di,Fl:this.Fl,clientId:this.clientId,credentials:this.credentials,Yl:this.user,$h:100})]}})})},t.prototype.Mf=function(t){var e=this;this.Of=t,this.g.promise.then(function(){return e.Of(e.user)})},t.prototype.kf=function(){if(this.di.Ci)throw new Br(zr.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.di.Oi();var e=new _s;return this.di.Ni(function(){return Object(O.b)(t,void 0,void 0,function(){var t,n;return Object(O.e)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.$f?[4,this.$f.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.Lf?[4,this.Lf.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.R(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Bs(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}();function tp(t,e){return Object(O.b)(this,void 0,void 0,function(){var n,r=this;return Object(O.e)(this,function(i){switch(i.label){case 0:return t.di.Li(),Rr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=i.sent(),[4,e.initialize(n)];case 2:return i.sent(),t.Mf(function(n){return t.di.Mi(function(){return Object(O.b)(r,void 0,void 0,function(){return Object(O.e)(this,function(t){switch(t.label){case 0:return[4,hc(e.Cu,n)];case 1:return t.sent(),[2]}})})})}),e.persistence.tc(function(){return t.terminate()}),t.Lf=e,[2]}})})}function ep(t,e){return Object(O.b)(this,void 0,void 0,function(){var n,r;return Object(O.e)(this,function(i){switch(i.label){case 0:return t.di.Li(),[4,np(t)];case 1:return n=i.sent(),Rr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.Mf(function(n){return t.di.Mi(function(){return function(t,e){return Object(O.b)(this,void 0,void 0,function(){var n,r;return Object(O.e)(this,function(i){switch(i.label){case 0:return(n=Fr(t)).di.Li(),Rr("RemoteStore","RemoteStore received new credentials"),r=Lc(n),n.Mu.add(3),[4,xc(n)];case 1:return i.sent(),r&&n.Bu.set("Unknown"),[4,n.xu.s_(e)];case 2:return i.sent(),n.Mu.delete(3),[4,Nc(n)];case 3:return i.sent(),[2]}})})}(e.Oh,n)})}),t.$f=e,[2]}})})}function np(t){return Object(O.b)(this,void 0,void 0,function(){return Object(O.e)(this,function(e){switch(e.label){case 0:return t.Lf?[3,2]:(Rr("FirestoreClient","Using default OfflineComponentProvider"),[4,tp(t,new gf)]);case 1:e.sent(),e.label=2;case 2:return[2,t.Lf]}})})}function rp(t){return Object(O.b)(this,void 0,void 0,function(){return Object(O.e)(this,function(e){switch(e.label){case 0:return t.$f?[3,2]:(Rr("FirestoreClient","Using default OnlineComponentProvider"),[4,ep(t,new wf)]);case 1:e.sent(),e.label=2;case 2:return[2,t.$f]}})})}function ip(t){return np(t).then(function(t){return t.persistence})}function op(t){return np(t).then(function(t){return t.Cu})}function up(t){return rp(t).then(function(t){return t.Oh})}function sp(t){return rp(t).then(function(t){return t.ga})}function ap(t){return Object(O.b)(this,void 0,void 0,function(){var e,n;return Object(O.e)(this,function(r){switch(r.label){case 0:return[4,rp(t)];case 1:return e=r.sent(),[2,((n=e.Mh).Ju=Th.bind(null,e.ga),n.Zu=Ah.bind(null,e.ga),n)]}})})}function cp(t,e,n,r,i){var o=new _f({next:function(o){e.Ri(function(){return nh(t,u)});var s=o.docs.has(n);!s&&o.fromCache?i.reject(new Br(zr.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&o.fromCache&&r&&"server"===r.source?i.reject(new Br(zr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),u=new uh(qu(n.path),o,{includeMetadataChanges:!0,oa:!0});return eh(t,u)}function hp(t,e,n,r,i){var o=new _f({next:function(n){e.Ri(function(){return nh(t,u)}),n.fromCache&&"server"===r.source?i.reject(new Br(zr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),u=new uh(n,o,{includeMetadataChanges:!0,oa:!0});return eh(t,u)}var fp=function(){function t(t,e){this.U_=t,this.Bf=e,this.qf=[],this.Uf=!1,this.Qf=Sl(t)}return t.prototype.set=function(t,e,n){this.Kf();var r=lp(t,this.U_),i=Dp(r.j_,e,n),o=Ul(this.Qf,"WriteBatch.set",r.K_,i,null!==r.j_,n);return this.qf=this.qf.concat(o.ef(r.K_,vu.on())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Kf();var o,u=lp(t,this.U_);return e instanceof If&&(e=e.o_),o="string"==typeof e||e instanceof Jf?ql(this.Qf,"WriteBatch.update",u.K_,e,n,r):Ml(this.Qf,"WriteBatch.update",u.K_,e),this.qf=this.qf.concat(o.ef(u.K_,vu.exists(!0))),this},t.prototype.delete=function(t){this.Kf();var e=lp(t,this.U_);return this.qf=this.qf.concat(new xu(e.K_,vu.on())),this},t.prototype.commit=function(){return this.Kf(),this.Uf=!0,this.qf.length>0?this.Bf(this.qf):Promise.resolve()},t.prototype.Kf=function(){if(this.Uf)throw new Br(zr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function lp(t,e){if(t instanceof If&&(t=t.o_),t.firestore!==e)throw new Br(zr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var pp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).U_=e,r}return Object(O.d)(e,t),e.prototype.get=function(e){var n=this,r=lp(e,this.U_),i=new ul(this.U_);return t.prototype.get.call(this,e).then(function(t){return new el(n.U_,i,r.K_,t.W_,new Ep(!1,!1),r.j_)})},e}(function(){function t(t,e){this.U_=t,this.Wf=e,this.Qf=Sl(t)}return t.prototype.get=function(t){var e=this,n=lp(t,this.U_),r=new Nl(this.U_);return this.Wf.pf([n.K_]).then(function(t){if(!t||1!==t.length)return Mr();var i=t[0];if(i instanceof Lu)return new Xf(e.U_,r,n.K_,null,n.j_);if(i instanceof Ru)return new Xf(e.U_,r,i.key,i,n.j_);throw Mr()})},t.prototype.set=function(t,e,n){var r=lp(t,this.U_),i=Dp(r.j_,e,n),o=Ul(this.Qf,"Transaction.set",r.K_,i,null!==r.j_,n);return this.Wf.set(r.K_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,u=lp(t,this.U_);return e instanceof If&&(e=e.o_),o="string"==typeof e||e instanceof Jf?ql(this.Qf,"Transaction.update",u.K_,e,n,r):Ml(this.Qf,"Transaction.update",u.K_,e),this.Wf.update(u.K_,o),this},t.prototype.delete=function(t){var e=lp(t,this.U_);return this.Wf.delete(e.K_),this},t}()),dp=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){tl(t);var n=yp(t),r=t.S_(),i=new wf;return Zf(n,i,new bf(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.o_,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){tl(t);var e=yp(t),n=t.S_(),r=new wf;return Zf(e,r,new mf(r,n.cacheSizeBytes))}(t.o_)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.y_&&!t.V_)throw new Br(zr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new _s;return t.z_.Ni(function(){return Object(O.b)(e,void 0,void 0,function(){var e;return Object(O.e)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(O.b)(this,void 0,void 0,function(){return Object(O.e)(this,function(e){switch(e.label){case 0:return ks.Gs()?[4,ks.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(sc(t.R_,t.I_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t.o_)},t}(),vp=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).jf=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof Sr||(i.Gf=e),i}return Object(O.d)(e,t),Object.defineProperty(e.prototype,"R_",{get:function(){return this.o_.R_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.o_.b_()),t)).merge,this.o_.v_(t)},e.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.o_.b_().host&&Vr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},e.prototype.enableNetwork=function(){return function(t){var e=this;return t.di.enqueue(function(){return Object(O.b)(e,void 0,void 0,function(){var e,n;return Object(O.e)(this,function(r){switch(r.label){case 0:return[4,ip(t)];case 1:return e=r.sent(),[4,up(t)];case 2:return n=r.sent(),[2,(e.ec(!0),function(t){var e=Fr(t);return e.Mu.delete(0),Nc(e)}(n))]}})})})}(yp(this.o_))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t.di.enqueue(function(){return Object(O.b)(e,void 0,void 0,function(){var e,n;return Object(O.e)(this,function(r){switch(r.label){case 0:return[4,ip(t)];case 1:return e=r.sent(),[4,up(t)];case 2:return n=r.sent(),[2,(e.ec(!1),function(t){return Object(O.b)(this,void 0,void 0,function(){var e;return Object(O.e)(this,function(n){switch(n.label){case 0:return(e=Fr(t)).Mu.add(0),[4,xc(e)];case 1:return n.sent(),e.Bu.set("Offline"),[2]}})})}(n))]}})})})}(yp(this.o_))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Tf("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.jf.enableMultiTabIndexedDbPersistence(this):this.jf.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.jf.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.o_._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new _s;return t.di.Ri(function(){return Object(O.b)(e,void 0,void 0,function(){var e;return Object(O.e)(this,function(r){switch(r.label){case 0:return e=Ph,[4,sp(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(yp(this.o_))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=yp(t),i=Os(e)?e:{next:e},o=new _f(i);return t.z_.Ri(function(){return Object(O.b)(n,void 0,void 0,function(){var t;return Object(O.e)(this,function(e){switch(e.label){case 0:return t=function(t,e){Fr(t).Hu.add(e),e.next()},[4,ap(r)];case 1:return t.apply(void 0,[e.sent(),o]),[2]}})})}),function(){o.r_(),t.z_.Ri(function(){return Object(O.b)(n,void 0,void 0,function(){var t;return Object(O.e)(this,function(e){switch(e.label){case 0:return t=function(t,e){Fr(t).Hu.delete(e)},[4,ap(r)];case 1:return t.apply(void 0,[e.sent(),o]),[2]}})})})}}(this.o_,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.Gf)throw new Br(zr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Gf},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new kp(this,jl(this.o_,t))}catch(t){throw _p(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new wp(this,Al(this.o_,t))}catch(t){throw _p(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new Ap(this,function(t,e){if(Of("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Br(zr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new ll(t,null,function(t){return new Uu(ri.X(),t)}(e))}(this.o_,t))}catch(t){throw _p(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new _s;return t.di.Ri(function(){return Object(O.b)(n,void 0,void 0,function(){var n;return Object(O.e)(this,function(i){switch(i.label){case 0:return[4,function(t){return rp(t).then(function(t){return t.Nu})}(t)];case 1:return n=i.sent(),new $l(t.di,n,e,r).run(),[2]}})})}),r.promise}(yp(t),function(n){return e(new pp(t,n))})}(this.o_,function(n){return t(new bp(e,n))})},e.prototype.batch=function(){var t=this;return yp(this.o_),new mp(new fp(this.o_,function(e){return cl(t.o_,e)}))},e}(If);function yp(t){return t.H_||gp(t),t.H_.kf(),t.H_}function gp(t){var e=t.S_(),n=function(t,e,n){return new kr(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.R_,t.I_,e);t.H_=new Zl(t.P_,t.z_,n)}var bp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return Object(O.d)(e,t),e.prototype.get=function(t){var e=this,n=Sp(t);return this.o_.get(n).then(function(t){return new Tp(e.U_,t)})},e.prototype.set=function(t,e,n){var r=Sp(t);return n?(Ef("Transaction.set",n),this.o_.set(r,e,n)):this.o_.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var u=Sp(t);return 2===arguments.length?this.o_.update(u,e):(r=this.o_).update.apply(r,Object(O.i)([u,e,n],i)),this},e.prototype.delete=function(t){var e=Sp(t);return this.o_.delete(e),this},e}(If),mp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(O.d)(e,t),e.prototype.set=function(t,e,n){var r=Sp(t);return n?(Ef("WriteBatch.set",n),this.o_.set(r,e,n)):this.o_.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var u=Sp(t);return 2===arguments.length?this.o_.update(u,e):(r=this.o_).update.apply(r,Object(O.i)([u,e,n],i)),this},e.prototype.delete=function(t){var e=Sp(t);return this.o_.delete(e),this},e.prototype.commit=function(){return this.o_.commit()},e}(If),wp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Q_=new Hf(e),r}return Object(O.d)(e,t),e.zf=function(t,n,r){if(t.length%2!=0)throw new Br(zr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.J()+" has "+t.length);return new e(n,new fl(n.o_,r,new ui(t)))},e.q_=function(t,n,r){return new e(n,new fl(n.o_,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new kp(this.firestore,this.o_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new kp(this.firestore,jl(this.o_,t))}catch(t){throw _p(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof If&&(t=t.o_),t instanceof fl&&xl(this.o_,t)},e.prototype.set=function(t,e){e=Ef("DocumentReference.set",e);try{return function(t,e,n){var r=xf(t.firestore,$f),i=Dp(t.j_,e,n);return cl(r,Ul(Sl(r),"setDoc",t.K_,i,null!==t.j_,n).ef(t.K_,vu.on()))}(this.o_,t,e)}catch(t){throw _p(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?sl(this.o_,t):sl.apply(void 0,Object(O.i)([this.o_,t,e],n))}catch(t){throw _p(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return cl(xf((t=this.o_).firestore,$f),[new xu(t.K_,vu.on())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Ip(e),i=Op(e,function(e){return new Tp(t.firestore,new el(t.firestore.o_,t.Q_,e.K_,e.W_,e.metadata,t.o_.j_))});return al(this.o_,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){var e=this,n=xf(t.firestore,$f),r=yp(n),i=new ul(n),o=new _s;return n.z_.Ri(function(){return Object(O.b)(e,void 0,void 0,function(){return Object(O.e)(this,function(e){switch(e.label){case 0:return[4,op(r)];case 1:return[4,function(t,e,n){return Object(O.b)(this,void 0,void 0,function(){var r,i,o;return Object(O.e)(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,function(t,e){var n=Fr(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Oc.cs(t,e)})}(t,e)];case 1:return(r=u.sent())instanceof Ru?n.resolve(r):r instanceof Lu?n.resolve(null):n.reject(new Br(zr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=u.sent(),o=Bs(i,"Failed to get document '"+e+" from cache"),n.reject(o),[3,3];case 3:return[2]}})})}(e.sent(),t.K_,o)];case 2:return e.sent(),[2]}})})}),o.promise.then(function(e){return new el(n,i,t.K_,e,new Ep(e instanceof Ru&&e.an,!0),t.j_)})}(this.o_):"server"===(null==t?void 0:t.source)?function(t){var e=this,n=xf(t.firestore,$f),r=yp(n),i=new _s;return n.z_.Ri(function(){return Object(O.b)(e,void 0,void 0,function(){return Object(O.e)(this,function(e){switch(e.label){case 0:return[4,ap(r)];case 1:return[4,cp(e.sent(),n.z_,t.K_,{source:"server"},i)];case 2:return e.sent(),[2]}})})}),i.promise.then(function(e){return hl(n,t,e)})}(this.o_):function(t){var e=this,n=xf(t.firestore,$f),r=yp(n),i=new _s;return n.z_.Ri(function(){return Object(O.b)(e,void 0,void 0,function(){return Object(O.e)(this,function(e){switch(e.label){case 0:return[4,ap(r)];case 1:return[4,cp(e.sent(),n.z_,t.K_,{source:"default"},i)];case 2:return e.sent(),[2]}})})}),i.promise.then(function(e){return hl(n,t,e)})}(this.o_)).then(function(t){return new Tp(e.firestore,new el(e.firestore.o_,e.Q_,t.K_,t.W_,t.metadata,e.o_.j_))})},e.prototype.withConverter=function(t){return new e(this.firestore,this.o_.withConverter(t))},e}(If);function _p(t,e,n){return t.message=t.message.replace(e,n),t}function Ip(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Os(r))return r}return{}}function Op(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Os(t[0])?t[0]:Os(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Ep=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Tp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return Object(O.d)(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new wp(this.U_,this.o_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this.o_.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this.o_.data(t)},e.prototype.get=function(t,e){return this.o_.get(t,e)},e.prototype.isEqual=function(t){return ol(this.o_,t.o_)},e}(If),jp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(O.d)(e,t),e.prototype.data=function(t){return this.o_.data(t)},e}(Tp),Ap=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r}return Object(O.d)(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,dl(this.o_,function(t,e,n){var r=e,i=Yf("where",t);return new vl(i,r,n)}(t,n,r)))}catch(t){throw _p(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,dl(this.o_,function(t,e){void 0===e&&(e="asc");var n=e,r=Yf("orderBy",t);return new yl(r,n)}(t,n)))}catch(t){throw _p(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,dl(this.o_,function(t){return kf("limit",t),new gl("limit",t,"F")}(t)))}catch(t){throw _p(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,dl(this.o_,function(t){return kf("limitToLast",t),new gl("limitToLast",t,"L")}(t)))}catch(t){throw _p(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,dl(this.o_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new bl("startAt",t,!0)}).apply(void 0,t)))}catch(t){throw _p(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,dl(this.o_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new bl("startAfter",t,!1)}).apply(void 0,t)))}catch(t){throw _p(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,dl(this.o_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ml("endBefore",t,!0)}).apply(void 0,t)))}catch(t){throw _p(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,dl(this.o_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ml("endAt",t,!1)}).apply(void 0,t)))}catch(t){throw _p(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return kl(this.o_,t.o_)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){var e=this,n=xf(t.firestore,$f),r=yp(n),i=new ul(n),o=new _s;return n.z_.Ri(function(){return Object(O.b)(e,void 0,void 0,function(){return Object(O.e)(this,function(e){switch(e.label){case 0:return[4,op(r)];case 1:return[4,function(t,e,n){return Object(O.b)(this,void 0,void 0,function(){var r,i,o,u,s,a;return Object(O.e)(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,gc(t,e,!0)];case 1:return r=c.sent(),i=new _h(e,r.Bc),o=i.gh(r.documents),u=i.Zn(o,!1),n.resolve(u.snapshot),[3,3];case 2:return s=c.sent(),a=Bs(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}})})}(e.sent(),t.tf,o)];case 2:return e.sent(),[2]}})})}),o.promise.then(function(e){return new rl(n,i,t,e)})}(this.o_):"server"===(null==t?void 0:t.source)?function(t){var e=this,n=xf(t.firestore,$f),r=yp(n),i=new ul(n),o=new _s;return n.z_.Ri(function(){return Object(O.b)(e,void 0,void 0,function(){return Object(O.e)(this,function(e){switch(e.label){case 0:return[4,ap(r)];case 1:return[4,hp(e.sent(),n.z_,t.tf,{source:"server"},o)];case 2:return e.sent(),[2]}})})}),o.promise.then(function(e){return new rl(n,i,t,e)})}(this.o_):function(t){var e=this,n=xf(t.firestore,$f),r=yp(n),i=new ul(n);El(t.tf);var o=new _s;return n.z_.Ri(function(){return Object(O.b)(e,void 0,void 0,function(){return Object(O.e)(this,function(e){switch(e.label){case 0:return[4,ap(r)];case 1:return[4,hp(e.sent(),n.z_,t.tf,{source:"default"},o)];case 2:return e.sent(),[2]}})})}),o.promise.then(function(e){return new rl(n,i,t,e)})}(this.o_)).then(function(t){return new xp(e.firestore,t)})},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Ip(e),i=Op(e,function(e){return new xp(t.firestore,e)});return al(this.o_,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this.o_.withConverter(t))},e}(If),Np=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return Object(O.d)(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.o_.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new jp(this.U_,this.o_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this.o_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this.o_.newIndex},enumerable:!1,configurable:!0}),e}(If),xp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return Object(O.d)(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new Ap(this.U_,this.o_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.o_.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this.o_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this.o_.docs.map(function(e){return new jp(t.U_,e)})},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this.o_.docChanges(t).map(function(t){return new Np(e.U_,t)})},e.prototype.forEach=function(t,e){var n=this;this.o_.forEach(function(r){t.call(e,new jp(n.U_,r))})},e.prototype.isEqual=function(t){return ol(this.o_,t.o_)},e}(If),kp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r.o_=n,r}return Object(O.d)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.o_.parent;return t?new wp(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new wp(this.firestore,void 0===t?Al(this.o_):Al(this.o_,t))}catch(t){throw _p(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=xf(t.firestore,$f),r=Al(t),i=Dp(t.j_,e);return cl(n,Ul(Sl(t.firestore),"addDoc",r.K_,i,null!==t.j_,{}).ef(r.K_,vu.exists(!1))).then(function(){return r})}(this.o_,t).then(function(t){return new wp(e.firestore,t)})},e.prototype.isEqual=function(t){return xl(this.o_,t.o_)},e.prototype.withConverter=function(t){return new e(this.firestore,this.o_.withConverter(t))},e}(Ap);function Sp(t){return t instanceof If&&(t=t.o_),xf(t,fl)}function Dp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Cp,Pp=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(Jf.bind.apply(Jf,Object(O.i)([void 0],e))))||this}return Object(O.d)(e,t),e.documentId=function(){return new e(oi.et().J())},e.prototype.isEqual=function(t){return t instanceof If&&(t=t.o_),t instanceof Jf&&this.o_.G_.isEqual(t.G_)},e}(If),Rp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(O.d)(e,t),e.serverTimestamp=function(){var t=new Pf("serverTimestamp");return t.c_="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new Df("deleteField");return t.c_="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Rf("arrayUnion",t)}).apply(void 0,t);return r.c_="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Lf("arrayRemove",t)}).apply(void 0,t);return r.c_="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new Vf("increment",t)}(t);return n.c_="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},e}(If),Lp={Firestore:vp,GeoPoint:Uf,Timestamp:ti,Blob:Kf,Transaction:bp,WriteBatch:mp,DocumentReference:wp,DocumentSnapshot:Tp,Query:Ap,QueryDocumentSnapshot:jp,QuerySnapshot:xp,CollectionReference:kp,FieldPath:Pp,FieldValue:Rp,setLogLevel:function(t){Cr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new xr.a("firestore",function(t){return function(t,e){return new vp(t,new $f(t,e),new dp)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},Lp)))})(Cp=E.a),Cp.registerVersion("@firebase/firestore","2.0.4");var Vp=n("UbJi");function Up(t,e){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.a;return new h.a(function(n){var r;return null!=e?e.schedule(function(){r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),function(){null!=r&&r()}})}(t,e)}function Mp(t,e){return Up(t,e).pipe(Object(v.a)(function(t){return{payload:t,type:"query"}}))}function qp(t,e){return Mp(t,e).pipe(Object(p.a)(void 0),Object(d.a)(),Object(v.a)(function(t){var e=c(t,2),n=e[0],r=e[1],i=r.payload.docChanges(),o=i.map(function(t){return{type:t.type,payload:t}});return n&&JSON.stringify(n.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach(function(t,e){var r=i.find(function(e){return e.doc.ref.isEqual(t.ref)}),u=null==n?void 0:n.payload.docs.find(function(e){return e.ref.isEqual(t.ref)});r&&JSON.stringify(r.doc.metadata)===JSON.stringify(t.metadata)||!r&&u&&JSON.stringify(u.metadata)===JSON.stringify(t.metadata)||o.push({type:"modified",payload:{oldIndex:e,newIndex:e,type:"modified",doc:t}})}),o}))}function Fp(t,e,n){return qp(t,n).pipe(Object(y.a)(function(t,n){return function(t,e,n){return e.forEach(function(e){n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":if(!t[e.newIndex]||!t[e.newIndex].doc.ref.isEqual(e.doc.ref))return zp(t,e.newIndex,0,e);break;case"modified":if(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){var n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}return zp(t,e.newIndex,1,e)}break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return zp(t,e.oldIndex,1)}return t}(t,e))}),t}(t,n.map(function(t){return t.payload}),e)},[]),Object(g.a)(),Object(v.a)(function(t){return t.map(function(t){return{type:t.type,payload:t}})}))}function zp(t,e,n){for(var r=t.slice(),i=arguments.length,o=new Array(i>3?i-3:0),u=3;u<i;u++)o[u-3]=arguments[u];return r.splice.apply(r,[e,n].concat(o)),r}function Bp(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}var Gp=function(){function t(e,n,r){u(this,t),this.ref=e,this.query=n,this.afs=r}return a(t,[{key:"stateChanges",value:function(t){return t&&0!==t.length?qp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(v.a)(function(e){return e.filter(function(e){return t.indexOf(e.type)>-1})}),Object(b.a)(function(t){return t.length>0}),this.afs.keepUnstableUntilFirst):qp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(b.a)(function(t){return t.length>0}),this.afs.keepUnstableUntilFirst)}},{key:"auditTrail",value:function(t){return this.stateChanges(t).pipe(Object(y.a)(function(t,e){return[].concat(o(t),o(e))},[]))}},{key:"snapshotChanges",value:function(t){var e=Bp(t);return Fp(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}},{key:"valueChanges",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Mp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(v.a)(function(e){return e.payload.docs.map(function(e){return t.idField?Object.assign(Object.assign({},e.data()),i({},t.idField,e.id)):e.data()})}),this.afs.keepUnstableUntilFirst)}},{key:"get",value:function(t){return Object(f.a)(this.query.get(t)).pipe(Object(m.b)(this.afs.schedulers.insideAngular))}},{key:"add",value:function(t){return this.ref.add(t)}},{key:"doc",value:function(t){return new Kp(this.ref.doc(t),this.afs)}}]),t}(),Kp=function(){function t(e,n){u(this,t),this.ref=e,this.afs=n}return a(t,[{key:"set",value:function(t,e){return this.ref.set(t,e)}},{key:"update",value:function(t){return this.ref.update(t)}},{key:"delete",value:function(){return this.ref.delete()}},{key:"collection",value:function(t,e){var n=Jp(this.ref.collection(t),e),r=n.ref,i=n.query;return new Gp(r,i,this.afs)}},{key:"snapshotChanges",value:function(){return Up(this.ref,this.afs.schedulers.outsideAngular).pipe(Object(p.a)(void 0),Object(d.a)(),Object(v.a)(function(t){var e=c(t,2),n=e[0],r=e[1];return r.exists?(null==n?void 0:n.exists)?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}})).pipe(this.afs.keepUnstableUntilFirst)}},{key:"valueChanges",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.snapshotChanges().pipe(Object(v.a)(function(e){var n=e.payload;return t.idField?Object.assign(Object.assign({},n.data()),i({},t.idField,n.id)):n.data()}))}},{key:"get",value:function(t){return Object(f.a)(this.ref.get(t)).pipe(Object(m.b)(this.afs.schedulers.insideAngular))}}]),t}(),Wp=function(){function t(e,n){u(this,t),this.query=e,this.afs=n}return a(t,[{key:"stateChanges",value:function(t){return t&&0!==t.length?qp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(v.a)(function(e){return e.filter(function(e){return t.indexOf(e.type)>-1})}),Object(b.a)(function(t){return t.length>0}),this.afs.keepUnstableUntilFirst):qp(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}},{key:"auditTrail",value:function(t){return this.stateChanges(t).pipe(Object(y.a)(function(t,e){return[].concat(o(t),o(e))},[]))}},{key:"snapshotChanges",value:function(t){var e=Bp(t);return Fp(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}},{key:"valueChanges",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Mp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(v.a)(function(e){return e.payload.docs.map(function(e){return t.idField?Object.assign(i({},t.idField,e.id),e.data()):e.data()})}),this.afs.keepUnstableUntilFirst)}},{key:"get",value:function(t){return Object(f.a)(this.query.get(t)).pipe(Object(m.b)(this.afs.schedulers.insideAngular))}}]),t}(),Hp=new r.r("angularfire2.enableFirestorePersistence"),Xp=new r.r("angularfire2.firestore.persistenceSettings"),Qp=new r.r("angularfire2.firestore.settings"),Yp=new r.r("angularfire2.firestore.use-emulator");function Jp(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t};return{query:e(t),ref:t}}var $p,Zp,td=((Zp=function(){function t(e,n,r,i,s,a,h,p,d){u(this,t),this.schedulers=new w.d(a),this.keepUnstableUntilFirst=Object(w.h)(this.schedulers);var v=Object(w.g)(e,a,n);!I.a.auth&&d&&Object(w.j)();var y=p,g=c(Object(w.f)("".concat(v.name,".firestore"),"AngularFirestore",v,function(){var t=a.runOutsideAngular(function(){return v.firestore()});return i&&t.settings(i),y&&t.useEmulator.apply(t,o(y)),r&&!Object(_.v)(s)?[t,a.runOutsideAngular(function(){try{return Object(f.a)(t.enablePersistence(h||void 0).then(function(){return!0},function(){return!1}))}catch(e){return"undefined"!=typeof console&&console.warn(e),Object(l.a)(!1)}})]:[t,Object(l.a)(!1)]},[i,y,r]),2);this.firestore=g[0],this.persistenceEnabled$=g[1]}return a(t,[{key:"collection",value:function(t,e){var n=Jp("string"==typeof t?this.firestore.collection(t):t,e),r=n.ref,i=n.query,o=this.schedulers.ngZone.run(function(){return r});return new Gp(o,i,this)}},{key:"collectionGroup",value:function(t,e){var n=e||function(t){return t},r=this.firestore.collectionGroup(t);return new Wp(n(r),this)}},{key:"doc",value:function(t){var e;e="string"==typeof t?this.firestore.doc(t):t;var n=this.schedulers.ngZone.run(function(){return e});return new Kp(n,this)}},{key:"createId",value:function(){return this.firestore.collection("_").doc().id}}]),t}()).\u0275fac=function(t){return new(t||Zp)(r.Vb(w.c),r.Vb(w.b,8),r.Vb(Hp,8),r.Vb(Qp,8),r.Vb(r.C),r.Vb(r.A),r.Vb(Xp,8),r.Vb(Yp,8),r.Vb(Vp.c,8))},Zp.\u0275prov=Object(r.Hb)({factory:function(){return new Zp(Object(r.Vb)(w.c),Object(r.Vb)(w.b,8),Object(r.Vb)(Hp,8),Object(r.Vb)(Qp,8),Object(r.Vb)(r.C),Object(r.Vb)(r.A),Object(r.Vb)(Xp,8),Object(r.Vb)(Yp,8),Object(r.Vb)(Vp.c,8))},token:Zp,providedIn:"any"}),Zp),ed=(($p=function(){function t(){u(this,t)}return a(t,null,[{key:"enablePersistence",value:function(e){return{ngModule:t,providers:[{provide:Hp,useValue:!0},{provide:Xp,useValue:e}]}}}]),t}()).\u0275mod=r.Jb({type:$p}),$p.\u0275inj=r.Ib({factory:function(t){return new(t||$p)},providers:[td]}),$p)},Zy1z:function(n,r,i){"use strict";i.d(r,"a",function(){return s});var o=i("7o/Q");function s(){return function(t){return t.lift(new c)}}var c=function(){function t(){u(this,t)}return a(t,[{key:"call",value:function(t,e){return e.subscribe(new h(t))}}]),t}(),h=function(n){!function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&t(e,n)}(i,n);var r=e(i);function i(t){var e;return u(this,i),(e=r.call(this,t)).hasPrev=!1,e}return a(i,[{key:"_next",value:function(t){var e;this.hasPrev?e=[this.prev,t]:this.hasPrev=!0,this.prev=t,e&&this.destination.next(e)}}]),i}(o.a)}}])}();