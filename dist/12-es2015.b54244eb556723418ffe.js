(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{XpXM:function(e,t,i){"use strict";i.r(t),i.d(t,"MainPageModule",function(){return A});var n=i("ofXK"),s=i("3Pt+"),a=i("TEn/"),o=i("tyNb"),r=i("fXoL");let c=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Fb({type:e,selectors:[["app-home"]],decls:4,vars:0,consts:[["routerLink","/list-events"],["routerLink","/list-picks"]],template:function(e,t){1&e&&(r.Rb(0,"ion-button",0),r.Bc(1,"Find Events"),r.Qb(),r.Rb(2,"ion-button",1),r.Bc(3,"My Picks"),r.Qb())},directives:[a.b,a.C,o.h],styles:[""]}),e})(),b=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Fb({type:e,selectors:[["app-leagues"]],decls:15,vars:0,consts:[["slot","bottom"],["name","musical-note"],["name","videocam"],["name","game-controller"]],template:function(e,t){1&e&&(r.Rb(0,"ion-tabs"),r.Bc(1," Test "),r.Rb(2,"ion-tab-bar",0),r.Rb(3,"ion-tab-button"),r.Rb(4,"ion-label"),r.Bc(5,"Music"),r.Qb(),r.Mb(6,"ion-icon",1),r.Qb(),r.Rb(7,"ion-tab-button"),r.Rb(8,"ion-label"),r.Bc(9,"Movies"),r.Qb(),r.Mb(10,"ion-icon",2),r.Qb(),r.Rb(11,"ion-tab-button"),r.Rb(12,"ion-label"),r.Bc(13,"Games"),r.Qb(),r.Mb(14,"ion-icon",3),r.Qb(),r.Qb(),r.Qb())},directives:[a.v,a.t,a.u,a.j,a.f],styles:[""]}),e})();var l=i("mrSG"),u=i("SxV6"),m=i("lJxs");function h(e){if(e instanceof Date)return e;try{return e.toDate()}catch(t){return null}}class g{constructor(){this.userPicks=[],this.rankArray=[],this.tieBreakerGuess=null,this.name=""}getGameArray(){let e=new Array;console.log(this.eventData);for(let t=0;t<this.eventData.away_teams.length;t++)e.push({id:t,homeTeam:this.eventData.home_teams[t],awayTeam:this.eventData.away_teams[t],homeTeamShort:this.eventData.home_team_shorts[t],awayTeamShort:this.eventData.away_team_shorts[t],complete:this.eventData.status_of_games[t],homeWins:this.eventData.home_wins[t],awayWins:this.eventData.away_wins[t],status_of_game:this.eventData.status_of_games[t],startTimes:[this.eventData.start_times1[t],this.eventData.start_times2[t]],userPick:this.userPicks[t],rank:this.rankArray[t],best_of:this.eventData.best_of[t]});return e}}class p{constructor(){this.id="",this.description="",this.games_finish=null,this.games_start=null,this.name="",this.status=""}add_Data(e){for(var t in e)["games_finish","games_start","closes"].includes(t)?this[t]=h(e[t]):this.hasOwnProperty(t)&&(this[t]=e[t])}}class d{constructor(e){e&&this.addData(e)}addData(e,t){for(var i in t&&(this.event_id=t),e){let t=["start_times1","start_times2"];if(["games_finish","games_start","closes"].includes(i))this[i]=h(e[i]);else if(t.includes(i))try{this[i]=[],e[i].forEach(e=>{this[i].push(h(e))})}catch(n){console.error(`The variable ${i} must be an Array<>`)}else this[i]=e[i]}}}var v=i("I/3d"),f=i("UbJi");let k=(()=>{class e{constructor(e,t){this.db=e,this.auth=t}listPicks(){return new Promise((e,t)=>{this.db.collection("events",e=>e.where("closes",">",new Date).orderBy("closes")).snapshotChanges().pipe(Object(u.a)()).subscribe(t=>{let i=new Array;for(let e of t){let t=e.payload.doc.data(),n=new p;n.add_Data(t),n.id=e.payload.doc.id,i.push(n)}console.log(i),e(i)})})}getUserEventData(e){return new Promise((t,i)=>Object(l.a)(this,void 0,void 0,function*(){let i=new g;i.eventData=yield this.getEventData(e);let n=(yield this.getUser()).uid,s=this.db.doc(`/events/${e}/picks/${n}`),a=yield s.get().toPromise();if(a.exists){let e=a.data();i.name=e.name,i.rankArray=e.ranks,i.userPicks=e.picks,i.tieBreakerGuess=e.tiebreaker,t(i)}t(i)}))}getEventData(e){return new Promise((t,i)=>Object(l.a)(this,void 0,void 0,function*(){try{let i=yield this.db.doc(`events/${e}/data/data`).get().toPromise(),n=new d(i.data);n.addData(i.data(),e),t(n)}catch(n){i(n)}}))}makePick(e){return new Promise((t,i)=>Object(l.a)(this,void 0,void 0,function*(){let n=e.eventData.event_id,s=(yield this.getUser()).uid,a=`/events/${n}/picks/${s}`,o={owner:s,picks:e.userPicks,ranks:e.rankArray,tiebreaker:e.tieBreakerGuess,name:e.name};try{yield this.updateDoc(a,o)}catch(b){return void i(b)}let r=`/users/${s}/event_picks/${n}`,c={status:e.eventData.status,name:e.name,eventName:e.eventData.name,score:0};try{yield this.updateDoc(r,c)}catch(b){return void i(b)}t(!0)}))}getPick(){return new Promise((e,t)=>Object(l.a)(this,void 0,void 0,function*(){const t=yield this.getUser(),i=this.db.collection(`/users/${t.uid}/event_picks`);e(i.valueChanges({idField:"id"}).pipe(Object(m.a)(e=>e)))}))}updateDoc(e,t){return new Promise((i,n)=>Object(l.a)(this,void 0,void 0,function*(){let s=this.db.doc(e);(yield s.get().toPromise()).exists?s.update(t).then(e=>{i(e)}).catch(e=>{n(e)}):s.set(t).then(e=>{i(e)}).catch(e=>{n(e)})}))}getUser(){return this.auth.currentUser}}return e.\u0275fac=function(t){return new(t||e)(r.Vb(v.a),r.Vb(f.a))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),y=(()=>{class e{constructor(e){this.router=e}ngOnInit(){}makePick(){this.router.navigate(["make-pick",this.event.id])}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(o.g))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-event"]],inputs:{event:"event"},decls:9,vars:5,consts:[[3,"click"]],template:function(e,t){1&e&&(r.Rb(0,"ion-item"),r.Rb(1,"ion-label"),r.Rb(2,"h2"),r.Bc(3),r.Qb(),r.Rb(4,"p"),r.Bc(5),r.ec(6,"date"),r.Qb(),r.Rb(7,"ion-button",0),r.Zb("click",function(){return t.makePick()}),r.Bc(8," Make Pick "),r.Qb(),r.Qb(),r.Qb()),2&e&&(r.Bb(3),r.Cc(t.event.name),r.Bb(2),r.Dc("Closes: ",r.gc(6,2,t.event.games_finish,"EEE MMM d, h:mm a"),""))},directives:[a.h,a.j,a.b],pipes:[n.e],styles:[""]}),e})();function R(e,t){1&e&&r.Mb(0,"app-event",1),2&e&&r.jc("event",t.$implicit)}let Q=(()=>{class e{constructor(e){this.pickGamesService=e}ngOnInit(){this.allEventObservable=this.pickGamesService.listPicks()}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(k))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-list-events"]],decls:3,vars:3,consts:[[3,"event",4,"ngFor","ngForOf"],[3,"event"]],template:function(e,t){1&e&&(r.Rb(0,"ion-list"),r.zc(1,R,1,1,"app-event",0),r.ec(2,"async"),r.Qb()),2&e&&(r.Bb(1),r.jc("ngForOf",r.fc(2,1,t.allEventObservable)))},directives:[a.k,n.k,y],pipes:[n.b],styles:[""]}),e})();function _(e,t){if(1&e){const e=r.Sb();r.Rb(0,"ion-item"),r.Rb(1,"ion-label"),r.Rb(2,"h2"),r.Bc(3),r.Qb(),r.Rb(4,"p"),r.Bc(5),r.ec(6,"date"),r.Qb(),r.Rb(7,"ion-button",1),r.Zb("click",function(){r.rc(e);const i=t.$implicit;return r.dc().editPick(i)}),r.Bc(8," Update Pick "),r.Qb(),r.Qb(),r.Qb()}if(2&e){const e=t.$implicit;r.Bb(3),r.Cc(e.eventName),r.Bb(2),r.Dc("Closes: ",r.gc(6,2,null==e.closes?null:e.closes.toDate(),"EEE MMM d, h:mm a"),"")}}let w=(()=>{class e{constructor(e,t){this.pickGamesService=e,this.router=t}ngOnInit(){this.pickGamesService.getPick().then(e=>{this.pickObservable=e,console.log(e)})}editPick(e){this.router.navigate(["make-pick",e.id])}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(k),r.Lb(o.g))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-list-picks"]],decls:3,vars:3,consts:[[4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){1&e&&(r.Rb(0,"ion-list"),r.zc(1,_,9,5,"ion-item",0),r.ec(2,"async"),r.Qb()),2&e&&(r.Bb(1),r.jc("ngForOf",r.fc(2,1,t.pickObservable)))},directives:[a.k,n.k,a.h,a.j,a.b],pipes:[n.b,n.e],styles:[""]}),e})(),B=(()=>{class e{constructor(e,t){this.auth=e,this.router=t}signOutUser(){return new Promise((e,t)=>{this.auth.signOut().then(()=>{this.router.navigate(["welcome"]),e()}).catch(e=>{t(e)})})}}return e.\u0275fac=function(t){return new(t||e)(r.Vb(f.a),r.Vb(o.g))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const D=["leftMenu"];let O=(()=>{class e{constructor(e,t,i){this.authManagerService=e,this.router=t,this.activatedRoute=i}moveToPage(e){this.router.navigate(e),this.menu.close(!0)}signOut(){this.menu.close(!0),this.authManagerService.signOutUser()}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(B),r.Lb(o.g),r.Lb(o.a))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-toolbar"]],viewQuery:function(e,t){var i;1&e&&r.Fc(D,!0),2&e&&r.oc(i=r.ac())&&(t.menu=i.first)},decls:32,vars:0,consts:[["side","start","content-id","main-content"],["leftMenu",""],["translucent",""],[3,"click"],["name","home","slot","start"],["name","american-football","slot","start"],["name","baseball","slot","start"],["name","trophy","slot","start"],["name","trash","slot","start"],["name","log-out","slot","start"]],template:function(e,t){1&e&&(r.Rb(0,"ion-menu",0,1),r.Rb(2,"ion-header"),r.Rb(3,"ion-toolbar",2),r.Rb(4,"ion-title"),r.Bc(5,"Menu"),r.Qb(),r.Qb(),r.Qb(),r.Rb(6,"ion-content"),r.Rb(7,"ion-list"),r.Rb(8,"ion-item",3),r.Zb("click",function(){return t.moveToPage([""])}),r.Mb(9,"ion-icon",4),r.Rb(10,"ion-label"),r.Bc(11,"Home"),r.Qb(),r.Qb(),r.Rb(12,"ion-item",3),r.Zb("click",function(){return t.moveToPage(["list-events"])}),r.Mb(13,"ion-icon",5),r.Rb(14,"ion-label"),r.Bc(15,"Find Events"),r.Qb(),r.Qb(),r.Rb(16,"ion-item",3),r.Zb("click",function(){return t.moveToPage(["list-picks"])}),r.Mb(17,"ion-icon",6),r.Rb(18,"ion-label"),r.Bc(19,"My Picks"),r.Qb(),r.Qb(),r.Rb(20,"ion-item",3),r.Zb("click",function(){return t.moveToPage(["list-picks"])}),r.Mb(21,"ion-icon",7),r.Rb(22,"ion-label"),r.Bc(23,"Leagues"),r.Qb(),r.Qb(),r.Rb(24,"ion-item"),r.Mb(25,"ion-icon",8),r.Rb(26,"ion-label"),r.Bc(27,"Trash"),r.Qb(),r.Qb(),r.Rb(28,"ion-item",3),r.Zb("click",function(){return t.signOut()}),r.Mb(29,"ion-icon",9),r.Rb(30,"ion-label"),r.Bc(31,"Log Out"),r.Qb(),r.Qb(),r.Qb(),r.Qb(),r.Qb())},directives:[a.m,a.e,a.y,a.x,a.d,a.k,a.h,a.f,a.j],styles:[""]}),e})(),P=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Fb({type:e,selectors:[["app-main"]],decls:10,vars:0,consts:[["id","main-content",1,"ion-page"],["slot","start"]],template:function(e,t){1&e&&(r.Mb(0,"app-toolbar"),r.Rb(1,"div",0),r.Rb(2,"ion-header"),r.Rb(3,"ion-toolbar"),r.Rb(4,"ion-buttons",1),r.Mb(5,"ion-menu-button"),r.Qb(),r.Rb(6,"ion-title"),r.Bc(7,"Sports Picks"),r.Qb(),r.Qb(),r.Qb(),r.Rb(8,"ion-content"),r.Mb(9,"router-outlet"),r.Qb(),r.Qb())},directives:[O,a.e,a.y,a.c,a.n,a.x,a.d,o.k],styles:[""]}),e})();function F(e,t){if(1&e&&(r.Rb(0,"ion-segment-button",4),r.Bc(1),r.Qb()),2&e){const e=r.dc().$implicit;r.Bb(1),r.Dc(" ",e.awayTeam," ")}}function j(e,t){if(1&e&&(r.Rb(0,"ion-segment-button",5),r.Bc(1),r.Qb()),2&e){const e=r.dc().$implicit;r.Bb(1),r.Dc(" ",e.homeTeam," ")}}function M(e,t){if(1&e){const e=r.Sb();r.Rb(0,"ion-item"),r.Rb(1,"ion-list"),r.Rb(2,"ion-item"),r.Bc(3),r.Qb(),r.Rb(4,"ion-item"),r.Rb(5,"ion-segment",1),r.Zb("ionChange",function(i){r.rc(e);const n=t.$implicit;return r.dc().segmentChange(i,n)}),r.zc(6,F,2,1,"ion-segment-button",2),r.zc(7,j,2,1,"ion-segment-button",3),r.Qb(),r.Qb(),r.Mb(8,"ion-item-divider"),r.Qb(),r.Qb()}if(2&e){const e=t.$implicit;r.Bb(3),r.Ec(" ",e.awayTeam," vs ",e.homeTeam," "),r.Bb(2),r.kc("id",e.id),r.kc("value",e.userPick),r.Bb(1),r.jc("ngIf",1==e.best_of),r.Bb(1),r.jc("ngIf",1==e.best_of)}}let I=(()=>{class e{constructor(e){this.toastController=e,this._games=new Array,this._original_games=new Array,this.nextButtonDisable=!1,this.gamesOutput=new r.o,this.nextButtonDisable=!1}set games(e){console.log(e),this._games=e,this._original_games=Object.assign([],this._games),this.isComplete()}get games(){return this._games}ngOnInit(){this.isComplete()}segmentChange(e,t){t.userPick=e.detail.value,this.isComplete()}isComplete(){if(console.log(this.games),this.games){for(let e=0;e<this.games.length;e++)if(!this.games[e].userPick)return this.gamesOutput.emit(!1),!1;return this.gamesOutput.emit(!0),!0}return this.gamesOutput.emit(!1),!1}presentToastWithOptions(){return Object(l.a)(this,void 0,void 0,function*(){(yield this.toastController.create({position:"bottom",buttons:[{side:"start",text:"Help",handler:()=>{console.log("Favorite clicked")}},{text:"Do not show again",role:"cancel"},{text:"Close",role:"cancel"}]})).present()})}ngOnDestroy(){}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(a.F))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-list-games"]],inputs:{games:"games"},outputs:{gamesOutput:"gamesOutput"},decls:4,vars:1,consts:[[4,"ngFor","ngForOf"],["interface","popover",3,"id","value","ionChange"],["value","0",4,"ngIf"],["value","1",4,"ngIf"],["value","0"],["value","1"]],template:function(e,t){1&e&&(r.Rb(0,"ion-list"),r.Rb(1,"ion-list-header"),r.Bc(2,"Your picks"),r.Qb(),r.zc(3,M,9,6,"ion-item",0),r.Qb()),2&e&&(r.Bb(3),r.jc("ngForOf",t.games))},directives:[a.k,a.l,n.k,a.h,a.p,a.D,n.l,a.i,a.q],styles:[""]}),e})();function E(e,t){1&e&&(r.Rb(0,"ion-text",8),r.Bc(1," The name is required "),r.Qb())}function T(e,t){if(1&e&&(r.Rb(0,"ion-text",8),r.Bc(1),r.Qb()),2&e){const e=r.dc(2);r.Bb(1),r.Dc(" The name has to be at least ",e.mainForm.get("name").getError("minlength").requiredLength," characters. ")}}function C(e,t){if(1&e&&(r.Rb(0,"ion-item"),r.zc(1,E,2,0,"ion-text",7),r.zc(2,T,2,1,"ion-text",7),r.Qb()),2&e){const e=r.dc();r.Bb(1),r.jc("ngIf",e.mainForm.get("name").hasError("required")),r.Bb(1),r.jc("ngIf",e.mainForm.get("name").hasError("minlength"))}}function G(e,t){1&e&&(r.Rb(0,"ion-text",8),r.Bc(1," The tiebreaker is required "),r.Qb())}function x(e,t){1&e&&(r.Rb(0,"ion-text",8),r.Bc(1," Please enter a positive number "),r.Qb())}function S(e,t){if(1&e&&(r.Rb(0,"ion-item"),r.zc(1,G,2,0,"ion-text",7),r.zc(2,x,2,0,"ion-text",7),r.Qb()),2&e){const e=r.dc();r.Bb(1),r.jc("ngIf",e.mainForm.get("tiebreaker_answer").hasError("required")),r.Bb(1),r.jc("ngIf",e.mainForm.get("tiebreaker_answer").hasError("pattern"))}}const L=[{path:"",component:P,children:[{path:"list-events",component:Q},{path:"list-picks",component:w},{path:"make-pick/:eventID",component:(()=>{class e{constructor(e,t,i){this.activatedRoute=e,this.pickGameService=t,this.router=i,this.tiebreaker_question="",this.listGamesDone=!1,this._original_games=new Array,this.listGamesDone=!1}get games(){return this._games}set games(e){this._games=e,this._original_games=Object.assign([],this._games)}ngOnInit(){this.activatedRoute.params.subscribe(e=>Object(l.a)(this,void 0,void 0,function*(){this.event_id=e.eventID,this.pickGameService.getUserEventData(this.event_id).then(e=>{console.log(e),this.event=e,this.games=e.getGameArray(),console.log(this.games),this.tiebreaker_question=this.event.eventData.tiebreaker_question,e.name&&(this.mainForm.get("name").setValue(e.name),this.mainForm.get("name").disable()),e.tieBreakerGuess&&this.mainForm.get("tiebreaker_answer").setValue(e.tieBreakerGuess)}).catch(e=>{console.warn(e)})})),this.mainForm=new s.g({name:new s.d("",[s.u.required,s.u.minLength(3)]),tiebreaker_answer:new s.d("",[s.u.required,s.u.pattern(/^[0-9]+$/)])})}get submitButtonDisabled(){return!(this.mainForm.valid&&this.listGamesDone)}get name(){return this.mainForm.get("name")}pickChanged(e){this.listGamesDone=e}formSubmitted(e){return Object(l.a)(this,void 0,void 0,function*(){console.log("submit"),console.log(this._original_games);let e=new Array,t=new Array,i=this.games.length;this._original_games.forEach((n,s)=>{let a=i-this.games.findIndex(e=>e.id==n.id);t.push(a),e.push(n.userPick)}),this.event.rankArray=t,this.event.userPicks=e,this.event.name=this.mainForm.get("name").value,this.event.tieBreakerGuess=+this.mainForm.get("tiebreaker_answer").value,console.log(this.event);try{yield this.pickGameService.makePick(this.event),this.router.navigate(["list-picks"])}catch(n){console.log(n)}})}ngOnDestroy(){this.params_sub&&this.params_sub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(o.a),r.Lb(k),r.Lb(o.g))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-make-pick"]],decls:19,vars:6,consts:[[3,"formGroup"],["lines","none"],["formControlName","name","placeholder","Name"],[4,"ngIf"],[3,"games","gamesOutput"],["formControlName","tiebreaker_answer","placeholder","Tiebreaker"],[3,"disabled","click"],["color","danger",4,"ngIf"],["color","danger"]],template:function(e,t){1&e&&(r.Rb(0,"ion-list"),r.Rb(1,"form",0),r.Rb(2,"ion-list",1),r.Rb(3,"ion-item"),r.Rb(4,"ion-label"),r.Bc(5,"Name of Pick"),r.Qb(),r.Mb(6,"ion-input",2),r.Qb(),r.zc(7,C,3,2,"ion-item",3),r.Rb(8,"app-list-games",4),r.Zb("gamesOutput",function(e){return t.pickChanged(e)}),r.Qb(),r.Rb(9,"ion-list-header"),r.Bc(10,"Tie Breaker"),r.Qb(),r.Rb(11,"ion-item"),r.Rb(12,"p"),r.Bc(13),r.Qb(),r.Qb(),r.Rb(14,"ion-item"),r.Mb(15,"ion-input",5),r.Qb(),r.zc(16,S,3,2,"ion-item",3),r.Rb(17,"ion-button",6),r.Zb("click",function(e){return t.formSubmitted(e)}),r.Bc(18,"Submit"),r.Qb(),r.Qb(),r.Qb(),r.Qb()),2&e&&(r.Bb(1),r.jc("formGroup",t.mainForm),r.Bb(6),r.jc("ngIf",t.mainForm.get("name").errors&&!t.mainForm.get("name").pristine),r.Bb(1),r.jc("games",t.games),r.Bb(5),r.Dc(" ",t.tiebreaker_question," "),r.Bb(3),r.jc("ngIf",t.mainForm.get("tiebreaker_answer").errors&&!t.mainForm.get("tiebreaker_answer").pristine),r.Bb(1),r.jc("disabled",t.submitButtonDisabled))},directives:[a.k,s.v,s.p,s.h,a.h,a.j,a.g,a.E,s.o,s.f,n.l,I,a.l,a.b,a.w],styles:[""]}),e})()},{path:"leagues",component:b},{path:"",component:c}]}];let $=(()=>{class e{}return e.\u0275mod=r.Jb({type:e}),e.\u0275inj=r.Ib({factory:function(t){return new(t||e)},imports:[[o.j.forChild(L)],o.j]}),e})(),A=(()=>{class e{constructor(){console.log("Home Module")}}return e.\u0275mod=r.Jb({type:e}),e.\u0275inj=r.Ib({factory:function(t){return new(t||e)},imports:[[n.c,s.i,a.z,$,s.s]]}),e})()}}]);